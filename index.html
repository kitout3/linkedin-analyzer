<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analyseur LinkedIn - ADN de Marque</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50">
    <div id="app"></div>

    <script>
        // State management
        let state = {
            employees: [],
            brandDNA: [
                { id:1, name:"Excellence patrimoniale & Expertise", weight:30, keywords:["patrimoine","patrimonial","patrimoniale","gestion","conseil","strat√©gie","strat√©gique","ing√©nierie","allocation","optimisation","expertise","expert","performance","financier","immobilier","investissement","transmission","excellence","accompagnement"] },
                { id:2, name:"Ind√©pendance & Int√©grit√©", weight:25, keywords:["ind√©pendance","ind√©pendant","int√©grit√©","transparence","transparent","confiance","√©thique","responsable","capitalistique","partenaire","fiable","authentique"] },
                { id:3, name:"Approche sur-mesure & Client", weight:25, keywords:["sur-mesure","personnalis√©","personnalisation","client","dirigeant","entrepreneur","famille","accompagnement","√©coute","solution","adapt√©","individuel","relation","proximit√©","orientation"] },
                { id:4, name:"Vision long-terme & Durabilit√©", weight:20, keywords:["long-terme","p√©renne","durable","durabilit√©","transmission","transmissible","impact","avenir","coh√©rent","vision","objectif","croissance","transformation","√©volution"] }
            ],
            departments: [
                // üè¢ DIRECTION (5)
                { id: 1, name: "Direction G√©n√©rale", keywords: ["direction g√©n√©rale","dg","ceo","pr√©sident","directeur g√©n√©ral","pdg","pr√©sident directeur g√©n√©ral","chief executive officer","strat√©gie globale","vision","gouvernance","comex","comit√© ex√©cutif","codir","comit√© direction","leadership","pilotage strat√©gique","croissance","transformation","d√©veloppement","fondateur","co-fondateur","founder","managing director","g√©rant","associ√© g√©rant","board","conseil","administrateur","executive","c-level","top management","d√©cision strat√©gique","orientation","cap","mission","valeurs"] },
                { id: 2, name: "Direction des Op√©rations", keywords: ["direction op√©rations","coo","chief operating officer","directeur op√©rations","op√©rations","process","processus","efficacit√©","organisation","optimisation","coordination","pilotage op√©rationnel","am√©lioration continue","lean","lean management","six sigma","qualit√©","productivit√©","excellence op√©rationnelle","supply chain","cha√Æne logistique","flux","industrialisation","standardisation","proc√©dures","modes op√©ratoires","kpi op√©rationnels","performance op√©rationnelle","delivery","ex√©cution","run","change management","conduite changement"] },
                { id: 3, name: "Direction Financi√®re", keywords: ["direction financi√®re","daf","cfo","chief financial officer","directeur financier","directeur administratif financier","finance","tr√©sorerie","tr√©sorier","budget","comptabilit√©","reporting financier","consolidation","audit","contr√¥le","cash flow","flux tr√©sorerie","investissement","rentabilit√©","bfr","besoin fonds roulement","p&l","compte r√©sultat","bilan","pr√©visions","forecast","closing","cl√¥ture","normes ifrs","gaap","lev√©e fonds","financement","dette","equity","valorisation","m&a finance","due diligence financi√®re"] },
                { id: 4, name: "Direction du D√©veloppement", keywords: ["direction d√©veloppement","directeur d√©veloppement","chief development officer","croissance","expansion","nouveaux march√©s","partenariats strat√©giques","m&a","mergers acquisitions","fusions acquisitions","acquisitions","diversification","innovation","business development","strat√©gie de croissance","scale","scaling","internationalisation","franchise","licensing","joint venture","alliance strat√©gique","d√©veloppement externe","croissance externe","croissance organique","nouvelles activit√©s","incubation","venture","corporate venture"] },
                { id: 5, name: "Secr√©tariat G√©n√©ral", keywords: ["secr√©tariat g√©n√©ral","secr√©taire g√©n√©ral","secr√©taire g√©n√©rale","directeur g√©n√©ral adjoint","dga","gouvernance","conseil administration","ca","board","assembl√©e g√©n√©rale","ag","compliance corporate","affaires juridiques","institutionnel","relations actionnaires","shareholders","corporate secretary","greffe","statuts","pv","proc√®s verbal","d√©lib√©rations","mandats","pouvoirs","d√©l√©gations","organes sociaux","vie sociale","droit soci√©t√©s"] },
                
                // üë• RH & TALENTS (6)
                { id: 6, name: "Direction des Ressources Humaines", keywords: ["drh","direction rh","directeur ressources humaines","directrice rh","chief human resources officer","chro","chief people officer","cpo","ressources humaines","strat√©gie rh","politique rh","capital humain","transformation rh","culture d'entreprise","culture entreprise","engagement","marque employeur","employer branding","organisation","people","talent","workforce","effectifs","masse salariale","sirh","hris","politique sociale","climat social","barom√®tre social","enqu√™te engagement"] },
                { id: 7, name: "Recrutement & Talent Acquisition", keywords: ["recrutement","recruteur","recruteuse","talent acquisition","ta","sourcing","chasse","chasseur t√™tes","headhunter","entretiens","entretien embauche","onboarding","int√©gration","candidats","candidatures","offres d'emploi","annonces","cvth√®que","linkedin recruiter","cooptation","assessment","assessment center","√©valuation","tests","ats","applicant tracking","jobboard","indeed","welcome to the jungle","campus","relations √©coles","stage","stagiaire","alternance","alternant","apprenti","cdi","cdd","interim"] },
                { id: 8, name: "Formation & D√©veloppement des Comp√©tences", keywords: ["formation","formateur","formatrice","d√©veloppement comp√©tences","learning","learning development","l&d","e-learning","digital learning","mooc","parcours formation","plan de d√©veloppement","plan formation","coaching","coach","mentoring","mentor","upskilling","reskilling","certification","acad√©mie","universit√© entreprise","corporate university","ing√©nierie p√©dagogique","conception formation","animation formation","√©valuation formation","comp√©tences","r√©f√©rentiel comp√©tences","gpec","gepp","bilan comp√©tences","vae","cpf","opco"] },
                { id: 9, name: "Administration RH & Paie", keywords: ["administration rh","gestionnaire rh","gestionnaire paie","paie","payroll","gestion administrative","gestion personnel","contrats travail","contrat","bulletins paie","bulletins salaire","d√©clarations sociales","dsn","urssaf","cong√©s","absences","planning","sirh","workday","adp","sage paie","temps de travail","gestion temps","pointage","mutuelle","pr√©voyance","avantages sociaux","benefits","√©pargne salariale","int√©ressement","participation","tickets restaurant","solde tout compte","attestations","affiliations","m√©decine travail"] },
                { id: 10, name: "Relations Sociales & QVT", keywords: ["relations sociales","responsable relations sociales","cse","comit√© social √©conomique","irp","d√©l√©gu√©s personnel","dialogue social","n√©gociation","n√©gociations annuelles","nao","accords","accord entreprise","convention collective","qvt","qvct","qualit√© vie travail","bien-√™tre","wellness","pr√©vention","sant√© travail","s√©curit√©","rps","risques psychosociaux","burn out","handicap","rqth","diversit√©","inclusion","√©galit√©","parit√©","index √©galit√©","rse sociale","duerp","p√©nibilit√©","t√©l√©travail","flex office"] },
                { id: 11, name: "Gestion des Carri√®res & Mobilit√©", keywords: ["gestion carri√®res","career management","mobilit√©","mobilit√© interne","mobilit√© internationale","expatriation","impatriation","√©volution professionnelle","entretiens annuels","entretien professionnel","people review","revue personnel","talent management","gestion talents","hauts potentiels","high potential","hipos","succession","plan succession","parcours","fili√®res m√©tiers","passerelles","promotion","√©volution","fid√©lisation","r√©tention","turnover","attrition","offboarding","d√©part","transition"] },
                
                // üõ†Ô∏è SUPPORT & SERVICES (4)
                { id: 12, name: "Support Administratif & Services G√©n√©raux", keywords: ["services g√©n√©raux","responsable services g√©n√©raux","office manager","facilities manager","administratif","assistant administratif","assistante administrative","accueil","h√¥tesse","standardiste","courrier","affranchissement","archivage","ged","gestion documentaire","fournitures","achats indirects","locaux","b√¢timent","immobilier entreprise","maintenance","entretien","facilities","facility management","prestataires","sous-traitance","logistique","moyens g√©n√©raux","parc auto","flotte","voyages","travel","d√©m√©nagement","am√©nagement","s√©curit√© locaux","badges","contr√¥le acc√®s"] },
                { id: 13, name: "Support IT & Helpdesk", keywords: ["support it","support informatique","helpdesk","service desk","assistance technique","technicien support","technicien informatique","ticketing","jira","servicenow","incidents","gestion incidents","d√©pannage","troubleshooting","poste de travail","desktop","logiciels","software","mat√©riel","hardware","pc","laptop","imprimante","r√©seau","network","wifi","vpn","active directory","office 365","microsoft 365","google workspace","support utilisateur","support utilisateurs","niveau 1","n1","niveau 2","n2","niveau 3","n3","escalade","sla","temps r√©solution","hotline","t√©l√©phone","remote","prise main distance"] },
                { id: 14, name: "Support Juridique & Contractuel", keywords: ["support juridique","juriste","juriste junior","paralegal","assistant juridique","assistante juridique","contrats","gestion contrats","contract management","r√©vision contrats","r√©daction contrats","n√©gociation contractuelle","clauses","conditions g√©n√©rales","cgv","cgu","conformit√©","compliance","litiges","contentieux","pr√©-contentieux","recouvrement","mise demeure","veille juridique","veille r√©glementaire","rgpd","dpo","data protection","propri√©t√© intellectuelle","pi","marques","brevets","droit des affaires","droit commercial","droit travail","baux","assurances"] },
                { id: 15, name: "Assistanat de Direction", keywords: ["assistante direction","assistant direction","assistante executive","executive assistant","ea","office assistant","secr√©taire","secr√©taire direction","secr√©tariat","agenda","gestion agenda","planning","r√©unions","organisation r√©unions","d√©placements","voyages","r√©servations","notes","prise notes","comptes-rendus","cr","minutes","coordination","filtrage","appels","mails","pr√©paration","dossiers","presentations","support ex√©cutif","bras droit","polyvalent","polyvalence","confidentialit√©","discr√©tion"] },
                
                // üíº COMMERCIAL & D√âVELOPPEMENT (6)
                { id: 16, name: "Direction Commerciale", keywords: ["direction commerciale","directeur commercial","directrice commerciale","chief sales officer","cso","chief revenue officer","cro","vp sales","head of sales","strat√©gie commerciale","politique commerciale","objectifs commerciaux","quotas","budget commercial","pilotage ventes","animation √©quipe","management commercial","forecast","pr√©visions ventes","pipeline","funnel","entonnoir","performance commerciale","kpi ventes","chiffre affaires","ca","revenue","marge commerciale","incentive","commissionnement","variable","bonus","challenge commercial","sales ops","sales operations"] },
                { id: 17, name: "D√©veloppement Commercial & Business Development", keywords: ["d√©veloppement commercial","business development","bizdev","bd","business developer","ing√©nieur commercial","ing√©nieur affaires","commercial terrain","prospection","chasse","hunter","nouveaux clients","acquisition clients","conqu√™te","new business","leads","g√©n√©ration leads","lead gen","opportunit√©s","qualification","rdv","rendez-vous","closing","signature","n√©gociation","proposition commerciale","offre commerciale","devis","appel offres","ao","r√©ponse appel offres","soutenance","pitch","d√©monstration","demo","poc","proof of concept","partenariats commerciaux"] },
                { id: 18, name: "Conseillers Commerciaux & Banquiers Priv√©s", keywords: ["conseiller commercial","conseill√®re commerciale","conseiller client√®le","charg√© client√®le","charg√© affaires","banquier priv√©","banqui√®re priv√©e","private banker","gestionnaire fortune","wealth manager","conseiller gestion patrimoine","cgp","cgpi","d√©veloppement portefeuille","portefeuille clients","book","encours","aum","assets under management","rdv clients","rendez-vous clients","d√©couverte client","proposition de valeur","offre","pr√©sentation","argumentaire","prospection patrimoniale","prescription","apporteurs affaires","souscription","signature","acte","closing client","conseil personnalis√©","sur-mesure"] },
                { id: 19, name: "Grands Comptes & Key Account Management", keywords: ["grands comptes","key account","key account manager","kam","global account","strategic account","enterprise","comptes strat√©giques","comptes cl√©s","national account","fid√©lisation","r√©tention client","d√©veloppement compte","account development","upselling","up-sell","cross selling","cross-sell","vente additionnelle","relation privil√©gi√©e","partenariat","partenaire strat√©gique","contrats cadre","accords cadre","n√©gociation annuelle","business review","qbr","quarterly business review","plan compte","account plan","governance","comit√© pilotage","executive sponsor"] },
                { id: 20, name: "Administration des Ventes & ADV", keywords: ["adv","administration ventes","administration commerciale","assistant commercial","assistante commerciale","gestionnaire adv","back office commercial","commandes","gestion commandes","saisie commandes","facturation","factures","facturation client","suivi commandes","suivi livraisons","litiges commerciaux","litiges clients","r√©clamations","sav","service apr√®s-vente","erp","sap","oracle","crm","salesforce","devis","√©tablissement devis","contrats commerciaux","relances","relances clients","recouvrement","impay√©s","encaissements","cr√©dit client","conditions paiement","incoterms","export","import"] },
                { id: 21, name: "Inside Sales & T√©l√©prospection", keywords: ["inside sales","inside sales representative","isr","sdr","sales development representative","bdr","business development representative","t√©l√©prospection","t√©l√©prospecteur","t√©l√©vente","t√©l√©vendeur","phoning","appels sortants","outbound","cold calling","qualification","qualification leads","prise de rdv","prise rendez-vous","leads","mql","sql","script","argumentaire t√©l√©phonique","objections","rebonds","conversion","taux conversion","volume","cadence","s√©quences","outreach","crm","hubspot","salesloft","outreach.io","linkedin sales navigator"] },
                
                // ü§ù RELATION CLIENT (3)
                { id: 22, name: "Service Client & Relation Clients", keywords: ["service client","service clients","relation client","relation clients","customer service","customer care","support client","customer support","charg√© relation client","conseiller client","satisfaction client","satisfaction","csat","fid√©lit√©","fid√©lit√© client","fid√©lisation","loyalty","r√©clamation","r√©clamations","plaintes","√©coute client","voix client","voc","suivi client","suivi dossier","qualit√© de service","qualit√© service","sla","temps de r√©ponse","first contact resolution","fcr","accueil client","accueil t√©l√©phonique","hotline","call center","centre appels","centre contact","multicanal","omnicanal","chat","chatbot","ticketing zendesk","freshdesk","intercom"] },
                { id: 23, name: "Middle-Office & Support Commercial", keywords: ["middle office","middle-office","support commercial","support aux ventes","sales support","traitement dossiers","gestion dossiers","entr√©e en relation","eer","ouverture compte","kyc","know your customer","due diligence client","onboarding client","onboarding","suivi administratif","contr√¥le conformit√©","v√©rification","validation","approbation","workflow","processus","back office commercial","coordination","interface","liaision","commercial s√©dentaire","gestionnaire commercial","charg√© client√®le back office"] },
                { id: 24, name: "Exp√©rience Client & Customer Success", keywords: ["exp√©rience client","cx","customer experience","customer success","customer success manager","csm","success manager","accompagnement client","accompagnement","adoption","adoption produit","satisfaction","nps","net promoter score","csat","ces","customer effort score","churn","attrition","r√©tention","retention","renouvellement","renewal","expansion","upsell","parcours client","customer journey","touchpoints","points contact","feedback","avis clients","reviews","am√©lioration continue","voice of customer","voc","customer centric","centr√©e client","health score","playbook","qbr"] },
                
                // üí∞ M√âTIERS PATRIMONIAUX (3)
                { id: 25, name: "Conseil Patrimonial", keywords: ["conseil patrimonial","conseiller patrimonial","conseill√®re patrimoniale","consultant patrimoine","ing√©nieur patrimonial","patrimoine","patrimonial","gestion patrimoine","gestion de patrimoine","wealth management","strat√©gie patrimoniale","planification patrimoniale","accompagnement patrimonial","client priv√©","client√®le priv√©e","hnwi","high net worth","uhnwi","optimisation","optimisation patrimoniale","transmission","transmission patrimoine","succession","donation","d√©membrement","assurance vie","contrat capitalisation","pea","compte titres","√©pargne","placements","allocation actifs","diversification","audit patrimonial","bilan patrimonial","diagnostic","pr√©conisations","horizon","objectifs patrimoniaux"] },
                { id: 26, name: "Gestion Financi√®re", keywords: ["gestion financi√®re","gestion actifs","asset management","gestion portefeuille","portfolio management","g√©rant","g√©rante","fund manager","analyste financier","analyste","finance","finance de march√©","march√©s financiers","march√©s","investissement","investissements","allocation","allocation d'actifs","asset allocation","performance","performance financi√®re","portefeuille","portefeuilles","analyse financi√®re","analyse","valorisation","pricing","risque","gestion risque","risk management","var","volatilit√©","rendement","yield","obligations","bonds","actions","equities","opcvm","sicav","fcp","etf","trackers","d√©riv√©s","options","futures","forex","devises","commodities","mati√®res premi√®res"] },
                { id: 27, name: "Immobilier & Alternatifs", keywords: ["immobilier","immobilier investissement","pierre papier","investissement immobilier","placement immobilier","scpi","opci","sci","soci√©t√© civile","fonci√®re","reit","immobilier locatif","locatif","rendement locatif","loyer","loyers","actif immobilier","actifs r√©els","real estate","real assets","alternatif","alternatifs","private equity","pe","capital investissement","capital risque","venture capital","vc","lbo","dette priv√©e","private debt","infrastructure","infra","fonds infrastructure","hedge funds","fonds alternatifs","fip","fcpi","fcpr","crowdfunding","crowdlending","co-investissement","club deal","carried interest"] },
                
                // üì£ MARKETING & COMMUNICATION (2)
                { id: 28, name: "Marketing & Communication", keywords: ["marketing","communication","responsable marketing","responsable communication","directeur marketing","directrice marketing","cmo","chief marketing officer","charg√© marketing","charg√©e communication","marque","brand","branding","brand manager","identit√© visuelle","charte graphique","logo","campagne","campagnes","publicit√©","pub","advertising","m√©dia","m√©dias","presse","relations presse","rp","pr","public relations","attach√© presse","communiqu√©","dossier presse","contenu","content","content marketing","r√©daction","r√©dacteur","copywriter","storytelling","digital","num√©rique","r√©seaux sociaux","social media","linkedin","twitter","x","instagram","facebook","tiktok","youtube","community manager","community management","cm","social media manager","smm","animation communaut√©","mod√©ration","e-reputation","e-r√©putation","r√©putation","veille","planning √©ditorial","calendrier √©ditorial","√©ditorial","ligne √©ditoriale","podcast","vid√©o","webinar","webinaire","√©v√©nementiel","√©v√©nements","salons","conf√©rences","s√©minaires","lead generation","g√©n√©ration leads","nurturing","newsletter","emailing","mailing","marketing automation"] },
                { id: 29, name: "Marketing Digital & Growth", keywords: ["marketing digital","digital marketing","webmarketing","web marketing","growth","growth marketing","growth hacker","growth hacking","acquisition","acquisition digitale","acquisition clients","performance marketing","performance","seo","r√©f√©rencement naturel","r√©f√©rencement","search engine optimization","sea","r√©f√©rencement payant","google ads","adwords","sem","search engine marketing","social ads","facebook ads","linkedin ads","display","programmatique","retargeting","remarketing","analytics","web analytics","google analytics","ga4","adobe analytics","mixpanel","amplitude","taux conversion","conversion rate optimization","cro","landing page","ux","user experience","ab test","ab testing","split test","tracking","tag manager","gtm","attribution","roi","roas","cac","co√ªt acquisition","ltv","lifetime value","funnel","entonnoir conversion","performance digitale","kpi digitaux","automation","marketing automation","hubspot","marketo","pardot","mailchimp","sendinblue","brevo","emailing","campagnes email","drip","s√©quences","inbound marketing","inbound","outbound marketing","outbound","content marketing","smo","dataviz","data visualisation","tableau bord","dashboard","reporting marketing"] },
                
                // ‚öñÔ∏è CONFORMIT√â & JURIDIQUE (2)
                { id: 30, name: "Conformit√© & Contr√¥le Interne", keywords: ["conformit√©","compliance","compliance officer","responsable conformit√©","rcsi","rcci","d√©ontologie","d√©ontologue","contr√¥le interne","contr√¥le permanent","contr√¥le p√©riodique","audit interne","auditeur interne","inspection","lcb ft","lcb-ft","lutte blanchiment","aml","anti money laundering","kyc","know your customer","connaissance client","due diligence","ddq","questionnaire","loi sapin","corruption","r√©glementaire","r√©glementation","veille r√©glementaire","mifid","mif 2","priips","kid","dici","solvabilit√©","solvency","bale","b√¢le","risque","gestion risques","risk","cartographie risques","matrice risques","proc√©dure","proc√©dures","politique","politiques","contr√¥le","contr√¥les","plan contr√¥le","testing","monitoring","reporting r√©glementaire","d√©clarations","amf","acpr","autorit√© march√©s","r√©gulateur","sanctions","pab","pot","lutte fraude","fraude","investigation"] },
                { id: 31, name: "Juridique & Fiscalit√©", keywords: ["juridique","legal","juriste","juriste senior","juriste droit affaires","juriste corporate","juriste fiscal","avocat","counsel","directeur juridique","head of legal","chief legal officer","clo","droit","droit des affaires","droit soci√©t√©s","droit commercial","droit fiscal","fiscal","fiscalit√©","fiscaliste","tax","tax manager","optimisation fiscale","strat√©gie fiscale","montage","structuration","restructuration","holding","pacte associ√©s","pacte actionnaires","shareholders agreement","statuts","contrat","contrats","r√©daction contrats","n√©gociation contrats","contentieux","litiges","arbitrage","m√©diation","transaction","m&a juridique","due diligence juridique","audit juridique","transmission","cession","donation","succession","ifi","imp√¥t fortune","plus-values","r√©gime fiscal","d√©fiscalisation","niche fiscale"] },
                
                // üìä FINANCE & COMPTABILIT√â (2)
                { id: 32, name: "Comptabilit√©", keywords: ["comptabilit√©","comptabilit√© g√©n√©rale","comptabilit√© auxiliaire","comptabilit√© clients","comptabilit√© fournisseurs","comptabilit√© analytique","comptable","comptable g√©n√©ral","comptable unique","chef comptable","responsable comptable","directeur comptable","accounting","accountant","√©critures","√©critures comptables","saisie","imputation","journal","journaux","bilan","compte r√©sultat","balance","grand livre","lettrage","rapprochement","rapprochement bancaire","r√©conciliation","cl√¥ture","cl√¥ture mensuelle","cl√¥ture annuelle","arr√™t√© comptes","liasse fiscale","d√©clarations fiscales","tva","is","imp√¥t soci√©t√©s","cfp","cvae","das2","normes comptables","pcg","ifrs","us gaap","consolidation","conso","intercos","intercompany","provisions","amortissements","immobilisations","stocks","cut-off","fec","audit comptable","r√©vision","certification","cac","commissaire comptes","expert comptable"] },
                { id: 33, name: "Contr√¥le de Gestion", keywords: ["contr√¥le gestion","contr√¥le de gestion","contr√¥leur gestion","contr√¥leur de gestion","financial controller","fc","management control","gestion management","reporting","reporting financier","reporting mensuel","budget","budgets","processus budg√©taire","√©laboration budget","suivi budg√©taire","forecast","reforecast","rolling forecast","atterrissage","pilotage performance","pilotage","performance","indicateurs","indicateurs performance","kpi","key performance indicators","tableau bord","dashboard","scorecard","analyse financi√®re","analyse √©carts","variance analysis","marge","marges","rentabilit√©","profitabilit√©","p&l","profit loss","compte exploitation","ebitda","ebit","r√©sultat op√©rationnel","co√ªts","analyse co√ªts","costing","prix revient","business plan","plan affaires","mod√©lisation","mod√®le financier","simulation","scenarios","sensibilit√©"] },
                
                // üíª IT & DATA (3)
                { id: 34, name: "IT, Syst√®mes d'Information & Data", keywords: ["it","dsi","directeur syst√®mes information","dsi adjoint","cio","chief information officer","cto","chief technology officer","syst√®mes information","si","information systems","informatique","technologies","infrastructure","infra","r√©seau","r√©seaux","network","serveurs","servers","cloud","aws","azure","gcp","google cloud","h√©bergement","hosting","datacenter","virtualisation","vmware","stockage","storage","s√©curit√©","s√©curit√© informatique","cybers√©curit√©","cybersecurity","soc","firewall","antivirus","iam","identity","authentification","data","donn√©es","base donn√©es","database","sql","nosql","big data","data lake","data warehouse","dwh","etl","int√©gration donn√©es","bi","business intelligence","reporting","tableau bord","dashboard","qlik","tableau","power bi","looker","dataviz","visualisation donn√©es","analytics","analyse donn√©es","data analyst","data engineer","data scientist","machine learning","ml","ia","ai","intelligence artificielle","crm","salesforce","dynamics","erp","sap","oracle","processus digitaux","digitalisation","transformation digitale","automatisation","rpa"] },
                { id: 35, name: "D√©veloppement & Projets IT", keywords: ["d√©veloppement","d√©veloppeur","d√©veloppeuse","dev","developer","ing√©nieur d√©veloppement","ing√©nieur logiciel","software engineer","fullstack","full stack","frontend","front-end","backend","back-end","web","mobile","ios","android","java","python","javascript","typescript","react","angular","vue","node","php","c#",".net","go","rust","projets it","gestion projets","chef projet","chef de projet","project manager","pm","pmo","project management office","moa","ma√Ætrise ouvrage","amoa","moe","ma√Ætrise oeuvre","amoe","product owner","po","product manager","scrum master","agile","scrum","kanban","safe","sprint","backlog","user stories","int√©gration","ci cd","devops","sre","site reliability","d√©ploiement","release","api","rest","graphql","microservices","architecture","architecte","solution architect","technical architect","infrastructure","cloud","containerisation","docker","kubernetes","k8s","aws","azure","gcp","delivery","livraison","recette","tests","qa","quality assurance"] },
                { id: 36, name: "Back-Office & Op√©rations", keywords: ["back office","back-office","op√©rations","operations","gestionnaire back office","technicien back office","traitement","traitements","r√®glement livraison","settlement","clearing","compensation","op√©rations titres","securities operations","flux","flux financiers","cash management","gestion cash","r√©conciliation","reconciliation","rapprochement","matching","breaks","suspens","investigations","r√©gularisation","process","processus op√©rationnels","contr√¥les","contr√¥le op√©rationnel","ex√©cution","execution","ordres","orders","corporate actions","ost","op√©rations sur titres","dividendes","coupons","remboursements","swift","r√©f√©rentiel","r√©f√©rentiels","static data","master data","valorisation","pricing","nav","valeur liquidative","reporting op√©rationnel","stp","straight through processing","automatisation","middle office op√©rations"] }
            ],
            targetCompany: 'Cyrus Herez',
            currentView: 'list',
            selectedEmployee: null,
            companyMission: "Cyrus Herez accompagne les dirigeants, entrepreneurs et familles dans la construction, la s√©curisation et la transmission de leur patrimoine gr√¢ce √† une approche globale int√©grant conseil strat√©gique, ing√©nierie patrimoniale, allocation financi√®re, immobilier et investissements alternatifs."
        };

        // ===== FONCTIONS EXISTANTES =====

        function loadState() {
            try {
                const saved = localStorage.getItem('employees');
                if (saved) state.employees = JSON.parse(saved);
            } catch (e) {
                console.error('Error loading state:', e);
            }
        }

        function saveState() {
            localStorage.setItem('employees', JSON.stringify(state.employees));
        }

        function processText(text) {
            return text.toLowerCase()
                .replace(/[^\w\s√†√¢√§√©√®√™√´√Ø√Æ√¥√π√ª√º√ø√¶≈ì√ß]/gi, ' ')
                .split(/\s+/)
                .filter(word => word.length > 2);
        }

        function extractLinkedInUsername(url) {
            if (!url) return '';
            const match = url.match(/linkedin\.com\/in\/([^\/\?]+)/);
            return match ? match[1] : '';
        }

        function isValidLinkedInURL(url) {
            return /linkedin\.com\/in\/[^\/\?]+/.test(url);
        }

        function extractProfileInfo(text) {
            const lines = text.split('\n').filter(l => l.trim());
            let firstName = '', lastName = '', position = '', company = '';
            
            for (let i = 0; i < Math.min(5, lines.length); i++) {
                const line = lines[i].trim();
                const nameMatch = line.match(/^([A-Z√Ä-√ø][a-z√†-√ø]+(?:\s+[A-Z√Ä-√ø][a-z√†-√ø]+){0,2})\s*$/);
                if (nameMatch && line.length < 40) {
                    const parts = nameMatch[1].split(/\s+/);
                    if (parts.length >= 2) {
                        firstName = parts[0];
                        lastName = parts.slice(1).join(' ');
                        break;
                    }
                }
            }
            
            const positionKeywords = ['manager', 'director', 'ceo', 'cto', 'cfo', 'developer', 'engineer', 'consultant', 'analyst', 'specialist', 'coordinator', 'lead', 'head', 'chef', 'responsable', 'directeur', 'directrice', 'g√©rant', 'associ√©', 'partner', 'founder', 'fondateur', 'conseiller', 'banquier'];
            for (const line of lines) {
                const lowerLine = line.toLowerCase();
                if (positionKeywords.some(keyword => lowerLine.includes(keyword))) {
                    position = line.trim();
                    break;
                }
            }
            
            for (const line of lines) {
                if (line.toLowerCase().includes('chez ') || line.toLowerCase().includes(' at ') || line.toLowerCase().includes('cyrus')) {
                    company = line.replace(/chez |at /gi, '').trim();
                    break;
                }
            }
            
            return { firstName, lastName, position, company };
        }

        function capitalizeWord(str) {
            if (!str) return '';
            return str.charAt(0).toUpperCase() + str.slice(1).toLowerCase();
        }

        function extractNameFromLinkedInUrl(url) {
            const username = extractLinkedInUsername(url);
            if (!username) return { firstName: '', lastName: '' };
            let slug = decodeURIComponent(username).toLowerCase().replace(/\d+/g, '').replace(/_/g, '-').replace(/\s+/g, '-');
            const parts = slug.split('-').filter(Boolean);
            if (parts.length === 0) return { firstName: '', lastName: '' };
            if (parts.length === 1) return { firstName: capitalizeWord(parts[0]), lastName: '' };
            if (parts.length === 2) return { firstName: capitalizeWord(parts[0]), lastName: capitalizeWord(parts[1]) };
            return { firstName: parts.slice(0, -1).map(capitalizeWord).join(' '), lastName: capitalizeWord(parts[parts.length - 1]) };
        }

        function analyzeProfile(profileText) {
            const wordCount = processText(profileText).length;
            
            // Normaliser le texte du profil
            const normalizedText = profileText.toLowerCase()
                .normalize('NFD').replace(/[\u0300-\u036f]/g, '');
            
            const axisScores = state.brandDNA.map(axis => {
                // Un keyword est trouv√© s'il appara√Æt dans le texte (en tant que substring)
                const foundKeywords = axis.keywords.filter(keyword => {
                    const normalizedKeyword = keyword.toLowerCase()
                        .normalize('NFD').replace(/[\u0300-\u036f]/g, '');
                    return normalizedText.includes(normalizedKeyword);
                });
                const rawScore = (foundKeywords.length / axis.keywords.length) * 100;
                return {
                    axisId: axis.id,
                    axisName: axis.name,
                    score: Math.round(rawScore),
                    foundKeywords: foundKeywords,
                    missingKeywords: axis.keywords.filter(k => !foundKeywords.includes(k))
                };
            });
            const totalWeight = state.brandDNA.reduce((sum, axis) => sum + axis.weight, 0);
            const globalScore = Math.round(
                axisScores.reduce((sum, score) => {
                    const axis = state.brandDNA.find(a => a.id === score.axisId);
                    return sum + (score.score * axis.weight / totalWeight);
                }, 0)
            );
            return { globalScore, axisScores, wordCount, analyzedAt: new Date().toISOString() };
        }

        function calculateSSI(profileText, employee) {
            const text = profileText.toLowerCase();
            const words = processText(profileText);
            const wordCount = words.length;
            let brandScore = 0;
            brandScore += (employee.firstName && employee.lastName) ? 5 : 0;
            brandScore += employee.position ? 5 : 0;
            brandScore += wordCount >= 200 ? 10 : (wordCount >= 100 ? 5 : 0);
            brandScore += (text.includes('expert') || text.includes('sp√©cialiste') || text.includes('passion')) ? 5 : 0;
            const networkKeywords = ['r√©seau', 'network', 'professionnel', 'contact', 'relation', 'partenaire', 'collaboration'];
            const peopleScore = Math.min(25, networkKeywords.filter(k => text.includes(k)).length * 4);
            const engageKeywords = ['partage', 'publication', 'article', 'insight', 'analyse', 'expertise', 'conseil', 'contribution'];
            const engagementScore = Math.min(25, engageKeywords.filter(k => text.includes(k)).length * 3.5);
            const relationKeywords = ['accompagnement', '√©coute', 'client', 'confiance', 'long-terme', 'fid√©lit√©', 'suivi', 'proximit√©'];
            const relationScore = Math.min(25, relationKeywords.filter(k => text.includes(k)).length * 3.5);
            const ssiScore = Math.round(brandScore + peopleScore + engagementScore + relationScore);
            let sectorRanking = 50, networkRanking = 50;
            if (ssiScore >= 75) { sectorRanking = 10; networkRanking = 15; }
            else if (ssiScore >= 60) { sectorRanking = 20; networkRanking = 24; }
            else if (ssiScore >= 45) { sectorRanking = 35; networkRanking = 40; }
            else if (ssiScore >= 30) { sectorRanking = 50; networkRanking = 55; }
            return { ssiScore, ssiBrandScore: Math.round(brandScore), ssiPeopleScore: Math.round(peopleScore), ssiEngagementScore: Math.round(engagementScore), ssiRelationScore: Math.round(relationScore), ssiSectorRanking: sectorRanking, ssiNetworkRanking: networkRanking, ssiAvgSectorScore: 32, ssiAvgNetworkScore: 36 };
        }

        function calculateLinkedInScore(profileText, employee) {
            const text = profileText.toLowerCase();
            const words = processText(profileText);
            const wordCount = words.length;
            const sections = {
                hasName: (employee.firstName && employee.lastName) ? 20 : 0,
                hasPosition: employee.position ? 15 : 0,
                hasCompany: employee.company ? 10 : 0,
                hasRichContent: wordCount >= 200 ? 25 : (wordCount >= 100 ? 15 : wordCount >= 50 ? 10 : 0),
                hasExperience: (text.includes('exp√©rience') || text.includes('experience') || text.includes('depuis') || text.includes('ann√©es')) ? 15 : 0,
                hasSkills: (text.includes('comp√©tence') || text.includes('expertise') || text.includes('ma√Ætrise') || text.includes('skills')) ? 15 : 0
            };
            const completudeScore = Object.values(sections).reduce((a, b) => a + b, 0);
            const coherenceScore = employee.globalScore;
            const seoKeywords = ['patrimoine', 'gestion', 'conseil', 'strat√©gie', 'investissement', 'finance', 'immobilier', 'transmission', 'accompagnement', 'dirigeant', 'entrepreneur', 'famille', 'performance', 'optimisation', 'allocation'];
            const foundSEOKeywords = seoKeywords.filter(kw => text.includes(kw));
            const visibilityScore = Math.min(100, (foundSEOKeywords.length / seoKeywords.length) * 100 + (wordCount >= 200 ? 20 : 0));
            const engagementIndicators = {
                hasActionVerbs: /\b(accompagn|d√©velopp|conseill|aid|soutien|guid|optimis|transform|innov|cr√©√©|r√©alis|pilote)\w*/.test(text) ? 25 : 0,
                hasNumbers: /\d+/.test(text) ? 20 : 0,
                hasImpactWords: (text.includes('impact') || text.includes('r√©sultat') || text.includes('succ√®s') || text.includes('croissance') || text.includes('am√©lioration')) ? 25 : 0,
                hasProfessionalTone: wordCount >= 150 ? 15 : (wordCount >= 80 ? 10 : 0),
                hasClientFocus: (text.includes('client') || text.includes('partenaire') || text.includes('relation')) ? 15 : 0
            };
            const engagementScore = Object.values(engagementIndicators).reduce((a, b) => a + b, 0);
            const linkedinGlobalScore = Math.round((completudeScore + coherenceScore + visibilityScore + engagementScore) / 4);
            return { linkedinGlobalScore, completudeScore: Math.round(completudeScore), coherenceScore: Math.round(coherenceScore), visibilityScore: Math.round(visibilityScore), engagementScore: Math.round(engagementScore), foundSEOKeywords };
        }

        // ===== SCORE ATS (Applicant Tracking System) =====
        function calculateATSScore(profileText, employee, deptName) {
            const text = profileText.toLowerCase();
            const normalizedText = text.normalize('NFD').replace(/[\u0300-\u036f]/g, '');
            
            // Dictionnaire de synonymes
            const synonyms = {
                'daf': ['cfo', 'directeur financier', 'directeur administratif financier'],
                'drh': ['chro', 'directeur ressources humaines', 'chief people officer'],
                'dg': ['ceo', 'directeur g√©n√©ral', 'pdg', 'pr√©sident'],
                'dsi': ['cio', 'cto', 'directeur syst√®mes information'],
                'kam': ['key account manager', 'grands comptes'],
                'csm': ['customer success manager', 'customer success'],
                'sdr': ['sales development representative', 'business development representative'],
                'crm': ['salesforce', 'hubspot', 'dynamics', 'pipedrive'],
                'erp': ['sap', 'oracle', 'sage', 'cegid'],
                'bi': ['power bi', 'tableau', 'qlik', 'looker']
            };
            
            // Fonction pour chercher avec synonymes
            const findWithSynonyms = (searchText, keywords) => {
                return keywords.filter(kw => {
                    const kwLower = kw.toLowerCase();
                    if (searchText.includes(kwLower)) return true;
                    // V√©rifier les synonymes
                    for (const [key, syns] of Object.entries(synonyms)) {
                        if (kwLower.includes(key) || syns.some(s => kwLower.includes(s))) {
                            if (searchText.includes(key) || syns.some(s => searchText.includes(s))) return true;
                        }
                    }
                    return false;
                });
            };
            
            // 1. TitleFit (0-20) - Correspondance des titres
            const seniorTitles = ['directeur', 'director', 'head', 'lead', 'responsable', 'manager', 'chief', 'vp', 'vice-pr√©sident', 'associ√©', 'partner', 'pr√©sident', 'ceo', 'cfo', 'cto', 'coo'];
            const hasSeniorTitle = seniorTitles.some(t => normalizedText.includes(t));
            const titleMatch = employee.position ? 12 : 0;
            const seniorBonus = hasSeniorTitle ? 8 : 0;
            const titleFit = Math.min(20, titleMatch + seniorBonus);
            
            // 2. ToolsFit (0-15) - Outils et technologies
            const toolsKeywords = [
                // CRM & Sales
                'salesforce', 'hubspot', 'pipedrive', 'dynamics', 'zoho',
                // Finance & Compta
                'sap', 'oracle', 'sage', 'cegid', 'quadra', 'excel', 'vba',
                // BI & Data
                'power bi', 'tableau', 'qlik', 'looker', 'sql', 'python',
                // Marketing
                'google analytics', 'semrush', 'mailchimp', 'marketo', 'pardot',
                // IT & Support
                'servicenow', 'jira', 'confluence', 'zendesk', 'freshdesk',
                // RH
                'workday', 'talentsoft', 'cornerstone', 'linkedin recruiter',
                // Collaboration
                'microsoft 365', 'google workspace', 'slack', 'teams', 'notion', 'trello', 'asana'
            ];
            const foundTools = toolsKeywords.filter(t => normalizedText.includes(t.toLowerCase()));
            const toolsFit = Math.min(15, Math.round((foundTools.length / 5) * 15));
            
            // 3. SeniorityFit (0-15) - Anciennet√© et progression
            // D√©tecter les ann√©es d'exp√©rience
            const yearsPatterns = [
                /(\d+)\s*(?:ans?|ann√©es?)\s*(?:d['']?exp√©rience|d['']?exp)/gi,
                /(?:depuis|from)\s*(\d{4})/gi,
                /(\d+)\+?\s*(?:years?|ans?)/gi
            ];
            let totalYears = 0;
            yearsPatterns.forEach(pattern => {
                const matches = normalizedText.matchAll(pattern);
                for (const match of matches) {
                    const num = parseInt(match[1]);
                    if (num > 1900 && num < 2030) {
                        totalYears = Math.max(totalYears, 2025 - num);
                    } else if (num < 50) {
                        totalYears = Math.max(totalYears, num);
                    }
                }
            });
            
            // D√©tecter progression de carri√®re
            const progressionKeywords = ['√©volution', 'promotion', 'promu', 'devenu', 'nomm√©', 'progression'];
            const hasProgression = progressionKeywords.some(p => normalizedText.includes(p));
            
            const yearsScore = Math.min(10, totalYears >= 10 ? 10 : totalYears >= 5 ? 7 : totalYears >= 2 ? 4 : 2);
            const progressionBonus = hasProgression ? 5 : (hasSeniorTitle ? 3 : 0);
            const seniorityFit = Math.min(15, yearsScore + progressionBonus);
            
            // 4. ImpactKPI (0-25) - R√©sultats chiffr√©s et KPIs
            const kpiPatterns = [
                /[+\-]?\d+(?:[,\.]\d+)?\s*%/g,                    // Pourcentages
                /\d+(?:[,\.]\d+)?\s*[kKmM]?‚Ç¨/g,                   // Montants euros
                /‚Ç¨\s*\d+(?:[,\.]\d+)?\s*[kKmM]?/g,                // Euros avant
                /\d+(?:[,\.]\d+)?\s*(?:millions?|mio|m‚Ç¨|k‚Ç¨)/gi,   // Millions/K
                /(?:x|√ó)\s*\d+(?:[,\.]\d+)?/g,                    // Multiplicateurs
                /\d+\s*(?:clients?|comptes?|dossiers?|projets?)/gi, // Volumes
                /(?:arr|mrr|aum|nps|csat|ebitda|ca|chiffre d'affaires)[\s:]*\d+/gi, // KPIs nomm√©s
                /(?:top|n¬∞)\s*\d+/gi,                              // Rankings
                /\d+\s*(?:collaborateurs?|personnes?|√©quipe)/gi    // Taille √©quipe
            ];
            
            let kpiCount = 0;
            let kpiQuality = 0;
            const kpiMatches = [];
            
            kpiPatterns.forEach(pattern => {
                const matches = normalizedText.match(pattern) || [];
                kpiCount += matches.length;
                matches.forEach(m => kpiMatches.push(m));
            });
            
            // Qualit√© des KPIs (avec contexte d'impact)
            const impactWords = ['augment', 'croissance', 'hausse', 'progression', 'am√©lio', 'r√©duit', 'baisse', 'diminut', 'optimis', 'g√©n√©r', 'atteint', 'd√©pass', 'r√©alis'];
            const hasImpactContext = impactWords.some(w => normalizedText.includes(w));
            kpiQuality = hasImpactContext ? 1 : (kpiCount > 0 ? 0.5 : 0);
            
            const impactKPI = Math.min(25, Math.round(5 * Math.log1p(kpiCount) + 15 * kpiQuality));
            
            // 5. Credibility (0-15) - Cr√©dibilit√©
            // Recommandations
            const recoMatch = normalizedText.match(/(\d+)\s*recommandation/i);
            const recoCount = recoMatch ? parseInt(recoMatch[1]) : 0;
            const recoScore = Math.min(5, recoCount);
            
            // Certifications pertinentes
            const certKeywords = ['certifi', 'dipl√¥m', 'master', 'mba', 'cfa', 'amf', 'acpr', 'cgp', 'cif', 'iobsp', 'ias', 'aws', 'google', 'scrum', 'pmp', 'itil', 'prince2'];
            const certCount = certKeywords.filter(c => normalizedText.includes(c)).length;
            const certScore = Math.min(5, certCount * 1.5);
            
            // Stabilit√© (mentions de dur√©e longue)
            const stabilityPatterns = [/(\d+)\s*ans?\s*(?:chez|at|dans)/gi, /depuis\s*(\d{4})/gi];
            let hasStability = false;
            stabilityPatterns.forEach(pattern => {
                const matches = normalizedText.matchAll(pattern);
                for (const match of matches) {
                    const num = parseInt(match[1]);
                    if ((num >= 3 && num < 50) || (num > 1900 && 2025 - num >= 3)) {
                        hasStability = true;
                    }
                }
            });
            const stabilityScore = hasStability ? 3 : 1;
            
            // Connexions LinkedIn
            const connexionMatch = normalizedText.match(/(\d+)\s*(?:connexions?|relations?|contacts?)/i);
            const connexionCount = connexionMatch ? parseInt(connexionMatch[1]) : 0;
            const connexionScore = connexionCount >= 500 ? 2 : (connexionCount >= 200 ? 1 : 0);
            
            const credibility = Math.min(15, Math.round(recoScore + certScore + stabilityScore + connexionScore));
            
            // 6. ContextFit (0-10) - Contexte
            const locationKeywords = ['paris', 'lyon', 'marseille', 'bordeaux', 'nantes', 'toulouse', 'lille', 'france', '√Æle-de-france', 'remote', 't√©l√©travail', 'hybride'];
            const hasLocation = locationKeywords.some(l => normalizedText.includes(l));
            
            const sectorKeywords = ['finance', 'banque', 'assurance', 'patrimoine', 'gestion', 'investissement', 'conseil', 'audit', 'immobilier'];
            const hasSector = sectorKeywords.some(s => normalizedText.includes(s));
            
            const contextFit = (hasLocation ? 5 : 2) + (hasSector ? 5 : 2);
            
            // Score final ATS (pond√©r√© selon la cat√©gorie)
            const weights = {
                titleFit: 0.15,
                toolsFit: 0.12,
                seniorityFit: 0.13,
                impactKPI: 0.25,
                credibility: 0.15,
                contextFit: 0.08,
                keywordFit: 0.12  // Utilise le score m√©tier existant
            };
            
            // R√©cup√©rer le score m√©tier comme keywordFit
            const deptScore = employee.deptScore || 0;
            const keywordFitNormalized = (deptScore / 100) * 20; // Normaliser sur 20
            
            const rawScore = 
                (titleFit / 20) * 100 * weights.titleFit +
                (toolsFit / 15) * 100 * weights.toolsFit +
                (seniorityFit / 15) * 100 * weights.seniorityFit +
                (impactKPI / 25) * 100 * weights.impactKPI +
                (credibility / 15) * 100 * weights.credibility +
                (contextFit / 10) * 100 * weights.contextFit +
                (keywordFitNormalized / 20) * 100 * weights.keywordFit;
            
            const atsScore = Math.round(rawScore);
            
            // D√©cision ATS
            let atsDecision, atsDecisionColor;
            if (atsScore >= 80) {
                atsDecision = "üü¢ Shortlist";
                atsDecisionColor = "green";
            } else if (atsScore >= 65) {
                atsDecision = "üü° √Ä examiner";
                atsDecisionColor = "yellow";
            } else if (atsScore >= 40) {
                atsDecision = "üü† En attente";
                atsDecisionColor = "orange";
            } else {
                atsDecision = "üî¥ Non retenu";
                atsDecisionColor = "red";
            }
            
            return {
                atsScore,
                atsDecision,
                atsDecisionColor,
                atsTitleFit: titleFit,
                atsToolsFit: toolsFit,
                atsSeniorityFit: seniorityFit,
                atsImpactKPI: impactKPI,
                atsCredibility: credibility,
                atsContextFit: contextFit,
                atsFoundTools: foundTools,
                atsKPICount: kpiCount,
                atsKPIMatches: kpiMatches.slice(0, 10),
                atsTotalYears: totalYears,
                atsHasProgression: hasProgression,
                atsCertCount: certCount,
                atsRecoCount: recoCount
            };
        }

        function calculateDeptScore(profileText, deptName) {
            const dept = state.departments.find(d => d.name === deptName);
            if (!dept) return { score: 0, foundKeywords: [], missingKeywords: [], totalKeywords: 0 };
            
            // Normaliser le texte du profil
            const normalizedText = profileText.toLowerCase()
                .normalize('NFD').replace(/[\u0300-\u036f]/g, '');
            
            // Un keyword est trouv√© s'il appara√Æt dans le texte (en tant que substring)
            const foundKeywords = dept.keywords.filter(keyword => {
                const normalizedKeyword = keyword.toLowerCase()
                    .normalize('NFD').replace(/[\u0300-\u036f]/g, '');
                return normalizedText.includes(normalizedKeyword);
            });
            
            return { 
                score: Math.round((foundKeywords.length / dept.keywords.length) * 100), 
                foundKeywords, 
                missingKeywords: dept.keywords.filter(k => !foundKeywords.includes(k)), 
                totalKeywords: dept.keywords.length 
            };
        }

        function quickAdd() {
            const text = prompt('üìã Collez le contenu du profil LinkedIn ici (Ctrl+V / Cmd+V) :');
            if (!text || text.length < 50) {
                alert('‚ùå Le texte est vide ou trop court. Veuillez copier le profil complet depuis LinkedIn.');
                return;
            }
            const rawLinkedinUrl = prompt('üîó Collez l\'URL du profil LinkedIn (optionnel) :') || '';
            let linkedinUrl = '';
            if (rawLinkedinUrl.trim() !== '' && isValidLinkedInURL(rawLinkedinUrl.trim())) {
                linkedinUrl = rawLinkedinUrl.trim();
            }
            const extracted = extractProfileInfo(text);
            const analysis = analyzeProfile(text);
            let firstName = extracted.firstName || (linkedinUrl ? extractNameFromLinkedInUrl(linkedinUrl).firstName : '') || 'Pr√©nom';
            let lastName = extracted.lastName || (linkedinUrl ? extractNameFromLinkedInUrl(linkedinUrl).lastName : '') || 'Nom';
            let autoDept = '', maxScore = 0;
            state.departments.forEach(dept => {
                const deptAnalysis = calculateDeptScore(text, dept.name);
                if (deptAnalysis.score > maxScore) { maxScore = deptAnalysis.score; autoDept = dept.name; }
            });
            const deptAnalysis = calculateDeptScore(text, autoDept);
            const newEmployee = {
                id: Date.now(), firstName, lastName, position: extracted.position || 'Poste', department: autoDept,
                company: extracted.company || state.targetCompany, linkedinUrl, email: '', profileText: text,
                globalScore: analysis.globalScore, axisScores: analysis.axisScores, wordCount: analysis.wordCount,
                analyzedAt: analysis.analyzedAt, deptScore: deptAnalysis.score, deptFoundKeywords: deptAnalysis.foundKeywords,
                deptMissingKeywords: deptAnalysis.missingKeywords, deptTotalKeywords: deptAnalysis.totalKeywords, createdAt: new Date().toISOString()
            };
            Object.assign(newEmployee, calculateLinkedInScore(text, newEmployee), calculateSSI(text, newEmployee));
            Object.assign(newEmployee, calculateATSScore(text, newEmployee, autoDept));
            state.employees.push(newEmployee);
            saveState();
            render();
            alert('‚úÖ Profil ajout√© : ' + newEmployee.firstName + ' ' + newEmployee.lastName + 
                '\n\nüìä Score SSI : ' + newEmployee.ssiScore + '/100' +
                '\nüîµ Score LinkedIn : ' + newEmployee.linkedinGlobalScore + '/100' +
                '\nüß¨ Score ADN : ' + newEmployee.globalScore + '/100' +
                '\nüíº Score M√©tier : ' + newEmployee.deptScore + '/100' +
                '\nüéØ Score ATS : ' + newEmployee.atsScore + '/100 ' + newEmployee.atsDecision);
        }

        function deleteEmployee(id) {
            if (confirm('Supprimer ce collaborateur ?')) {
                state.employees = state.employees.filter(emp => emp.id !== id);
                saveState();
                render();
            }
        }

        function viewEmployee(id) {
            state.selectedEmployee = state.employees.find(emp => emp.id === id);
            state.currentView = 'detail';
            render();
        }

        function exportData() {
            const blob = new Blob([JSON.stringify({ employees: state.employees, brandDNA: state.brandDNA, departments: state.departments, targetCompany: state.targetCompany }, null, 2)], { type: 'application/json' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'linkedin-analyzer-' + Date.now() + '.json';
            a.click();
        }

        function clearAllData() {
            if (confirm('‚ö†Ô∏è Supprimer TOUTES les donn√©es ? Cette action est irr√©versible.')) {
                state.employees = [];
                saveState();
                render();
            }
        }

        function getScoreBadge(score) {
            if (score >= 70) return 'bg-green-100 text-green-800';
            if (score >= 40) return 'bg-yellow-100 text-yellow-800';
            return 'bg-red-100 text-red-800';
        }

        function getScoreColor(score) {
            if (score >= 70) return 'text-green-600';
            if (score >= 40) return 'text-yellow-600';
            return 'text-red-600';
        }

        // ===== FONCTIONS DE SYNTH√àSE ET PR√âCONISATIONS =====
        
        function getSSISynthesis(emp) {
            const score = emp.ssiScore || 0;
            const brand = emp.ssiBrandScore || 0;
            const people = emp.ssiPeopleScore || 0;
            const engagement = emp.ssiEngagementScore || 0;
            const relation = emp.ssiRelationScore || 0;
            
            let level, description;
            if (score >= 75) {
                level = "üèÜ Excellent";
                description = `${emp.firstName} fait partie des meilleurs profils du secteur avec un SSI de ${score}/100. Son personal branding est solide et son activit√© LinkedIn g√©n√®re de l'engagement.`;
            } else if (score >= 55) {
                level = "‚úÖ Bon";
                description = `${emp.firstName} a un bon niveau d'activit√© sur LinkedIn avec un SSI de ${score}/100. Quelques optimisations permettraient d'atteindre l'excellence.`;
            } else if (score >= 35) {
                level = "‚ö†Ô∏è √Ä d√©velopper";
                description = `${emp.firstName} a un SSI de ${score}/100, inf√©rieur √† la moyenne du secteur. Un plan d'action cibl√© est recommand√© pour am√©liorer sa visibilit√©.`;
            } else {
                level = "üî¥ Faible";
                description = `${emp.firstName} a un SSI de ${score}/100, ce qui indique une pr√©sence LinkedIn √† construire. Une formation aux fondamentaux serait b√©n√©fique.`;
            }
            
            // Identifier les points forts et faibles
            const factors = [
                { name: "Marque professionnelle", score: brand, icon: "üèÜ" },
                { name: "Trouver les bonnes personnes", score: people, icon: "üë•" },
                { name: "√âchanger des informations", score: engagement, icon: "üí¨" },
                { name: "√âtablir des relations", score: relation, icon: "ü§ù" }
            ];
            
            const strengths = factors.filter(f => f.score >= 18).sort((a, b) => b.score - a.score);
            const weaknesses = factors.filter(f => f.score < 15).sort((a, b) => a.score - b.score);
            
            return { level, description, strengths, weaknesses };
        }
        
        function getSSIRecommendations(emp) {
            const recommendations = [];
            const brand = emp.ssiBrandScore || 0;
            const people = emp.ssiPeopleScore || 0;
            const engagement = emp.ssiEngagementScore || 0;
            const relation = emp.ssiRelationScore || 0;
            
            // Marque professionnelle
            if (brand < 20) {
                if (brand < 10) {
                    recommendations.push({
                        priority: "haute",
                        category: "üèÜ Marque professionnelle",
                        actions: [
                            "Compl√©ter le titre avec des mots-cl√©s m√©tier (ex: 'Conseiller en Gestion de Patrimoine | Expert Transmission')",
                            "R√©diger un r√©sum√© percutant de 3-4 paragraphes avec votre proposition de valeur",
                            "Ajouter une photo professionnelle de qualit√© (fond neutre, sourire)",
                            "Personnaliser la banni√®re avec les couleurs Cyrus Herez"
                        ]
                    });
                } else {
                    recommendations.push({
                        priority: "moyenne",
                        category: "üèÜ Marque professionnelle",
                        actions: [
                            "Enrichir le r√©sum√© avec des r√©alisations chiffr√©es",
                            "Ajouter des m√©dias (pr√©sentations, articles, vid√©os)",
                            "Demander 3-5 recommandations √† des clients ou partenaires"
                        ]
                    });
                }
            }
            
            // Trouver les bonnes personnes
            if (people < 20) {
                if (people < 10) {
                    recommendations.push({
                        priority: "haute",
                        category: "üë• D√©velopper son r√©seau",
                        actions: [
                            "Atteindre 500+ connexions pour plus de cr√©dibilit√©",
                            "Se connecter avec les d√©cideurs du secteur patrimonial",
                            "Rejoindre 5+ groupes LinkedIn pertinents (CGP, gestion de fortune, family office)",
                            "Suivre les leaders d'opinion du secteur"
                        ]
                    });
                } else {
                    recommendations.push({
                        priority: "moyenne",
                        category: "üë• D√©velopper son r√©seau",
                        actions: [
                            "Personnaliser les demandes de connexion",
                            "Interagir r√©guli√®rement avec les posts de son r√©seau",
                            "Identifier et suivre les prospects potentiels"
                        ]
                    });
                }
            }
            
            // √âchanger des informations
            if (engagement < 20) {
                if (engagement < 10) {
                    recommendations.push({
                        priority: "haute",
                        category: "üí¨ Partager du contenu",
                        actions: [
                            "Publier 1-2 posts par semaine sur des sujets patrimoniaux",
                            "Commenter 3-5 publications par jour de mani√®re pertinente",
                            "Partager les actualit√©s Cyrus Herez avec un commentaire personnel",
                            "Relayer les articles de presse financi√®re avec votre analyse"
                        ]
                    });
                } else {
                    recommendations.push({
                        priority: "moyenne",
                        category: "üí¨ Partager du contenu",
                        actions: [
                            "Varier les formats : texte, carousel, vid√©o courte",
                            "Cr√©er du contenu √©ducatif (conseils fiscaux, tendances march√©s)",
                            "Taguer les personnes et entreprises mentionn√©es"
                        ]
                    });
                }
            }
            
            // √âtablir des relations
            if (relation < 20) {
                if (relation < 10) {
                    recommendations.push({
                        priority: "haute",
                        category: "ü§ù Construire des relations",
                        actions: [
                            "R√©pondre √† tous les messages dans les 24h",
                            "F√©liciter son r√©seau pour les promotions/anniversaires",
                            "Initier des conversations priv√©es apr√®s des interactions publiques",
                            "Proposer des rendez-vous t√©l√©phoniques ou caf√©s virtuels"
                        ]
                    });
                } else {
                    recommendations.push({
                        priority: "moyenne",
                        category: "ü§ù Construire des relations",
                        actions: [
                            "Utiliser InMail pour les prospects strat√©giques",
                            "Organiser ou participer √† des LinkedIn Live",
                            "Cr√©er des sondages pour engager son audience"
                        ]
                    });
                }
            }
            
            return recommendations;
        }
        
        function getADNSynthesis(emp) {
            const score = emp.globalScore;
            const strongAxes = emp.axisScores.filter(a => a.score >= 60);
            const weakAxes = emp.axisScores.filter(a => a.score < 40);
            
            let level, description;
            if (score >= 70) {
                level = "üèÜ Excellent alignement";
                description = `Le profil de ${emp.firstName} refl√®te parfaitement les valeurs et le positionnement de Cyrus Herez. C'est un excellent ambassadeur de la marque employeur.`;
            } else if (score >= 50) {
                level = "‚úÖ Bon alignement";
                description = `${emp.firstName} incarne correctement l'ADN de Cyrus Herez. Quelques ajustements de vocabulaire renforceraient l'alignement.`;
            } else if (score >= 30) {
                level = "‚ö†Ô∏è Alignement partiel";
                description = `Le profil de ${emp.firstName} n'utilise pas suffisamment le vocabulaire distinctif de Cyrus Herez. Un travail sur le wording est conseill√©.`;
            } else {
                level = "üî¥ Faible alignement";
                description = `Le profil de ${emp.firstName} ne refl√®te pas l'identit√© de Cyrus Herez. Une r√©√©criture guid√©e du profil est recommand√©e.`;
            }
            
            return { level, description, strongAxes, weakAxes };
        }
        
        function getADNRecommendations(emp) {
            const recommendations = [];
            
            emp.axisScores.forEach(axis => {
                if (axis.score < 50 && axis.missingKeywords.length > 0) {
                    const priority = axis.score < 25 ? "haute" : "moyenne";
                    const keywordsToAdd = axis.missingKeywords.slice(0, 5);
                    
                    let contextualAdvice = "";
                    if (axis.axisName.includes("Excellence")) {
                        contextualAdvice = "Mettez en avant votre expertise technique et vos certifications.";
                    } else if (axis.axisName.includes("Ind√©pendance")) {
                        contextualAdvice = "Soulignez votre objectivit√© et votre approche √©thique.";
                    } else if (axis.axisName.includes("sur-mesure")) {
                        contextualAdvice = "Insistez sur la personnalisation et l'√©coute client.";
                    } else if (axis.axisName.includes("long-terme")) {
                        contextualAdvice = "√âvoquez la p√©rennit√© et l'accompagnement dans la dur√©e.";
                    }
                    
                    recommendations.push({
                        priority: priority,
                        category: "üß¨ " + axis.axisName,
                        score: axis.score,
                        advice: contextualAdvice,
                        keywords: keywordsToAdd
                    });
                }
            });
            
            return recommendations.sort((a, b) => a.score - b.score);
        }
        
        function getMetierSynthesis(emp) {
            const score = emp.deptScore;
            const found = emp.deptFoundKeywords?.length || 0;
            const total = emp.deptTotalKeywords || 1;
            
            let level, description;
            if (score >= 60) {
                level = "üèÜ Tr√®s bon positionnement";
                description = `Le profil de ${emp.firstName} utilise ${found} mots-cl√©s sur ${total} du r√©f√©rentiel "${emp.department}". Le positionnement m√©tier est clair et bien articul√©.`;
            } else if (score >= 40) {
                level = "‚úÖ Bon positionnement";
                description = `${emp.firstName} couvre ${found}/${total} termes du r√©f√©rentiel m√©tier. L'ajout de quelques mots-cl√©s sp√©cifiques renforcerait la visibilit√© dans les recherches.`;
            } else if (score >= 20) {
                level = "‚ö†Ô∏è Positionnement partiel";
                description = `Avec ${found}/${total} mots-cl√©s, le profil de ${emp.firstName} manque de terminologie sp√©cifique au m√©tier. Il risque de passer sous le radar des recruteurs et prospects.`;
            } else {
                level = "üî¥ Positionnement faible";
                description = `Le profil de ${emp.firstName} ne contient que ${found}/${total} termes m√©tier. Une optimisation compl√®te est n√©cessaire pour le r√©f√©rencement.`;
            }
            
            return { level, description, found, total };
        }
        
        function getMetierRecommendations(emp) {
            if (!emp.deptMissingKeywords || emp.deptMissingKeywords.length === 0) return [];
            
            // Grouper les mots-cl√©s manquants par cat√©gorie
            const missing = emp.deptMissingKeywords;
            
            // Identifier les types de mots-cl√©s manquants
            const titres = missing.filter(k => 
                k.includes('directeur') || k.includes('responsable') || k.includes('manager') || 
                k.includes('chef') || k.includes('head') || k.includes('ceo') || k.includes('cfo')
            ).slice(0, 3);
            
            const competences = missing.filter(k => 
                !titres.includes(k) && (
                    k.includes('gestion') || k.includes('analyse') || k.includes('strat√©g') ||
                    k.includes('conseil') || k.includes('d√©veloppement') || k.includes('pilotage')
                )
            ).slice(0, 5);
            
            const outils = missing.filter(k => 
                k.includes('crm') || k.includes('erp') || k.includes('excel') || k.includes('power bi') ||
                k.includes('salesforce') || k.includes('sap') || k.includes('hubspot')
            ).slice(0, 3);
            
            const autres = missing.filter(k => 
                !titres.includes(k) && !competences.includes(k) && !outils.includes(k)
            ).slice(0, 5);
            
            const recommendations = [];
            
            if (competences.length > 0) {
                recommendations.push({
                    category: "üí° Comp√©tences cl√©s √† mentionner",
                    keywords: competences,
                    tip: "Int√©grez ces termes dans votre r√©sum√© et descriptions d'exp√©riences."
                });
            }
            
            if (outils.length > 0) {
                recommendations.push({
                    category: "üõ†Ô∏è Outils & Technologies",
                    keywords: outils,
                    tip: "Ajoutez ces outils dans la section Comp√©tences de LinkedIn."
                });
            }
            
            if (autres.length > 0) {
                recommendations.push({
                    category: "üìå Autres termes m√©tier",
                    keywords: autres,
                    tip: "Utilisez ces termes naturellement dans vos descriptions."
                });
            }
            
            return recommendations;
        }
        
        // ===== SYNTH√àSE ET PR√âCONISATIONS ATS =====
        function getATSSynthesis(emp) {
            const score = emp.atsScore || 0;
            
            let level, description, verdict;
            if (score >= 80) {
                level = "üü¢ Shortlist";
                verdict = "Profil hautement qualifi√©";
                description = `Le profil de ${emp.firstName} obtient un excellent score ATS de ${score}/100. Il r√©pond aux crit√®res cl√©s d'un recruteur : exp√©rience, comp√©tences, r√©sultats chiffr√©s. Ce candidat m√©rite d'√™tre contact√© en priorit√©.`;
            } else if (score >= 65) {
                level = "üü° √Ä examiner";
                verdict = "Profil int√©ressant";
                description = `Avec ${score}/100, le profil de ${emp.firstName} pr√©sente de bons atouts mais n√©cessite un examen approfondi. Quelques optimisations permettraient de passer en shortlist.`;
            } else if (score >= 40) {
                level = "üü† En attente";
                verdict = "Profil √† d√©velopper";
                description = `Le score ATS de ${score}/100 indique que le profil de ${emp.firstName} manque d'√©l√©ments cl√©s pour convaincre un recruteur. Des am√©liorations significatives sont n√©cessaires.`;
            } else {
                level = "üî¥ Non retenu";
                verdict = "Profil insuffisant";
                description = `Avec ${score}/100, le profil de ${emp.firstName} ne passerait pas les filtres ATS standard. Une refonte compl√®te du profil est recommand√©e.`;
            }
            
            // Points forts
            const strengths = [];
            if ((emp.atsTitleFit || 0) >= 15) strengths.push("Titre de poste pertinent");
            if ((emp.atsImpactKPI || 0) >= 18) strengths.push("R√©sultats chiffr√©s pr√©sents");
            if ((emp.atsToolsFit || 0) >= 10) strengths.push("Outils ma√Ætris√©s mentionn√©s");
            if ((emp.atsSeniorityFit || 0) >= 12) strengths.push("Exp√©rience solide");
            if ((emp.atsCredibility || 0) >= 10) strengths.push("Cr√©dibilit√© √©tablie");
            
            // Points faibles
            const weaknesses = [];
            if ((emp.atsImpactKPI || 0) < 10) weaknesses.push("Manque de r√©sultats chiffr√©s");
            if ((emp.atsToolsFit || 0) < 5) weaknesses.push("Outils non mentionn√©s");
            if ((emp.atsSeniorityFit || 0) < 8) weaknesses.push("Exp√©rience peu visible");
            if ((emp.atsCredibility || 0) < 8) weaknesses.push("Cr√©dibilit√© √† renforcer");
            
            return { level, verdict, description, strengths, weaknesses };
        }
        
        function getATSRecommendations(emp) {
            const recommendations = [];
            
            // ImpactKPI - Le plus important !
            if ((emp.atsImpactKPI || 0) < 18) {
                const priority = (emp.atsImpactKPI || 0) < 10 ? "haute" : "moyenne";
                recommendations.push({
                    priority,
                    category: "üìä Ajouter des r√©sultats chiffr√©s",
                    pillar: "ImpactKPI",
                    score: emp.atsImpactKPI || 0,
                    maxScore: 25,
                    actions: [
                        "Quantifier vos r√©alisations avec des % (ex: '+25% de CA', '-15% de co√ªts')",
                        "Mentionner les montants g√©r√©s (ex: 'Portefeuille de 50M‚Ç¨', 'Budget de 2M‚Ç¨')",
                        "Indiquer les volumes trait√©s (ex: '200 clients', '50 dossiers/mois')",
                        "Ajouter des KPIs m√©tier (NPS, CSAT, AUM, ARR, taux de conversion...)",
                        "Pr√©ciser la taille des √©quipes manag√©es"
                    ],
                    examples: [
                        "‚ùå 'Responsable du d√©veloppement commercial'",
                        "‚úÖ 'D√©veloppement du CA de +35% (2M‚Ç¨‚Üí2.7M‚Ç¨) sur 18 mois, portefeuille de 150 clients'"
                    ]
                });
            }
            
            // ToolsFit
            if ((emp.atsToolsFit || 0) < 10) {
                recommendations.push({
                    priority: "moyenne",
                    category: "üõ†Ô∏è Mentionner les outils ma√Ætris√©s",
                    pillar: "ToolsFit",
                    score: emp.atsToolsFit || 0,
                    maxScore: 15,
                    actions: [
                        "Lister les logiciels m√©tier dans la section Comp√©tences",
                        "Mentionner les outils dans les descriptions d'exp√©riences",
                        "Ajouter les certifications logicielles obtenues"
                    ],
                    suggestedTools: [
                        "CRM : Salesforce, HubSpot, Dynamics, Pipedrive",
                        "Finance : SAP, Oracle, Sage, Cegid, Excel avanc√©",
                        "BI/Data : Power BI, Tableau, SQL, Python",
                        "Marketing : Google Analytics, SEMrush, Mailchimp",
                        "Collaboration : Microsoft 365, Slack, Notion, Jira"
                    ]
                });
            }
            
            // SeniorityFit
            if ((emp.atsSeniorityFit || 0) < 10) {
                recommendations.push({
                    priority: "moyenne",
                    category: "üìÖ Valoriser l'exp√©rience",
                    pillar: "SeniorityFit",
                    score: emp.atsSeniorityFit || 0,
                    maxScore: 15,
                    actions: [
                        "Pr√©ciser le nombre d'ann√©es d'exp√©rience dans le r√©sum√©",
                        "Montrer la progression de carri√®re (promotions, √©volutions)",
                        "Dater clairement chaque exp√©rience (mois/ann√©e)",
                        "Mettre en avant les responsabilit√©s croissantes"
                    ]
                });
            }
            
            // TitleFit
            if ((emp.atsTitleFit || 0) < 15) {
                recommendations.push({
                    priority: "moyenne",
                    category: "üè∑Ô∏è Optimiser le titre",
                    pillar: "TitleFit",
                    score: emp.atsTitleFit || 0,
                    maxScore: 20,
                    actions: [
                        "Utiliser un titre de poste standard et recherch√©",
                        "Ajouter des mots-cl√©s m√©tier au titre (ex: 'CGP | Gestion de Patrimoine | Transmission')",
                        "√âviter les titres trop cr√©atifs non reconnus par les ATS"
                    ]
                });
            }
            
            // Credibility
            if ((emp.atsCredibility || 0) < 10) {
                recommendations.push({
                    priority: "basse",
                    category: "üèÖ Renforcer la cr√©dibilit√©",
                    pillar: "Credibility",
                    score: emp.atsCredibility || 0,
                    maxScore: 15,
                    actions: [
                        "Demander des recommandations LinkedIn (objectif : 5+)",
                        "Ajouter les certifications professionnelles (AMF, CIF, IOBSP...)",
                        "Mentionner les formations dipl√¥mantes (Master, MBA, CFA...)",
                        "Montrer une stabilit√© professionnelle (dur√©es > 2 ans)"
                    ]
                });
            }
            
            return recommendations.sort((a, b) => {
                const priorityOrder = { haute: 0, moyenne: 1, basse: 2 };
                return priorityOrder[a.priority] - priorityOrder[b.priority];
            });
        }

        function handleAddEmployee(event) {
            event.preventDefault();
            const profileText = document.getElementById('profileText').value;
            const linkedinUrl = document.getElementById('linkedinUrl')?.value || '';
            const email = document.getElementById('email')?.value || '';
            const department = document.getElementById('department').value;
            if (linkedinUrl && !isValidLinkedInURL(linkedinUrl)) { alert('‚ö†Ô∏è URL LinkedIn invalide'); return; }
            if (email && !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) { alert('‚ö†Ô∏è Email invalide'); return; }
            const analysis = analyzeProfile(profileText);
            const deptAnalysis = calculateDeptScore(profileText, department);
            const newEmployee = {
                id: Date.now(), firstName: document.getElementById('firstName').value, lastName: document.getElementById('lastName').value,
                position: document.getElementById('position').value, department, company: document.getElementById('company').value,
                email, linkedinUrl, profileText, globalScore: analysis.globalScore, axisScores: analysis.axisScores,
                wordCount: analysis.wordCount, analyzedAt: analysis.analyzedAt, deptScore: deptAnalysis.score,
                deptFoundKeywords: deptAnalysis.foundKeywords, deptMissingKeywords: deptAnalysis.missingKeywords,
                deptTotalKeywords: deptAnalysis.totalKeywords, createdAt: new Date().toISOString()
            };
            Object.assign(newEmployee, calculateLinkedInScore(profileText, newEmployee), calculateSSI(profileText, newEmployee));
            Object.assign(newEmployee, calculateATSScore(profileText, newEmployee, department));
            state.employees.push(newEmployee);
            saveState();
            state.currentView = 'list';
            render();
            alert('‚úÖ Profil ajout√© avec succ√®s !');
        }

        function renderHeader() {
            return `<header class="bg-gradient-to-r from-blue-900 to-blue-800 shadow-lg border-b">
                <div class="max-w-7xl mx-auto px-4 py-4">
                    <div class="flex items-center justify-between">
                        <div>
                            <h1 class="text-2xl font-bold text-white">Analyseur LinkedIn - Cyrus Herez</h1>
                            <p class="text-sm text-blue-100 mt-1">Alignement des profils avec l'ADN de l'entreprise</p>
                        </div>
                        <div class="flex gap-2">
                            <button onclick="exportData()" class="p-2 text-white hover:bg-blue-700 rounded-lg" title="Exporter">üì•</button>
                            <button onclick="clearAllData()" class="p-2 text-white hover:bg-red-700 rounded-lg" title="Tout supprimer">üóëÔ∏è</button>
                        </div>
                    </div>
                </div>
            </header>`;
        }

        function renderEmployeeList() {
            const avgScore = state.employees.length > 0 ? Math.round(state.employees.reduce((sum, emp) => sum + emp.globalScore, 0) / state.employees.length) : 0;
            const avgLinkedInScore = state.employees.length > 0 ? Math.round(state.employees.reduce((sum, emp) => sum + (emp.linkedinGlobalScore || 0), 0) / state.employees.length) : 0;
            const avgSSIScore = state.employees.length > 0 ? Math.round(state.employees.reduce((sum, emp) => sum + (emp.ssiScore || 0), 0) / state.employees.length) : 0;
            const avgATSScore = state.employees.length > 0 ? Math.round(state.employees.reduce((sum, emp) => sum + (emp.atsScore || 0), 0) / state.employees.length) : 0;
            
            let html = `<div class="space-y-4">
                <div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-lg border border-blue-200">
                    <h3 class="text-lg font-bold text-blue-900 mb-2">üèõÔ∏è Cyrus Herez - Gestion Patrimoniale</h3>
                    <p class="text-sm text-blue-800 mb-3">${state.companyMission}</p>
                </div>`;
            
            if (state.employees.length > 0) {
                html += `<div class="grid grid-cols-6 gap-3">
                    <div class="bg-white p-3 rounded-lg shadow-sm text-center"><p class="text-2xl font-bold text-blue-600">${state.employees.length}</p><p class="text-xs text-gray-600">Profils</p></div>
                    <div class="bg-white p-3 rounded-lg shadow-sm text-center"><p class="text-2xl font-bold text-purple-600">${avgSSIScore}</p><p class="text-xs text-gray-600">SSI moy.</p></div>
                    <div class="bg-white p-3 rounded-lg shadow-sm text-center"><p class="text-2xl font-bold text-indigo-600">${avgLinkedInScore}</p><p class="text-xs text-gray-600">LinkedIn</p></div>
                    <div class="bg-white p-3 rounded-lg shadow-sm text-center"><p class="text-2xl font-bold text-green-600">${avgScore}</p><p class="text-xs text-gray-600">ADN moy.</p></div>
                    <div class="bg-white p-3 rounded-lg shadow-sm text-center"><p class="text-2xl font-bold text-amber-600">${avgATSScore}</p><p class="text-xs text-gray-600">ATS moy.</p></div>
                    <div class="bg-white p-3 rounded-lg shadow-sm text-center"><p class="text-2xl font-bold text-emerald-600">${state.employees.filter(e => (e.atsScore || 0) >= 65).length}</p><p class="text-xs text-gray-600">Shortlist</p></div>
                </div>`;
            }
            
            html += `<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <button onclick="quickAdd()" class="bg-gradient-to-r from-blue-600 to-blue-700 text-white py-4 rounded-lg hover:from-blue-700 hover:to-blue-800 shadow-lg">
                    <div class="font-bold">‚ö° Coller le texte</div>
                    <div class="text-xs opacity-90">Copier-coller le profil LinkedIn</div>
                </button>
                <button onclick="state.currentView = 'add'; render();" class="bg-white border-2 border-gray-300 text-gray-700 py-4 rounded-lg hover:bg-gray-50">
                    <div class="font-bold">‚ûï Saisie manuelle</div>
                    <div class="text-xs text-gray-600">Formulaire complet</div>
                </button>
            </div>`;
            
            html += '<div class="grid gap-4">';
            state.employees.forEach(emp => {
                const atsDecisionBadge = (emp.atsScore || 0) >= 80 ? 'bg-green-100 text-green-700' : 
                    (emp.atsScore || 0) >= 65 ? 'bg-yellow-100 text-yellow-700' : 
                    (emp.atsScore || 0) >= 40 ? 'bg-orange-100 text-orange-700' : 'bg-red-100 text-red-700';
                html += `<div class="bg-white p-4 rounded-lg shadow-sm hover:shadow-md transition-shadow">
                    <div class="flex items-start justify-between">
                        <div class="flex-1">
                            <div class="flex items-center gap-2">
                                <h3 class="text-lg font-semibold text-gray-900">${emp.firstName} ${emp.lastName}</h3>
                                ${emp.atsDecision ? '<span class="text-xs px-2 py-0.5 rounded ' + atsDecisionBadge + '">' + emp.atsDecision + '</span>' : ''}
                                ${emp.email ? '<span class="text-sm">üìß</span>' : ''}
                                ${emp.linkedinUrl && isValidLinkedInURL(emp.linkedinUrl) ? '<span class="text-sm">üîó</span>' : ''}
                            </div>
                            <p class="text-gray-600">${emp.position}</p>
                            <div class="flex gap-2 mt-1 text-sm">
                                <span class="text-gray-500">${emp.department}</span>
                                ${emp.company ? '<span class="text-gray-400">‚Ä¢</span><span class="text-gray-500">' + emp.company + '</span>' : ''}
                            </div>
                        </div>
                        <div class="flex gap-1">
                            <div class="text-center px-2"><div class="px-2 py-1 rounded-full text-xs font-semibold ${getScoreBadge(emp.ssiScore || 0)}">${emp.ssiScore || 0}</div><p class="text-xs text-gray-500 mt-1">SSI</p></div>
                            <div class="text-center px-2"><div class="px-2 py-1 rounded-full text-xs font-semibold ${getScoreBadge(emp.linkedinGlobalScore || 0)}">${emp.linkedinGlobalScore || 0}</div><p class="text-xs text-gray-500 mt-1">LinkedIn</p></div>
                            <div class="text-center px-2"><div class="px-2 py-1 rounded-full text-xs font-semibold ${getScoreBadge(emp.globalScore)}">${emp.globalScore}</div><p class="text-xs text-gray-500 mt-1">ADN</p></div>
                            <div class="text-center px-2"><div class="px-2 py-1 rounded-full text-xs font-semibold ${getScoreBadge(emp.deptScore)}">${emp.deptScore}</div><p class="text-xs text-gray-500 mt-1">M√©tier</p></div>
                            <div class="text-center px-2"><div class="px-2 py-1 rounded-full text-xs font-semibold ${getScoreBadge(emp.atsScore || 0)}">${emp.atsScore || 0}</div><p class="text-xs text-gray-500 mt-1">ATS</p></div>
                        </div>
                    </div>
                    <div class="flex gap-2 mt-4">
                        <button onclick="viewEmployee(${emp.id})" class="flex-1 px-3 py-2 bg-blue-50 text-blue-600 rounded hover:bg-blue-100 text-sm font-medium">Voir la fiche</button>
                        ${emp.linkedinUrl && isValidLinkedInURL(emp.linkedinUrl) ? '<a href="' + emp.linkedinUrl + '" target="_blank" class="px-3 py-2 text-blue-600 hover:bg-blue-50 rounded text-sm">üîó</a>' : ''}
                        <button onclick="deleteEmployee(${emp.id})" class="px-3 py-2 text-red-600 hover:bg-red-50 rounded text-sm">üóëÔ∏è</button>
                    </div>
                </div>`;
            });
            html += '</div>';
            
            if (state.employees.length === 0) {
                html += `<div class="text-center py-12 bg-white rounded-lg">
                    <div class="text-6xl mb-4">üìä</div>
                    <h3 class="text-lg font-semibold text-gray-900 mb-2">Aucun profil analys√©</h3>
                    <p class="text-gray-600 mb-4">Commencez par ajouter un profil LinkedIn</p>
                    <div class="text-sm text-gray-500 max-w-md mx-auto bg-blue-50 p-4 rounded-lg">
                        <p class="font-medium mb-2">üí° 2 fa√ßons d'ajouter un profil :</p>
                        <div class="text-left space-y-2">
                            <p><strong>‚ö° Coller le texte</strong> - Copiez tout depuis LinkedIn (recommand√©)</p>
                            <p><strong>‚ûï Saisie manuelle</strong> - Formulaire complet avec tous les champs</p>
                        </div>
                    </div>
                </div>`;
            }
            
            html += '</div>';
            return html;
        }

        function renderEmployeeDetail() {
            const emp = state.selectedEmployee;
            if (!emp) return '';
            const strongAxes = emp.axisScores.filter(axis => axis.score >= 60);
            const weakAxes = emp.axisScores.filter(axis => axis.score < 60);
            
            let html = `<div class="space-y-6">
                <button onclick="state.currentView = 'list'; render();" class="text-blue-600 hover:text-blue-700 font-medium">‚Üê Retour √† la liste</button>
                
                <div class="bg-white p-6 rounded-lg shadow-sm">
                    <div class="flex items-start justify-between mb-4">
                        <div>
                            <h2 class="text-3xl font-bold text-gray-900 mb-2">${emp.firstName} ${emp.lastName}</h2>
                            <p class="text-lg text-gray-600">${emp.position}</p>
                            <p class="text-gray-500">${emp.department} ‚Ä¢ ${emp.company}</p>
                        </div>
                        <button onclick="deleteEmployee(${emp.id})" class="p-2 text-red-600 hover:bg-red-50 rounded" title="Supprimer">üóëÔ∏è</button>
                    </div>
                    ${emp.linkedinUrl ? '<a href="' + emp.linkedinUrl + '" target="_blank" class="inline-flex items-center gap-1 text-blue-600 hover:underline text-sm bg-blue-50 px-3 py-1 rounded-full">üîó Voir le profil LinkedIn</a>' : ''}
                </div>
                
                <div class="bg-white p-6 rounded-lg shadow-sm">
                    <h3 class="text-lg font-semibold mb-4">üèÜ Scores globaux</h3>
                    <div class="grid grid-cols-5 gap-4">
                        <div><p class="text-sm text-gray-600 mb-2">üìä SSI</p><span class="text-3xl font-bold ${getScoreColor(emp.ssiScore || 0)}">${emp.ssiScore || 0}</span><span class="text-gray-500">/100</span></div>
                        <div><p class="text-sm text-gray-600 mb-2">üîµ LinkedIn</p><span class="text-3xl font-bold ${getScoreColor(emp.linkedinGlobalScore || 0)}">${emp.linkedinGlobalScore || 0}</span><span class="text-gray-500">/100</span></div>
                        <div><p class="text-sm text-gray-600 mb-2">üß¨ ADN</p><span class="text-3xl font-bold ${getScoreColor(emp.globalScore)}">${emp.globalScore}</span><span class="text-gray-500">/100</span></div>
                        <div><p class="text-sm text-gray-600 mb-2">üíº M√©tier</p><span class="text-3xl font-bold ${getScoreColor(emp.deptScore)}">${emp.deptScore}</span><span class="text-gray-500">/100</span></div>
                        <div><p class="text-sm text-gray-600 mb-2">üéØ ATS</p><span class="text-3xl font-bold ${getScoreColor(emp.atsScore || 0)}">${emp.atsScore || 0}</span><span class="text-gray-500">/100</span><p class="text-xs mt-1 ${(emp.atsScore || 0) >= 65 ? 'text-green-600' : 'text-orange-600'}">${emp.atsDecision || ''}</p></div>
                    </div>
                </div>`;
            
            // SSI Details
            if (emp.ssiScore !== undefined) {
                const ssiSynthesis = getSSISynthesis(emp);
                const ssiRecos = getSSIRecommendations(emp);
                
                html += `<div class="bg-gradient-to-r from-indigo-50 to-blue-50 p-6 rounded-lg border border-indigo-200">
                    <h3 class="text-lg font-semibold mb-4 text-indigo-900">üìä Social Selling Index (SSI)</h3>
                    
                    <!-- Synth√®se -->
                    <div class="bg-white p-4 rounded-lg mb-4 border-l-4 ${emp.ssiScore >= 55 ? 'border-green-500' : emp.ssiScore >= 35 ? 'border-yellow-500' : 'border-red-500'}">
                        <div class="flex items-center gap-2 mb-2">
                            <span class="font-bold text-lg">${ssiSynthesis.level}</span>
                            <span class="text-2xl font-bold ${getScoreColor(emp.ssiScore)}">${emp.ssiScore}/100</span>
                        </div>
                        <p class="text-gray-700">${ssiSynthesis.description}</p>
                        ${ssiSynthesis.strengths.length > 0 ? '<p class="text-green-700 mt-2"><strong>Points forts :</strong> ' + ssiSynthesis.strengths.map(s => s.icon + ' ' + s.name).join(', ') + '</p>' : ''}
                        ${ssiSynthesis.weaknesses.length > 0 ? '<p class="text-orange-700 mt-1"><strong>√Ä am√©liorer :</strong> ' + ssiSynthesis.weaknesses.map(w => w.icon + ' ' + w.name).join(', ') + '</p>' : ''}
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <div class="bg-white p-4 rounded-lg"><p class="text-xs text-gray-600">Classement Secteur</p><p class="text-2xl font-bold text-indigo-600">Top ${emp.ssiSectorRanking}%</p><p class="text-xs text-gray-500">Moyenne secteur : ${emp.ssiAvgSectorScore}</p></div>
                        <div class="bg-white p-4 rounded-lg"><p class="text-xs text-gray-600">Classement R√©seau</p><p class="text-2xl font-bold text-blue-600">Top ${emp.ssiNetworkRanking}%</p><p class="text-xs text-gray-500">Moyenne r√©seau : ${emp.ssiAvgNetworkScore}</p></div>
                    </div>
                    
                    <div class="bg-white p-4 rounded-lg mb-4">
                        <p class="font-semibold mb-3">Les quatre facteurs SSI</p>
                        <div class="space-y-3">
                            <div><div class="flex justify-between mb-1"><span class="text-sm">üèÜ Marque professionnelle</span><span class="font-bold ${emp.ssiBrandScore >= 18 ? 'text-green-600' : emp.ssiBrandScore >= 12 ? 'text-yellow-600' : 'text-red-600'}">${emp.ssiBrandScore}/25</span></div><div class="w-full bg-gray-200 rounded-full h-2"><div class="h-2 rounded-full bg-orange-500" style="width: ${emp.ssiBrandScore * 4}%"></div></div></div>
                            <div><div class="flex justify-between mb-1"><span class="text-sm">üë• Trouver les bonnes personnes</span><span class="font-bold ${emp.ssiPeopleScore >= 18 ? 'text-green-600' : emp.ssiPeopleScore >= 12 ? 'text-yellow-600' : 'text-red-600'}">${emp.ssiPeopleScore}/25</span></div><div class="w-full bg-gray-200 rounded-full h-2"><div class="h-2 rounded-full bg-blue-500" style="width: ${emp.ssiPeopleScore * 4}%"></div></div></div>
                            <div><div class="flex justify-between mb-1"><span class="text-sm">üí¨ √âchanger des informations</span><span class="font-bold ${emp.ssiEngagementScore >= 18 ? 'text-green-600' : emp.ssiEngagementScore >= 12 ? 'text-yellow-600' : 'text-red-600'}">${emp.ssiEngagementScore}/25</span></div><div class="w-full bg-gray-200 rounded-full h-2"><div class="h-2 rounded-full bg-purple-500" style="width: ${emp.ssiEngagementScore * 4}%"></div></div></div>
                            <div><div class="flex justify-between mb-1"><span class="text-sm">ü§ù √âtablir des relations</span><span class="font-bold ${emp.ssiRelationScore >= 18 ? 'text-green-600' : emp.ssiRelationScore >= 12 ? 'text-yellow-600' : 'text-red-600'}">${emp.ssiRelationScore}/25</span></div><div class="w-full bg-gray-200 rounded-full h-2"><div class="h-2 rounded-full bg-green-500" style="width: ${emp.ssiRelationScore * 4}%"></div></div></div>
                        </div>
                    </div>
                    
                    <!-- Pr√©conisations SSI -->
                    ${ssiRecos.length > 0 ? `
                    <div class="bg-gradient-to-r from-amber-50 to-orange-50 p-4 rounded-lg border border-amber-200">
                        <p class="font-semibold text-amber-900 mb-3">üéØ Plan d'action SSI</p>
                        <div class="space-y-4">
                            ${ssiRecos.map(reco => `
                                <div class="bg-white p-3 rounded-lg">
                                    <div class="flex items-center gap-2 mb-2">
                                        <span class="px-2 py-0.5 rounded text-xs font-medium ${reco.priority === 'haute' ? 'bg-red-100 text-red-700' : 'bg-yellow-100 text-yellow-700'}">${reco.priority === 'haute' ? 'üî¥ Priorit√© haute' : 'üü° Priorit√© moyenne'}</span>
                                        <span class="font-semibold text-gray-800">${reco.category}</span>
                                    </div>
                                    <ul class="text-sm text-gray-700 space-y-1 ml-4">
                                        ${reco.actions.map(a => '<li class="list-disc">' + a + '</li>').join('')}
                                    </ul>
                                </div>
                            `).join('')}
                        </div>
                    </div>` : '<div class="bg-green-50 p-4 rounded-lg border border-green-200"><p class="text-green-800">‚úÖ Excellent ! Tous les facteurs SSI sont bien optimis√©s. Continuez √† maintenir cette dynamique !</p></div>'}
                </div>`;
            }
            
            // ADN Scores
            const adnSynthesis = getADNSynthesis(emp);
            const adnRecos = getADNRecommendations(emp);
            
            html += `<div class="bg-white p-6 rounded-lg shadow-sm">
                <h3 class="text-lg font-semibold mb-4">üß¨ Alignement ADN Cyrus Herez</h3>
                
                <!-- Synth√®se ADN -->
                <div class="bg-gradient-to-r ${emp.globalScore >= 50 ? 'from-green-50 to-emerald-50 border-green-200' : emp.globalScore >= 30 ? 'from-yellow-50 to-amber-50 border-yellow-200' : 'from-red-50 to-orange-50 border-red-200'} p-4 rounded-lg mb-4 border">
                    <div class="flex items-center gap-2 mb-2">
                        <span class="font-bold text-lg">${adnSynthesis.level}</span>
                        <span class="text-2xl font-bold ${getScoreColor(emp.globalScore)}">${emp.globalScore}/100</span>
                    </div>
                    <p class="text-gray-700">${adnSynthesis.description}</p>
                </div>
                
                <!-- D√©tail des axes -->
                <div class="space-y-4 mb-4">`;
            
            emp.axisScores.forEach(axis => {
                const barColor = axis.score >= 70 ? 'bg-green-500' : axis.score >= 40 ? 'bg-yellow-500' : 'bg-red-500';
                const bgColor = axis.score >= 70 ? 'bg-green-50' : axis.score >= 40 ? 'bg-yellow-50' : 'bg-red-50';
                html += `<div class="${bgColor} p-4 rounded-lg">
                    <div class="flex justify-between mb-2"><span class="font-medium">${axis.axisName}</span><span class="font-semibold ${getScoreColor(axis.score)}">${axis.score}/100</span></div>
                    <div class="w-full bg-gray-200 rounded-full h-3 mb-2"><div class="h-3 rounded-full ${barColor}" style="width: ${axis.score}%"></div></div>
                    ${axis.foundKeywords.length > 0 ? '<p class="text-sm text-green-700"><strong>‚úì Pr√©sents :</strong> ' + axis.foundKeywords.slice(0, 8).join(', ') + (axis.foundKeywords.length > 8 ? '...' : '') + '</p>' : '<p class="text-sm text-gray-500 italic">Aucun mot-cl√© d√©tect√©</p>'}
                </div>`;
            });
            
            html += '</div>';
            
            // Pr√©conisations ADN
            if (adnRecos.length > 0) {
                html += `<div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-4 rounded-lg border border-blue-200">
                    <p class="font-semibold text-blue-900 mb-3">üéØ Recommandations pour renforcer l'ADN</p>
                    <div class="space-y-3">
                        ${adnRecos.map(reco => `
                            <div class="bg-white p-3 rounded-lg">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="font-semibold text-gray-800">${reco.category}</span>
                                    <span class="text-sm ${getScoreColor(reco.score)}">${reco.score}/100</span>
                                </div>
                                <p class="text-sm text-gray-600 mb-2">${reco.advice}</p>
                                <div class="flex flex-wrap gap-1">
                                    ${reco.keywords.map(k => '<span class="px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs">+ ' + k + '</span>').join('')}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    <p class="text-sm text-blue-700 mt-3 italic">üí° Conseil : Int√©grez ces mots-cl√©s naturellement dans votre r√©sum√©, vos exp√©riences et votre titre LinkedIn.</p>
                </div>`;
            } else {
                html += `<div class="bg-green-50 p-4 rounded-lg border border-green-200">
                    <p class="text-green-800">‚úÖ Excellent alignement ! Le profil refl√®te parfaitement les valeurs de Cyrus Herez.</p>
                </div>`;
            }
            
            html += '</div>';
            
            // M√©tier
            if (emp.department) {
                const metierSynthesis = getMetierSynthesis(emp);
                const metierRecos = getMetierRecommendations(emp);
                
                html += `<div class="bg-gradient-to-r from-purple-50 to-pink-50 p-6 rounded-lg border border-purple-200">
                    <h3 class="text-lg font-semibold mb-4 text-purple-900">üíº Score M√©tier - ${emp.department}</h3>
                    
                    <!-- Synth√®se M√©tier -->
                    <div class="bg-white p-4 rounded-lg mb-4 border-l-4 ${emp.deptScore >= 60 ? 'border-green-500' : emp.deptScore >= 40 ? 'border-yellow-500' : 'border-red-500'}">
                        <div class="flex items-center gap-2 mb-2">
                            <span class="font-bold text-lg">${metierSynthesis.level}</span>
                            <span class="text-2xl font-bold ${getScoreColor(emp.deptScore)}">${emp.deptScore}/100</span>
                        </div>
                        <p class="text-gray-700">${metierSynthesis.description}</p>
                        <p class="text-sm text-gray-500 mt-2">üìä Couverture : ${metierSynthesis.found} mots-cl√©s sur ${metierSynthesis.total} du r√©f√©rentiel m√©tier</p>
                    </div>
                    
                    <!-- Mots-cl√©s pr√©sents -->
                    ${emp.deptFoundKeywords?.length > 0 ? `
                    <div class="bg-green-50 p-4 rounded-lg mb-4 border border-green-200">
                        <p class="font-semibold text-green-900 mb-2">‚úÖ Mots-cl√©s pr√©sents (${emp.deptFoundKeywords.length})</p>
                        <div class="flex flex-wrap gap-2">
                            ${emp.deptFoundKeywords.map(kw => '<span class="px-3 py-1 bg-green-200 text-green-800 rounded-full text-sm">' + kw + '</span>').join('')}
                        </div>
                    </div>` : ''}
                    
                    <!-- Pr√©conisations M√©tier -->
                    ${metierRecos.length > 0 ? `
                    <div class="bg-gradient-to-r from-amber-50 to-orange-50 p-4 rounded-lg border border-amber-200">
                        <p class="font-semibold text-amber-900 mb-3">üéØ Mots-cl√©s √† int√©grer pour am√©liorer le r√©f√©rencement</p>
                        <div class="space-y-4">
                            ${metierRecos.map(reco => `
                                <div class="bg-white p-3 rounded-lg">
                                    <p class="font-semibold text-gray-800 mb-2">${reco.category}</p>
                                    <div class="flex flex-wrap gap-2 mb-2">
                                        ${reco.keywords.map(k => '<span class="px-3 py-1 bg-orange-100 text-orange-700 rounded-full text-sm border border-orange-300">+ ' + k + '</span>').join('')}
                                    </div>
                                    <p class="text-xs text-gray-600 italic">${reco.tip}</p>
                                </div>
                            `).join('')}
                        </div>
                        
                        <div class="mt-4 p-3 bg-white rounded-lg border border-purple-200">
                            <p class="font-medium text-purple-900 mb-2">üìù Comment int√©grer ces mots-cl√©s ?</p>
                            <ul class="text-sm text-gray-700 space-y-1">
                                <li>‚Ä¢ <strong>Titre LinkedIn :</strong> Ajoutez 2-3 termes cl√©s de votre expertise</li>
                                <li>‚Ä¢ <strong>R√©sum√© :</strong> D√©crivez vos comp√©tences avec le vocabulaire m√©tier</li>
                                <li>‚Ä¢ <strong>Exp√©riences :</strong> Utilisez les termes pour d√©crire vos missions</li>
                                <li>‚Ä¢ <strong>Comp√©tences :</strong> Ajoutez les termes pertinents dans cette section</li>
                            </ul>
                        </div>
                    </div>` : `
                    <div class="bg-green-50 p-4 rounded-lg border border-green-200">
                        <p class="text-green-800">‚úÖ Excellent positionnement ! Le profil utilise efficacement le vocabulaire m√©tier du r√©f√©rentiel "${emp.department}".</p>
                    </div>`}
                </div>`;
            }
            
            // Section ATS d√©taill√©e
            if (emp.atsScore !== undefined) {
                const atsSynthesis = getATSSynthesis(emp);
                const atsRecos = getATSRecommendations(emp);
                
                html += `<div class="bg-gradient-to-r from-emerald-50 to-teal-50 p-6 rounded-lg border border-emerald-200">
                    <h3 class="text-lg font-semibold mb-4 text-emerald-900">üéØ Score ATS (Applicant Tracking System)</h3>
                    
                    <!-- Synth√®se ATS -->
                    <div class="bg-white p-4 rounded-lg mb-4 border-l-4 ${(emp.atsScore || 0) >= 65 ? 'border-green-500' : (emp.atsScore || 0) >= 40 ? 'border-yellow-500' : 'border-red-500'}">
                        <div class="flex items-center gap-3 mb-2">
                            <span class="text-2xl font-bold ${getScoreColor(emp.atsScore || 0)}">${emp.atsScore || 0}/100</span>
                            <span class="px-3 py-1 rounded-full text-sm font-semibold ${(emp.atsScore || 0) >= 80 ? 'bg-green-100 text-green-700' : (emp.atsScore || 0) >= 65 ? 'bg-yellow-100 text-yellow-700' : (emp.atsScore || 0) >= 40 ? 'bg-orange-100 text-orange-700' : 'bg-red-100 text-red-700'}">${emp.atsDecision || ''}</span>
                            <span class="text-gray-600 font-medium">${atsSynthesis.verdict}</span>
                        </div>
                        <p class="text-gray-700">${atsSynthesis.description}</p>
                        ${atsSynthesis.strengths.length > 0 ? '<p class="text-green-700 mt-2"><strong>‚úÖ Points forts :</strong> ' + atsSynthesis.strengths.join(' ‚Ä¢ ') + '</p>' : ''}
                        ${atsSynthesis.weaknesses.length > 0 ? '<p class="text-orange-700 mt-1"><strong>‚ö†Ô∏è √Ä am√©liorer :</strong> ' + atsSynthesis.weaknesses.join(' ‚Ä¢ ') + '</p>' : ''}
                    </div>
                    
                    <!-- Piliers ATS -->
                    <div class="bg-white p-4 rounded-lg mb-4">
                        <p class="font-semibold mb-3">Analyse des 6 piliers ATS</p>
                        <div class="space-y-3">
                            <div>
                                <div class="flex justify-between mb-1"><span class="text-sm">üè∑Ô∏è TitleFit (Titre de poste)</span><span class="font-bold ${(emp.atsTitleFit || 0) >= 15 ? 'text-green-600' : (emp.atsTitleFit || 0) >= 10 ? 'text-yellow-600' : 'text-red-600'}">${emp.atsTitleFit || 0}/20</span></div>
                                <div class="w-full bg-gray-200 rounded-full h-2"><div class="h-2 rounded-full bg-blue-500" style="width: ${((emp.atsTitleFit || 0) / 20) * 100}%"></div></div>
                            </div>
                            <div>
                                <div class="flex justify-between mb-1"><span class="text-sm">üìä ImpactKPI (R√©sultats chiffr√©s)</span><span class="font-bold ${(emp.atsImpactKPI || 0) >= 18 ? 'text-green-600' : (emp.atsImpactKPI || 0) >= 10 ? 'text-yellow-600' : 'text-red-600'}">${emp.atsImpactKPI || 0}/25</span></div>
                                <div class="w-full bg-gray-200 rounded-full h-2"><div class="h-2 rounded-full bg-purple-500" style="width: ${((emp.atsImpactKPI || 0) / 25) * 100}%"></div></div>
                                ${(emp.atsKPICount || 0) > 0 ? '<p class="text-xs text-gray-500 mt-1">' + (emp.atsKPICount || 0) + ' KPIs d√©tect√©s' + ((emp.atsKPIMatches || []).length > 0 ? ' : ' + (emp.atsKPIMatches || []).slice(0, 5).join(', ') : '') + '</p>' : '<p class="text-xs text-red-500 mt-1">Aucun KPI d√©tect√© - ajoutez des chiffres !</p>'}
                            </div>
                            <div>
                                <div class="flex justify-between mb-1"><span class="text-sm">üõ†Ô∏è ToolsFit (Outils ma√Ætris√©s)</span><span class="font-bold ${(emp.atsToolsFit || 0) >= 10 ? 'text-green-600' : (emp.atsToolsFit || 0) >= 5 ? 'text-yellow-600' : 'text-red-600'}">${emp.atsToolsFit || 0}/15</span></div>
                                <div class="w-full bg-gray-200 rounded-full h-2"><div class="h-2 rounded-full bg-teal-500" style="width: ${((emp.atsToolsFit || 0) / 15) * 100}%"></div></div>
                                ${(emp.atsFoundTools || []).length > 0 ? '<p class="text-xs text-green-600 mt-1">‚úì ' + (emp.atsFoundTools || []).join(', ') + '</p>' : ''}
                            </div>
                            <div>
                                <div class="flex justify-between mb-1"><span class="text-sm">üìÖ SeniorityFit (Exp√©rience)</span><span class="font-bold ${(emp.atsSeniorityFit || 0) >= 12 ? 'text-green-600' : (emp.atsSeniorityFit || 0) >= 8 ? 'text-yellow-600' : 'text-red-600'}">${emp.atsSeniorityFit || 0}/15</span></div>
                                <div class="w-full bg-gray-200 rounded-full h-2"><div class="h-2 rounded-full bg-amber-500" style="width: ${((emp.atsSeniorityFit || 0) / 15) * 100}%"></div></div>
                                <p class="text-xs text-gray-500 mt-1">${(emp.atsTotalYears || 0) > 0 ? '~' + (emp.atsTotalYears || 0) + ' ans d√©tect√©s' : 'Ann√©es non d√©tect√©es'}${emp.atsHasProgression ? ' ‚Ä¢ Progression de carri√®re visible' : ''}</p>
                            </div>
                            <div>
                                <div class="flex justify-between mb-1"><span class="text-sm">üèÖ Credibility (Cr√©dibilit√©)</span><span class="font-bold ${(emp.atsCredibility || 0) >= 10 ? 'text-green-600' : (emp.atsCredibility || 0) >= 6 ? 'text-yellow-600' : 'text-red-600'}">${emp.atsCredibility || 0}/15</span></div>
                                <div class="w-full bg-gray-200 rounded-full h-2"><div class="h-2 rounded-full bg-indigo-500" style="width: ${((emp.atsCredibility || 0) / 15) * 100}%"></div></div>
                                <p class="text-xs text-gray-500 mt-1">${(emp.atsRecoCount || 0)} recommandations ‚Ä¢ ${(emp.atsCertCount || 0)} certifications d√©tect√©es</p>
                            </div>
                            <div>
                                <div class="flex justify-between mb-1"><span class="text-sm">üìç ContextFit (Contexte)</span><span class="font-bold ${(emp.atsContextFit || 0) >= 8 ? 'text-green-600' : (emp.atsContextFit || 0) >= 5 ? 'text-yellow-600' : 'text-red-600'}">${emp.atsContextFit || 0}/10</span></div>
                                <div class="w-full bg-gray-200 rounded-full h-2"><div class="h-2 rounded-full bg-gray-500" style="width: ${((emp.atsContextFit || 0) / 10) * 100}%"></div></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Pr√©conisations ATS -->
                    ${atsRecos.length > 0 ? `
                    <div class="bg-gradient-to-r from-amber-50 to-orange-50 p-4 rounded-lg border border-amber-200">
                        <p class="font-semibold text-amber-900 mb-3">üéØ Plan d'action pour am√©liorer le score ATS</p>
                        <div class="space-y-4">
                            ${atsRecos.map(reco => `
                                <div class="bg-white p-4 rounded-lg">
                                    <div class="flex items-center justify-between mb-2">
                                        <div class="flex items-center gap-2">
                                            <span class="px-2 py-0.5 rounded text-xs font-medium ${reco.priority === 'haute' ? 'bg-red-100 text-red-700' : reco.priority === 'moyenne' ? 'bg-yellow-100 text-yellow-700' : 'bg-gray-100 text-gray-700'}">${reco.priority === 'haute' ? 'üî¥ Priorit√© haute' : reco.priority === 'moyenne' ? 'üü° Priorit√© moyenne' : '‚ö™ Optionnel'}</span>
                                            <span class="font-semibold text-gray-800">${reco.category}</span>
                                        </div>
                                        <span class="text-sm ${getScoreColor(Math.round((reco.score / reco.maxScore) * 100))}">${reco.score}/${reco.maxScore}</span>
                                    </div>
                                    <ul class="text-sm text-gray-700 space-y-1 ml-4 mb-2">
                                        ${reco.actions.map(a => '<li class="list-disc">' + a + '</li>').join('')}
                                    </ul>
                                    ${reco.examples ? '<div class="bg-gray-50 p-2 rounded text-xs"><p class="text-gray-600 mb-1">Exemple :</p>' + reco.examples.map(e => '<p class="' + (e.startsWith('‚ùå') ? 'text-red-600' : 'text-green-600') + '">' + e + '</p>').join('') + '</div>' : ''}
                                    ${reco.suggestedTools ? '<div class="mt-2"><p class="text-xs text-gray-600 mb-1">Outils √† mentionner :</p><p class="text-xs text-teal-700">' + reco.suggestedTools.join(' | ') + '</p></div>' : ''}
                                </div>
                            `).join('')}
                        </div>
                    </div>` : `
                    <div class="bg-green-50 p-4 rounded-lg border border-green-200">
                        <p class="text-green-800">‚úÖ Excellent score ATS ! Le profil est optimis√© pour passer les filtres des syst√®mes de recrutement.</p>
                    </div>`}
                </div>`;
            }
            
            // Synth√®se globale
            const avgScore = Math.round(((emp.ssiScore || 0) + (emp.linkedinGlobalScore || 0) + emp.globalScore + emp.deptScore + (emp.atsScore || 0)) / 5);
            let globalLevel, globalAdvice;
            if (avgScore >= 65) {
                globalLevel = "üèÜ Profil exemplaire";
                globalAdvice = `${emp.firstName} dispose d'un profil LinkedIn optimis√© et align√© avec Cyrus Herez. C'est un excellent ambassadeur de la marque. Maintenez cette dynamique avec une activit√© r√©guli√®re.`;
            } else if (avgScore >= 45) {
                globalLevel = "‚úÖ Bon profil";
                globalAdvice = `${emp.firstName} a un bon profil avec des axes d'am√©lioration identifi√©s. En appliquant les recommandations ci-dessus, le profil peut rapidement atteindre l'excellence.`;
            } else if (avgScore >= 30) {
                globalLevel = "‚ö†Ô∏è Profil √† d√©velopper";
                globalAdvice = `Le profil de ${emp.firstName} n√©cessite un travail d'optimisation. Nous recommandons une session de coaching LinkedIn personnalis√©e pour traiter les points prioritaires.`;
            } else {
                globalLevel = "üî¥ Profil √† construire";
                globalAdvice = `Le profil de ${emp.firstName} est √† reconstruire. Une formation compl√®te aux bonnes pratiques LinkedIn est recommand√©e, suivie d'un accompagnement personnalis√©.`;
            }
            
            html += `<div class="bg-gradient-to-r from-blue-600 to-indigo-600 p-6 rounded-lg text-white">
                <h3 class="text-xl font-bold mb-3">üìä Synth√®se globale</h3>
                <div class="flex items-center gap-4 mb-4">
                    <div class="bg-white/20 rounded-lg p-4 text-center">
                        <p class="text-4xl font-bold">${avgScore}</p>
                        <p class="text-sm opacity-90">Score moyen</p>
                    </div>
                    <div class="flex-1">
                        <p class="text-lg font-semibold mb-1">${globalLevel}</p>
                        <p class="opacity-90">${globalAdvice}</p>
                    </div>
                </div>
                <div class="grid grid-cols-5 gap-2 text-center text-sm">
                    <div class="bg-white/10 rounded p-2"><p class="font-bold">${emp.ssiScore || 0}</p><p class="opacity-75">SSI</p></div>
                    <div class="bg-white/10 rounded p-2"><p class="font-bold">${emp.linkedinGlobalScore || 0}</p><p class="opacity-75">LinkedIn</p></div>
                    <div class="bg-white/10 rounded p-2"><p class="font-bold">${emp.globalScore}</p><p class="opacity-75">ADN</p></div>
                    <div class="bg-white/10 rounded p-2"><p class="font-bold">${emp.deptScore}</p><p class="opacity-75">M√©tier</p></div>
                    <div class="bg-white/10 rounded p-2"><p class="font-bold">${emp.atsScore || 0}</p><p class="opacity-75">ATS</p></div>
                </div>
                <p class="text-sm opacity-75 mt-4">üìù ${emp.wordCount} mots analys√©s ‚Ä¢ Derni√®re analyse : ${new Date(emp.analyzedAt).toLocaleDateString('fr-FR')}</p>
            </div></div>`;
            
            return html;
        }

        function getDepartmentGroups() {
            return [
                { label: "üè¢ Direction", depts: ["Direction G√©n√©rale", "Direction des Op√©rations", "Direction Financi√®re", "Direction du D√©veloppement", "Secr√©tariat G√©n√©ral"] },
                { label: "üë• RH & Talents", depts: ["Direction des Ressources Humaines", "Recrutement & Talent Acquisition", "Formation & D√©veloppement des Comp√©tences", "Administration RH & Paie", "Relations Sociales & QVT", "Gestion des Carri√®res & Mobilit√©"] },
                { label: "üõ†Ô∏è Support", depts: ["Support Administratif & Services G√©n√©raux", "Support IT & Helpdesk", "Support Juridique & Contractuel", "Assistanat de Direction"] },
                { label: "üíº Commercial", depts: ["Direction Commerciale", "D√©veloppement Commercial & Business Development", "Conseillers Commerciaux & Banquiers Priv√©s", "Grands Comptes & Key Account Management", "Administration des Ventes & ADV", "Inside Sales & T√©l√©prospection"] },
                { label: "ü§ù Service Client", depts: ["Service Client & Relation Clients", "Middle-Office & Support Commercial", "Exp√©rience Client & Customer Success"] },
                { label: "üè¶ Patrimoine", depts: ["Conseil Patrimonial", "Gestion Financi√®re", "Immobilier & Alternatifs"] },
                { label: "üì£ Marketing", depts: ["Marketing & Communication", "Marketing Digital & Growth"] },
                { label: "‚öñÔ∏è Conformit√©", depts: ["Conformit√© & Contr√¥le Interne", "Juridique & Fiscalit√©"] },
                { label: "üìä Finance", depts: ["Comptabilit√©", "Contr√¥le de Gestion"] },
                { label: "üíª IT", depts: ["IT, Syst√®mes d'Information & Data", "D√©veloppement & Projets IT"] },
                { label: "‚öôÔ∏è Op√©rations", depts: ["Back-Office & Op√©rations"] }
            ];
        }

        function renderAddForm() {
            const groups = getDepartmentGroups();
            let deptOptions = '<option value="">S√©lectionner...</option>';
            groups.forEach(g => {
                deptOptions += `<optgroup label="${g.label}">`;
                g.depts.forEach(d => deptOptions += `<option value="${d}">${d}</option>`);
                deptOptions += '</optgroup>';
            });
            
            return `<div class="bg-white p-6 rounded-lg shadow-sm max-w-3xl mx-auto">
                <h2 class="text-xl font-bold mb-4">‚ûï Ajouter un collaborateur</h2>
                <form onsubmit="handleAddEmployee(event); return false;" class="space-y-4">
                    <div class="grid grid-cols-2 gap-4">
                        <div><label class="block text-sm font-medium text-gray-700 mb-1">Pr√©nom *</label><input type="text" id="firstName" required class="w-full px-3 py-2 border rounded-lg" /></div>
                        <div><label class="block text-sm font-medium text-gray-700 mb-1">Nom *</label><input type="text" id="lastName" required class="w-full px-3 py-2 border rounded-lg" /></div>
                    </div>
                    <div><label class="block text-sm font-medium text-gray-700 mb-1">Poste</label><input type="text" id="position" class="w-full px-3 py-2 border rounded-lg" /></div>
                    <div class="grid grid-cols-2 gap-4">
                        <div><label class="block text-sm font-medium text-gray-700 mb-1">Service</label><select id="department" class="w-full px-3 py-2 border rounded-lg">${deptOptions}</select></div>
                        <div><label class="block text-sm font-medium text-gray-700 mb-1">Entreprise</label><input type="text" id="company" value="${state.targetCompany}" class="w-full px-3 py-2 border rounded-lg" /></div>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div><label class="block text-sm font-medium text-gray-700 mb-1">üìß Email</label><input type="email" id="email" class="w-full px-3 py-2 border rounded-lg" /></div>
                        <div><label class="block text-sm font-medium text-gray-700 mb-1">üîó URL LinkedIn</label><input type="url" id="linkedinUrl" class="w-full px-3 py-2 border rounded-lg" /></div>
                    </div>
                    <div><label class="block text-sm font-medium text-gray-700 mb-1">Profil LinkedIn (texte) *</label><textarea id="profileText" required class="w-full px-3 py-2 border rounded-lg h-48" placeholder="Collez le contenu du profil..."></textarea></div>
                    <div class="flex gap-2">
                        <button type="submit" class="flex-1 bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 font-medium">‚úÖ Ajouter</button>
                        <button type="button" onclick="state.currentView = 'list'; render();" class="flex-1 bg-gray-200 text-gray-700 py-3 rounded-lg hover:bg-gray-300 font-medium">‚ùå Annuler</button>
                    </div>
                </form>
            </div>`;
        }

        function render() {
            const app = document.getElementById('app');
            let content = '';
            if (state.currentView === 'list') content = renderEmployeeList();
            else if (state.currentView === 'detail') content = renderEmployeeDetail();
            else if (state.currentView === 'add') content = renderAddForm();
            app.innerHTML = renderHeader() + '<main class="max-w-7xl mx-auto px-4 py-6">' + content + '</main>';
        }

        loadState();
        render();
    </script>
</body>
</html>

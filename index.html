<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analyseur LinkedIn - ADN de Marque</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50">
    <div id="app"></div>

    <script>
        // State management
        let state = {
            employees: [],
            brandDNA: [
                { id:1, name:"Excellence patrimoniale & Expertise", weight:30, keywords:["patrimoine","patrimonial","patrimoniale","gestion","conseil","stratÃ©gie","stratÃ©gique","ingÃ©nierie","allocation","optimisation","expertise","expert","performance","financier","immobilier","investissement","transmission","excellence","accompagnement"] },
                { id:2, name:"IndÃ©pendance & IntÃ©gritÃ©", weight:25, keywords:["indÃ©pendance","indÃ©pendant","intÃ©gritÃ©","transparence","transparent","confiance","Ã©thique","responsable","capitalistique","partenaire","fiable","authentique"] },
                { id:3, name:"Approche sur-mesure & Client", weight:25, keywords:["sur-mesure","personnalisÃ©","personnalisation","client","dirigeant","entrepreneur","famille","accompagnement","Ã©coute","solution","adaptÃ©","individuel","relation","proximitÃ©","orientation"] },
                { id:4, name:"Vision long-terme & DurabilitÃ©", weight:20, keywords:["long-terme","pÃ©renne","durable","durabilitÃ©","transmission","transmissible","impact","avenir","cohÃ©rent","vision","objectif","croissance","transformation","Ã©volution"] }
            ],
            departments: [
                // ðŸ¢ DIRECTION (5)
                { id: 1, name: "Direction GÃ©nÃ©rale", keywords: ["direction gÃ©nÃ©rale","dg","ceo","prÃ©sident","directeur gÃ©nÃ©ral","pdg","prÃ©sident directeur gÃ©nÃ©ral","chief executive officer","stratÃ©gie globale","vision","gouvernance","comex","comitÃ© exÃ©cutif","codir","comitÃ© direction","leadership","pilotage stratÃ©gique","croissance","transformation","dÃ©veloppement","fondateur","co-fondateur","founder","managing director","gÃ©rant","associÃ© gÃ©rant","board","conseil","administrateur","executive","c-level","top management","dÃ©cision stratÃ©gique","orientation","cap","mission","valeurs"] },
                { id: 2, name: "Direction des OpÃ©rations", keywords: ["direction opÃ©rations","coo","chief operating officer","directeur opÃ©rations","opÃ©rations","process","processus","efficacitÃ©","organisation","optimisation","coordination","pilotage opÃ©rationnel","amÃ©lioration continue","lean","lean management","six sigma","qualitÃ©","productivitÃ©","excellence opÃ©rationnelle","supply chain","chaÃ®ne logistique","flux","industrialisation","standardisation","procÃ©dures","modes opÃ©ratoires","kpi opÃ©rationnels","performance opÃ©rationnelle","delivery","exÃ©cution","run","change management","conduite changement"] },
                { id: 3, name: "Direction FinanciÃ¨re", keywords: ["direction financiÃ¨re","daf","cfo","chief financial officer","directeur financier","directeur administratif financier","finance","trÃ©sorerie","trÃ©sorier","budget","comptabilitÃ©","reporting financier","consolidation","audit","contrÃ´le","cash flow","flux trÃ©sorerie","investissement","rentabilitÃ©","bfr","besoin fonds roulement","p&l","compte rÃ©sultat","bilan","prÃ©visions","forecast","closing","clÃ´ture","normes ifrs","gaap","levÃ©e fonds","financement","dette","equity","valorisation","m&a finance","due diligence financiÃ¨re"] },
                { id: 4, name: "Direction du DÃ©veloppement", keywords: ["direction dÃ©veloppement","directeur dÃ©veloppement","chief development officer","croissance","expansion","nouveaux marchÃ©s","partenariats stratÃ©giques","m&a","mergers acquisitions","fusions acquisitions","acquisitions","diversification","innovation","business development","stratÃ©gie de croissance","scale","scaling","internationalisation","franchise","licensing","joint venture","alliance stratÃ©gique","dÃ©veloppement externe","croissance externe","croissance organique","nouvelles activitÃ©s","incubation","venture","corporate venture"] },
                { id: 5, name: "SecrÃ©tariat GÃ©nÃ©ral", keywords: ["secrÃ©tariat gÃ©nÃ©ral","secrÃ©taire gÃ©nÃ©ral","secrÃ©taire gÃ©nÃ©rale","directeur gÃ©nÃ©ral adjoint","dga","gouvernance","conseil administration","ca","board","assemblÃ©e gÃ©nÃ©rale","ag","compliance corporate","affaires juridiques","institutionnel","relations actionnaires","shareholders","corporate secretary","greffe","statuts","pv","procÃ¨s verbal","dÃ©libÃ©rations","mandats","pouvoirs","dÃ©lÃ©gations","organes sociaux","vie sociale","droit sociÃ©tÃ©s"] },
                
                // ðŸ‘¥ RH & TALENTS (6)
                { id: 6, name: "Direction des Ressources Humaines", keywords: ["drh","direction rh","directeur ressources humaines","directrice rh","chief human resources officer","chro","chief people officer","cpo","ressources humaines","stratÃ©gie rh","politique rh","capital humain","transformation rh","culture d'entreprise","culture entreprise","engagement","marque employeur","employer branding","organisation","people","talent","workforce","effectifs","masse salariale","sirh","hris","politique sociale","climat social","baromÃ¨tre social","enquÃªte engagement"] },
                { id: 7, name: "Recrutement & Talent Acquisition", keywords: ["recrutement","recruteur","recruteuse","talent acquisition","ta","sourcing","chasse","chasseur tÃªtes","headhunter","entretiens","entretien embauche","onboarding","intÃ©gration","candidats","candidatures","offres d'emploi","annonces","cvthÃ¨que","linkedin recruiter","cooptation","assessment","assessment center","Ã©valuation","tests","ats","applicant tracking","jobboard","indeed","welcome to the jungle","campus","relations Ã©coles","stage","stagiaire","alternance","alternant","apprenti","cdi","cdd","interim"] },
                { id: 8, name: "Formation & DÃ©veloppement des CompÃ©tences", keywords: ["formation","formateur","formatrice","dÃ©veloppement compÃ©tences","learning","learning development","l&d","e-learning","digital learning","mooc","parcours formation","plan de dÃ©veloppement","plan formation","coaching","coach","mentoring","mentor","upskilling","reskilling","certification","acadÃ©mie","universitÃ© entreprise","corporate university","ingÃ©nierie pÃ©dagogique","conception formation","animation formation","Ã©valuation formation","compÃ©tences","rÃ©fÃ©rentiel compÃ©tences","gpec","gepp","bilan compÃ©tences","vae","cpf","opco"] },
                { id: 9, name: "Administration RH & Paie", keywords: ["administration rh","gestionnaire rh","gestionnaire paie","paie","payroll","gestion administrative","gestion personnel","contrats travail","contrat","bulletins paie","bulletins salaire","dÃ©clarations sociales","dsn","urssaf","congÃ©s","absences","planning","sirh","workday","adp","sage paie","temps de travail","gestion temps","pointage","mutuelle","prÃ©voyance","avantages sociaux","benefits","Ã©pargne salariale","intÃ©ressement","participation","tickets restaurant","solde tout compte","attestations","affiliations","mÃ©decine travail"] },
                { id: 10, name: "Relations Sociales & QVT", keywords: ["relations sociales","responsable relations sociales","cse","comitÃ© social Ã©conomique","irp","dÃ©lÃ©guÃ©s personnel","dialogue social","nÃ©gociation","nÃ©gociations annuelles","nao","accords","accord entreprise","convention collective","qvt","qvct","qualitÃ© vie travail","bien-Ãªtre","wellness","prÃ©vention","santÃ© travail","sÃ©curitÃ©","rps","risques psychosociaux","burn out","handicap","rqth","diversitÃ©","inclusion","Ã©galitÃ©","paritÃ©","index Ã©galitÃ©","rse sociale","duerp","pÃ©nibilitÃ©","tÃ©lÃ©travail","flex office"] },
                { id: 11, name: "Gestion des CarriÃ¨res & MobilitÃ©", keywords: ["gestion carriÃ¨res","career management","mobilitÃ©","mobilitÃ© interne","mobilitÃ© internationale","expatriation","impatriation","Ã©volution professionnelle","entretiens annuels","entretien professionnel","people review","revue personnel","talent management","gestion talents","hauts potentiels","high potential","hipos","succession","plan succession","parcours","filiÃ¨res mÃ©tiers","passerelles","promotion","Ã©volution","fidÃ©lisation","rÃ©tention","turnover","attrition","offboarding","dÃ©part","transition"] },
                
                // ðŸ› ï¸ SUPPORT & SERVICES (4)
                { id: 12, name: "Support Administratif & Services GÃ©nÃ©raux", keywords: ["services gÃ©nÃ©raux","responsable services gÃ©nÃ©raux","office manager","facilities manager","administratif","assistant administratif","assistante administrative","accueil","hÃ´tesse","standardiste","courrier","affranchissement","archivage","ged","gestion documentaire","fournitures","achats indirects","locaux","bÃ¢timent","immobilier entreprise","maintenance","entretien","facilities","facility management","prestataires","sous-traitance","logistique","moyens gÃ©nÃ©raux","parc auto","flotte","voyages","travel","dÃ©mÃ©nagement","amÃ©nagement","sÃ©curitÃ© locaux","badges","contrÃ´le accÃ¨s"] },
                { id: 13, name: "Support IT & Helpdesk", keywords: ["support it","support informatique","helpdesk","service desk","assistance technique","technicien support","technicien informatique","ticketing","jira","servicenow","incidents","gestion incidents","dÃ©pannage","troubleshooting","poste de travail","desktop","logiciels","software","matÃ©riel","hardware","pc","laptop","imprimante","rÃ©seau","network","wifi","vpn","active directory","office 365","microsoft 365","google workspace","support utilisateur","support utilisateurs","niveau 1","n1","niveau 2","n2","niveau 3","n3","escalade","sla","temps rÃ©solution","hotline","tÃ©lÃ©phone","remote","prise main distance"] },
                { id: 14, name: "Support Juridique & Contractuel", keywords: ["support juridique","juriste","juriste junior","paralegal","assistant juridique","assistante juridique","contrats","gestion contrats","contract management","rÃ©vision contrats","rÃ©daction contrats","nÃ©gociation contractuelle","clauses","conditions gÃ©nÃ©rales","cgv","cgu","conformitÃ©","compliance","litiges","contentieux","prÃ©-contentieux","recouvrement","mise demeure","veille juridique","veille rÃ©glementaire","rgpd","dpo","data protection","propriÃ©tÃ© intellectuelle","pi","marques","brevets","droit des affaires","droit commercial","droit travail","baux","assurances"] },
                { id: 15, name: "Assistanat de Direction", keywords: ["assistante direction","assistant direction","assistante executive","executive assistant","ea","office assistant","secrÃ©taire","secrÃ©taire direction","secrÃ©tariat","agenda","gestion agenda","planning","rÃ©unions","organisation rÃ©unions","dÃ©placements","voyages","rÃ©servations","notes","prise notes","comptes-rendus","cr","minutes","coordination","filtrage","appels","mails","prÃ©paration","dossiers","presentations","support exÃ©cutif","bras droit","polyvalent","polyvalence","confidentialitÃ©","discrÃ©tion"] },
                
                // ðŸ’¼ COMMERCIAL & DÃ‰VELOPPEMENT (6)
                { id: 16, name: "Direction Commerciale", keywords: ["direction commerciale","directeur commercial","directrice commerciale","chief sales officer","cso","chief revenue officer","cro","vp sales","head of sales","stratÃ©gie commerciale","politique commerciale","objectifs commerciaux","quotas","budget commercial","pilotage ventes","animation Ã©quipe","management commercial","forecast","prÃ©visions ventes","pipeline","funnel","entonnoir","performance commerciale","kpi ventes","chiffre affaires","ca","revenue","marge commerciale","incentive","commissionnement","variable","bonus","challenge commercial","sales ops","sales operations"] },
                { id: 17, name: "DÃ©veloppement Commercial & Business Development", keywords: ["dÃ©veloppement commercial","business development","bizdev","bd","business developer","ingÃ©nieur commercial","ingÃ©nieur affaires","commercial terrain","prospection","chasse","hunter","nouveaux clients","acquisition clients","conquÃªte","new business","leads","gÃ©nÃ©ration leads","lead gen","opportunitÃ©s","qualification","rdv","rendez-vous","closing","signature","nÃ©gociation","proposition commerciale","offre commerciale","devis","appel offres","ao","rÃ©ponse appel offres","soutenance","pitch","dÃ©monstration","demo","poc","proof of concept","partenariats commerciaux"] },
                { id: 18, name: "Conseillers Commerciaux & Banquiers PrivÃ©s", keywords: ["conseiller commercial","conseillÃ¨re commerciale","conseiller clientÃ¨le","chargÃ© clientÃ¨le","chargÃ© affaires","banquier privÃ©","banquiÃ¨re privÃ©e","private banker","gestionnaire fortune","wealth manager","conseiller gestion patrimoine","cgp","cgpi","dÃ©veloppement portefeuille","portefeuille clients","book","encours","aum","assets under management","rdv clients","rendez-vous clients","dÃ©couverte client","proposition de valeur","offre","prÃ©sentation","argumentaire","prospection patrimoniale","prescription","apporteurs affaires","souscription","signature","acte","closing client","conseil personnalisÃ©","sur-mesure"] },
                { id: 19, name: "Grands Comptes & Key Account Management", keywords: ["grands comptes","key account","key account manager","kam","global account","strategic account","enterprise","comptes stratÃ©giques","comptes clÃ©s","national account","fidÃ©lisation","rÃ©tention client","dÃ©veloppement compte","account development","upselling","up-sell","cross selling","cross-sell","vente additionnelle","relation privilÃ©giÃ©e","partenariat","partenaire stratÃ©gique","contrats cadre","accords cadre","nÃ©gociation annuelle","business review","qbr","quarterly business review","plan compte","account plan","governance","comitÃ© pilotage","executive sponsor"] },
                { id: 20, name: "Administration des Ventes & ADV", keywords: ["adv","administration ventes","administration commerciale","assistant commercial","assistante commerciale","gestionnaire adv","back office commercial","commandes","gestion commandes","saisie commandes","facturation","factures","facturation client","suivi commandes","suivi livraisons","litiges commerciaux","litiges clients","rÃ©clamations","sav","service aprÃ¨s-vente","erp","sap","oracle","crm","salesforce","devis","Ã©tablissement devis","contrats commerciaux","relances","relances clients","recouvrement","impayÃ©s","encaissements","crÃ©dit client","conditions paiement","incoterms","export","import"] },
                { id: 21, name: "Inside Sales & TÃ©lÃ©prospection", keywords: ["inside sales","inside sales representative","isr","sdr","sales development representative","bdr","business development representative","tÃ©lÃ©prospection","tÃ©lÃ©prospecteur","tÃ©lÃ©vente","tÃ©lÃ©vendeur","phoning","appels sortants","outbound","cold calling","qualification","qualification leads","prise de rdv","prise rendez-vous","leads","mql","sql","script","argumentaire tÃ©lÃ©phonique","objections","rebonds","conversion","taux conversion","volume","cadence","sÃ©quences","outreach","crm","hubspot","salesloft","outreach.io","linkedin sales navigator"] },
                
                // ðŸ¤ RELATION CLIENT (3)
                { id: 22, name: "Service Client & Relation Clients", keywords: ["service client","service clients","relation client","relation clients","customer service","customer care","support client","customer support","chargÃ© relation client","conseiller client","satisfaction client","satisfaction","csat","fidÃ©litÃ©","fidÃ©litÃ© client","fidÃ©lisation","loyalty","rÃ©clamation","rÃ©clamations","plaintes","Ã©coute client","voix client","voc","suivi client","suivi dossier","qualitÃ© de service","qualitÃ© service","sla","temps de rÃ©ponse","first contact resolution","fcr","accueil client","accueil tÃ©lÃ©phonique","hotline","call center","centre appels","centre contact","multicanal","omnicanal","chat","chatbot","ticketing zendesk","freshdesk","intercom"] },
                { id: 23, name: "Middle-Office & Support Commercial", keywords: ["middle office","middle-office","support commercial","support aux ventes","sales support","traitement dossiers","gestion dossiers","entrÃ©e en relation","eer","ouverture compte","kyc","know your customer","due diligence client","onboarding client","onboarding","suivi administratif","contrÃ´le conformitÃ©","vÃ©rification","validation","approbation","workflow","processus","back office commercial","coordination","interface","liaision","commercial sÃ©dentaire","gestionnaire commercial","chargÃ© clientÃ¨le back office"] },
                { id: 24, name: "ExpÃ©rience Client & Customer Success", keywords: ["expÃ©rience client","cx","customer experience","customer success","customer success manager","csm","success manager","accompagnement client","accompagnement","adoption","adoption produit","satisfaction","nps","net promoter score","csat","ces","customer effort score","churn","attrition","rÃ©tention","retention","renouvellement","renewal","expansion","upsell","parcours client","customer journey","touchpoints","points contact","feedback","avis clients","reviews","amÃ©lioration continue","voice of customer","voc","customer centric","centrÃ©e client","health score","playbook","qbr"] },
                
                // ðŸ’° MÃ‰TIERS PATRIMONIAUX (3)
                { id: 25, name: "Conseil Patrimonial", keywords: ["conseil patrimonial","conseiller patrimonial","conseillÃ¨re patrimoniale","consultant patrimoine","ingÃ©nieur patrimonial","patrimoine","patrimonial","gestion patrimoine","gestion de patrimoine","wealth management","stratÃ©gie patrimoniale","planification patrimoniale","accompagnement patrimonial","client privÃ©","clientÃ¨le privÃ©e","hnwi","high net worth","uhnwi","optimisation","optimisation patrimoniale","transmission","transmission patrimoine","succession","donation","dÃ©membrement","assurance vie","contrat capitalisation","pea","compte titres","Ã©pargne","placements","allocation actifs","diversification","audit patrimonial","bilan patrimonial","diagnostic","prÃ©conisations","horizon","objectifs patrimoniaux"] },
                { id: 26, name: "Gestion FinanciÃ¨re", keywords: ["gestion financiÃ¨re","gestion actifs","asset management","gestion portefeuille","portfolio management","gÃ©rant","gÃ©rante","fund manager","analyste financier","analyste","finance","finance de marchÃ©","marchÃ©s financiers","marchÃ©s","investissement","investissements","allocation","allocation d'actifs","asset allocation","performance","performance financiÃ¨re","portefeuille","portefeuilles","analyse financiÃ¨re","analyse","valorisation","pricing","risque","gestion risque","risk management","var","volatilitÃ©","rendement","yield","obligations","bonds","actions","equities","opcvm","sicav","fcp","etf","trackers","dÃ©rivÃ©s","options","futures","forex","devises","commodities","matiÃ¨res premiÃ¨res"] },
                { id: 27, name: "Immobilier & Alternatifs", keywords: ["immobilier","immobilier investissement","pierre papier","investissement immobilier","placement immobilier","scpi","opci","sci","sociÃ©tÃ© civile","fonciÃ¨re","reit","immobilier locatif","locatif","rendement locatif","loyer","loyers","actif immobilier","actifs rÃ©els","real estate","real assets","alternatif","alternatifs","private equity","pe","capital investissement","capital risque","venture capital","vc","lbo","dette privÃ©e","private debt","infrastructure","infra","fonds infrastructure","hedge funds","fonds alternatifs","fip","fcpi","fcpr","crowdfunding","crowdlending","co-investissement","club deal","carried interest"] },
                
                // ðŸ“£ MARKETING & COMMUNICATION (2)
                { id: 28, name: "Marketing & Communication", keywords: ["marketing","communication","responsable marketing","responsable communication","directeur marketing","directrice marketing","cmo","chief marketing officer","chargÃ© marketing","chargÃ©e communication","marque","brand","branding","brand manager","identitÃ© visuelle","charte graphique","logo","campagne","campagnes","publicitÃ©","pub","advertising","mÃ©dia","mÃ©dias","presse","relations presse","rp","pr","public relations","attachÃ© presse","communiquÃ©","dossier presse","contenu","content","content marketing","rÃ©daction","rÃ©dacteur","copywriter","storytelling","digital","numÃ©rique","rÃ©seaux sociaux","social media","linkedin","twitter","x","instagram","facebook","tiktok","youtube","community manager","community management","cm","social media manager","smm","animation communautÃ©","modÃ©ration","e-reputation","e-rÃ©putation","rÃ©putation","veille","planning Ã©ditorial","calendrier Ã©ditorial","Ã©ditorial","ligne Ã©ditoriale","podcast","vidÃ©o","webinar","webinaire","Ã©vÃ©nementiel","Ã©vÃ©nements","salons","confÃ©rences","sÃ©minaires","lead generation","gÃ©nÃ©ration leads","nurturing","newsletter","emailing","mailing","marketing automation"] },
                { id: 29, name: "Marketing Digital & Growth", keywords: ["marketing digital","digital marketing","webmarketing","web marketing","growth","growth marketing","growth hacker","growth hacking","acquisition","acquisition digitale","acquisition clients","performance marketing","performance","seo","rÃ©fÃ©rencement naturel","rÃ©fÃ©rencement","search engine optimization","sea","rÃ©fÃ©rencement payant","google ads","adwords","sem","search engine marketing","social ads","facebook ads","linkedin ads","display","programmatique","retargeting","remarketing","analytics","web analytics","google analytics","ga4","adobe analytics","mixpanel","amplitude","taux conversion","conversion rate optimization","cro","landing page","ux","user experience","ab test","ab testing","split test","tracking","tag manager","gtm","attribution","roi","roas","cac","coÃ»t acquisition","ltv","lifetime value","funnel","entonnoir conversion","performance digitale","kpi digitaux","automation","marketing automation","hubspot","marketo","pardot","mailchimp","sendinblue","brevo","emailing","campagnes email","drip","sÃ©quences","inbound marketing","inbound","outbound marketing","outbound","content marketing","smo","dataviz","data visualisation","tableau bord","dashboard","reporting marketing"] },
                
                // âš–ï¸ CONFORMITÃ‰ & JURIDIQUE (2)
                { id: 30, name: "ConformitÃ© & ContrÃ´le Interne", keywords: ["conformitÃ©","compliance","compliance officer","responsable conformitÃ©","rcsi","rcci","dÃ©ontologie","dÃ©ontologue","contrÃ´le interne","contrÃ´le permanent","contrÃ´le pÃ©riodique","audit interne","auditeur interne","inspection","lcb ft","lcb-ft","lutte blanchiment","aml","anti money laundering","kyc","know your customer","connaissance client","due diligence","ddq","questionnaire","loi sapin","corruption","rÃ©glementaire","rÃ©glementation","veille rÃ©glementaire","mifid","mif 2","priips","kid","dici","solvabilitÃ©","solvency","bale","bÃ¢le","risque","gestion risques","risk","cartographie risques","matrice risques","procÃ©dure","procÃ©dures","politique","politiques","contrÃ´le","contrÃ´les","plan contrÃ´le","testing","monitoring","reporting rÃ©glementaire","dÃ©clarations","amf","acpr","autoritÃ© marchÃ©s","rÃ©gulateur","sanctions","pab","pot","lutte fraude","fraude","investigation"] },
                { id: 31, name: "Juridique & FiscalitÃ©", keywords: ["juridique","legal","juriste","juriste senior","juriste droit affaires","juriste corporate","juriste fiscal","avocat","counsel","directeur juridique","head of legal","chief legal officer","clo","droit","droit des affaires","droit sociÃ©tÃ©s","droit commercial","droit fiscal","fiscal","fiscalitÃ©","fiscaliste","tax","tax manager","optimisation fiscale","stratÃ©gie fiscale","montage","structuration","restructuration","holding","pacte associÃ©s","pacte actionnaires","shareholders agreement","statuts","contrat","contrats","rÃ©daction contrats","nÃ©gociation contrats","contentieux","litiges","arbitrage","mÃ©diation","transaction","m&a juridique","due diligence juridique","audit juridique","transmission","cession","donation","succession","ifi","impÃ´t fortune","plus-values","rÃ©gime fiscal","dÃ©fiscalisation","niche fiscale"] },
                
                // ðŸ“Š FINANCE & COMPTABILITÃ‰ (2)
                { id: 32, name: "ComptabilitÃ©", keywords: ["comptabilitÃ©","comptabilitÃ© gÃ©nÃ©rale","comptabilitÃ© auxiliaire","comptabilitÃ© clients","comptabilitÃ© fournisseurs","comptabilitÃ© analytique","comptable","comptable gÃ©nÃ©ral","comptable unique","chef comptable","responsable comptable","directeur comptable","accounting","accountant","Ã©critures","Ã©critures comptables","saisie","imputation","journal","journaux","bilan","compte rÃ©sultat","balance","grand livre","lettrage","rapprochement","rapprochement bancaire","rÃ©conciliation","clÃ´ture","clÃ´ture mensuelle","clÃ´ture annuelle","arrÃªtÃ© comptes","liasse fiscale","dÃ©clarations fiscales","tva","is","impÃ´t sociÃ©tÃ©s","cfp","cvae","das2","normes comptables","pcg","ifrs","us gaap","consolidation","conso","intercos","intercompany","provisions","amortissements","immobilisations","stocks","cut-off","fec","audit comptable","rÃ©vision","certification","cac","commissaire comptes","expert comptable"] },
                { id: 33, name: "ContrÃ´le de Gestion", keywords: ["contrÃ´le gestion","contrÃ´le de gestion","contrÃ´leur gestion","contrÃ´leur de gestion","financial controller","fc","management control","gestion management","reporting","reporting financier","reporting mensuel","budget","budgets","processus budgÃ©taire","Ã©laboration budget","suivi budgÃ©taire","forecast","reforecast","rolling forecast","atterrissage","pilotage performance","pilotage","performance","indicateurs","indicateurs performance","kpi","key performance indicators","tableau bord","dashboard","scorecard","analyse financiÃ¨re","analyse Ã©carts","variance analysis","marge","marges","rentabilitÃ©","profitabilitÃ©","p&l","profit loss","compte exploitation","ebitda","ebit","rÃ©sultat opÃ©rationnel","coÃ»ts","analyse coÃ»ts","costing","prix revient","business plan","plan affaires","modÃ©lisation","modÃ¨le financier","simulation","scenarios","sensibilitÃ©"] },
                
                // ðŸ’» IT & DATA (3)
                { id: 34, name: "IT, SystÃ¨mes d'Information & Data", keywords: ["it","dsi","directeur systÃ¨mes information","dsi adjoint","cio","chief information officer","cto","chief technology officer","systÃ¨mes information","si","information systems","informatique","technologies","infrastructure","infra","rÃ©seau","rÃ©seaux","network","serveurs","servers","cloud","aws","azure","gcp","google cloud","hÃ©bergement","hosting","datacenter","virtualisation","vmware","stockage","storage","sÃ©curitÃ©","sÃ©curitÃ© informatique","cybersÃ©curitÃ©","cybersecurity","soc","firewall","antivirus","iam","identity","authentification","data","donnÃ©es","base donnÃ©es","database","sql","nosql","big data","data lake","data warehouse","dwh","etl","intÃ©gration donnÃ©es","bi","business intelligence","reporting","tableau bord","dashboard","qlik","tableau","power bi","looker","dataviz","visualisation donnÃ©es","analytics","analyse donnÃ©es","data analyst","data engineer","data scientist","machine learning","ml","ia","ai","intelligence artificielle","crm","salesforce","dynamics","erp","sap","oracle","processus digitaux","digitalisation","transformation digitale","automatisation","rpa"] },
                { id: 35, name: "DÃ©veloppement & Projets IT", keywords: ["dÃ©veloppement","dÃ©veloppeur","dÃ©veloppeuse","dev","developer","ingÃ©nieur dÃ©veloppement","ingÃ©nieur logiciel","software engineer","fullstack","full stack","frontend","front-end","backend","back-end","web","mobile","ios","android","java","python","javascript","typescript","react","angular","vue","node","php","c#",".net","go","rust","projets it","gestion projets","chef projet","chef de projet","project manager","pm","pmo","project management office","moa","maÃ®trise ouvrage","amoa","moe","maÃ®trise oeuvre","amoe","product owner","po","product manager","scrum master","agile","scrum","kanban","safe","sprint","backlog","user stories","intÃ©gration","ci cd","devops","sre","site reliability","dÃ©ploiement","release","api","rest","graphql","microservices","architecture","architecte","solution architect","technical architect","infrastructure","cloud","containerisation","docker","kubernetes","k8s","aws","azure","gcp","delivery","livraison","recette","tests","qa","quality assurance"] },
                { id: 36, name: "Back-Office & OpÃ©rations", keywords: ["back office","back-office","opÃ©rations","operations","gestionnaire back office","technicien back office","traitement","traitements","rÃ¨glement livraison","settlement","clearing","compensation","opÃ©rations titres","securities operations","flux","flux financiers","cash management","gestion cash","rÃ©conciliation","reconciliation","rapprochement","matching","breaks","suspens","investigations","rÃ©gularisation","process","processus opÃ©rationnels","contrÃ´les","contrÃ´le opÃ©rationnel","exÃ©cution","execution","ordres","orders","corporate actions","ost","opÃ©rations sur titres","dividendes","coupons","remboursements","swift","rÃ©fÃ©rentiel","rÃ©fÃ©rentiels","static data","master data","valorisation","pricing","nav","valeur liquidative","reporting opÃ©rationnel","stp","straight through processing","automatisation","middle office opÃ©rations"] }
            ],
            targetCompany: 'Cyrus Herez',
            currentView: 'list',
            selectedEmployee: null,
            companyMission: "Cyrus Herez accompagne les dirigeants, entrepreneurs et familles dans la construction, la sÃ©curisation et la transmission de leur patrimoine grÃ¢ce Ã  une approche globale intÃ©grant conseil stratÃ©gique, ingÃ©nierie patrimoniale, allocation financiÃ¨re, immobilier et investissements alternatifs."
        };

        // ===== FONCTIONS EXISTANTES =====

        function loadState() {
            try {
                const saved = localStorage.getItem('employees');
                if (saved) state.employees = JSON.parse(saved);
            } catch (e) {
                console.error('Error loading state:', e);
            }
        }

        function saveState() {
            localStorage.setItem('employees', JSON.stringify(state.employees));
        }

        function processText(text) {
            return text.toLowerCase()
                .replace(/[^\w\sÃ Ã¢Ã¤Ã©Ã¨ÃªÃ«Ã¯Ã®Ã´Ã¹Ã»Ã¼Ã¿Ã¦Å“Ã§]/gi, ' ')
                .split(/\s+/)
                .filter(word => word.length > 2);
        }

        function extractLinkedInUsername(url) {
            if (!url) return '';
            const match = url.match(/linkedin\.com\/in\/([^\/\?]+)/);
            return match ? match[1] : '';
        }

        function isValidLinkedInURL(url) {
            return /linkedin\.com\/in\/[^\/\?]+/.test(url);
        }

        function extractProfileInfo(text) {
            const lines = text.split('\n').filter(l => l.trim());
            let firstName = '', lastName = '', position = '', company = '';
            
            for (let i = 0; i < Math.min(5, lines.length); i++) {
                const line = lines[i].trim();
                const nameMatch = line.match(/^([A-ZÃ€-Ã¿][a-zÃ -Ã¿]+(?:\s+[A-ZÃ€-Ã¿][a-zÃ -Ã¿]+){0,2})\s*$/);
                if (nameMatch && line.length < 40) {
                    const parts = nameMatch[1].split(/\s+/);
                    if (parts.length >= 2) {
                        firstName = parts[0];
                        lastName = parts.slice(1).join(' ');
                        break;
                    }
                }
            }
            
            const positionKeywords = ['manager', 'director', 'ceo', 'cto', 'cfo', 'developer', 'engineer', 'consultant', 'analyst', 'specialist', 'coordinator', 'lead', 'head', 'chef', 'responsable', 'directeur', 'directrice', 'gÃ©rant', 'associÃ©', 'partner', 'founder', 'fondateur', 'conseiller', 'banquier'];
            for (const line of lines) {
                const lowerLine = line.toLowerCase();
                if (positionKeywords.some(keyword => lowerLine.includes(keyword))) {
                    position = line.trim();
                    break;
                }
            }
            
            for (const line of lines) {
                if (line.toLowerCase().includes('chez ') || line.toLowerCase().includes(' at ') || line.toLowerCase().includes('cyrus')) {
                    company = line.replace(/chez |at /gi, '').trim();
                    break;
                }
            }
            
            return { firstName, lastName, position, company };
        }

        function capitalizeWord(str) {
            if (!str) return '';
            return str.charAt(0).toUpperCase() + str.slice(1).toLowerCase();
        }

        function extractNameFromLinkedInUrl(url) {
            const username = extractLinkedInUsername(url);
            if (!username) return { firstName: '', lastName: '' };
            let slug = decodeURIComponent(username).toLowerCase().replace(/\d+/g, '').replace(/_/g, '-').replace(/\s+/g, '-');
            const parts = slug.split('-').filter(Boolean);
            if (parts.length === 0) return { firstName: '', lastName: '' };
            if (parts.length === 1) return { firstName: capitalizeWord(parts[0]), lastName: '' };
            if (parts.length === 2) return { firstName: capitalizeWord(parts[0]), lastName: capitalizeWord(parts[1]) };
            return { firstName: parts.slice(0, -1).map(capitalizeWord).join(' '), lastName: capitalizeWord(parts[parts.length - 1]) };
        }

        function analyzeProfile(profileText) {
            const wordCount = processText(profileText).length;
            
            // Normaliser le texte du profil
            const normalizedText = profileText.toLowerCase()
                .normalize('NFD').replace(/[\u0300-\u036f]/g, '');
            
            const axisScores = state.brandDNA.map(axis => {
                // Un keyword est trouvÃ© s'il apparaÃ®t dans le texte (en tant que substring)
                const foundKeywords = axis.keywords.filter(keyword => {
                    const normalizedKeyword = keyword.toLowerCase()
                        .normalize('NFD').replace(/[\u0300-\u036f]/g, '');
                    return normalizedText.includes(normalizedKeyword);
                });
                const rawScore = (foundKeywords.length / axis.keywords.length) * 100;
                return {
                    axisId: axis.id,
                    axisName: axis.name,
                    score: Math.round(rawScore),
                    foundKeywords: foundKeywords,
                    missingKeywords: axis.keywords.filter(k => !foundKeywords.includes(k))
                };
            });
            const totalWeight = state.brandDNA.reduce((sum, axis) => sum + axis.weight, 0);
            const globalScore = Math.round(
                axisScores.reduce((sum, score) => {
                    const axis = state.brandDNA.find(a => a.id === score.axisId);
                    return sum + (score.score * axis.weight / totalWeight);
                }, 0)
            );
            return { globalScore, axisScores, wordCount, analyzedAt: new Date().toISOString() };
        }

        function calculateSSI(profileText, employee) {
            const text = profileText.toLowerCase();
            const words = processText(profileText);
            const wordCount = words.length;
            let brandScore = 0;
            brandScore += (employee.firstName && employee.lastName) ? 5 : 0;
            brandScore += employee.position ? 5 : 0;
            brandScore += wordCount >= 200 ? 10 : (wordCount >= 100 ? 5 : 0);
            brandScore += (text.includes('expert') || text.includes('spÃ©cialiste') || text.includes('passion')) ? 5 : 0;
            const networkKeywords = ['rÃ©seau', 'network', 'professionnel', 'contact', 'relation', 'partenaire', 'collaboration'];
            const peopleScore = Math.min(25, networkKeywords.filter(k => text.includes(k)).length * 4);
            const engageKeywords = ['partage', 'publication', 'article', 'insight', 'analyse', 'expertise', 'conseil', 'contribution'];
            const engagementScore = Math.min(25, engageKeywords.filter(k => text.includes(k)).length * 3.5);
            const relationKeywords = ['accompagnement', 'Ã©coute', 'client', 'confiance', 'long-terme', 'fidÃ©litÃ©', 'suivi', 'proximitÃ©'];
            const relationScore = Math.min(25, relationKeywords.filter(k => text.includes(k)).length * 3.5);
            const ssiScore = Math.round(brandScore + peopleScore + engagementScore + relationScore);
            let sectorRanking = 50, networkRanking = 50;
            if (ssiScore >= 75) { sectorRanking = 10; networkRanking = 15; }
            else if (ssiScore >= 60) { sectorRanking = 20; networkRanking = 24; }
            else if (ssiScore >= 45) { sectorRanking = 35; networkRanking = 40; }
            else if (ssiScore >= 30) { sectorRanking = 50; networkRanking = 55; }
            return { ssiScore, ssiBrandScore: Math.round(brandScore), ssiPeopleScore: Math.round(peopleScore), ssiEngagementScore: Math.round(engagementScore), ssiRelationScore: Math.round(relationScore), ssiSectorRanking: sectorRanking, ssiNetworkRanking: networkRanking, ssiAvgSectorScore: 32, ssiAvgNetworkScore: 36 };
        }

        // ===== SCORE LINKEDIN PRO (Grille d'Ã©valuation professionnelle) =====
        function calculateLinkedInScore(profileText, employee) {
            const text = profileText.toLowerCase();
            const normalizedText = text.normalize('NFD').replace(/[\u0300-\u036f]/g, '');
            const wordCount = processText(profileText).length;
            
            // ===== 1. IDENTITÃ‰ & CRÃ‰DIBILITÃ‰ IMMÃ‰DIATE (15 pts) =====
            
            // 1.1 Photo de profil (5 pts) - On ne peut pas dÃ©tecter, on suppose prÃ©sente si profil complet
            const hasPhotoIndicators = text.includes('photo') || text.includes('image') || wordCount > 100;
            const photoScore = hasPhotoIndicators ? 3 : 0; // Score conservateur
            
            // 1.2 Titre professionnel (5 pts)
            let headlineScore = 0;
            const headlineKeywords = ['senior', 'lead', 'head', 'manager', 'directeur', 'expert', 'specialist', 'consultant', 'engineer', 'developer', 'responsable', 'chef'];
            const valueKeywords = ['|', 'â€¢', '-', 'spÃ©cialisÃ©', 'expert en', 'passionnÃ©'];
            const hasProTitle = headlineKeywords.some(k => normalizedText.includes(k));
            const hasTitleStructure = valueKeywords.some(k => text.includes(k));
            if (hasProTitle && hasTitleStructure) headlineScore = 5;
            else if (hasProTitle || employee.position) headlineScore = 3;
            else if (employee.position) headlineScore = 2;
            
            // 1.3 Localisation & disponibilitÃ© (5 pts)
            const locationKeywords = ['paris', 'lyon', 'marseille', 'bordeaux', 'nantes', 'toulouse', 'lille', 'france', 'rÃ©gion', 'Ã®le-de-france', 'remote', 'tÃ©lÃ©travail', 'hybride'];
            const hasLocation = locationKeywords.some(l => normalizedText.includes(l));
            const hasCurrentJob = text.includes('actuel') || text.includes('current') || text.includes('prÃ©sent') || text.includes('depuis');
            const locationScore = (hasLocation ? 3 : 0) + (hasCurrentJob ? 2 : 0);
            
            const identityScore = photoScore + headlineScore + locationScore; // Max 15
            
            // ===== 2. PROPOSITION DE VALEUR & POSITIONNEMENT (20 pts) =====
            
            // 2.1 RÃ©sumÃ© / Ã€ propos (10 pts)
            let summaryScore = 0;
            const hasNumbers = /\d+/.test(text);
            const hasResults = ['rÃ©sultat', 'impact', 'rÃ©alis', 'atteint', 'dÃ©velopp', 'augment', 'rÃ©duit', 'optimis', 'amÃ©lio', 'gÃ©nÃ©rÃ©'].some(r => normalizedText.includes(r));
            const hasStructure = text.includes('â€¢') || text.includes('-') || text.includes('|') || text.includes(':');
            const hasBusiness = ['business', 'ca', 'chiffre', 'client', 'stratÃ©g', 'croissance', 'performance'].some(b => normalizedText.includes(b));
            
            if (hasNumbers && hasResults && hasBusiness) summaryScore = 10;
            else if (hasResults && (hasNumbers || hasBusiness)) summaryScore = 7;
            else if (hasResults || hasBusiness) summaryScore = 5;
            else if (wordCount > 50) summaryScore = 3;
            
            // 2.2 CohÃ©rence du positionnement (10 pts)
            let coherenceScore = 0;
            // VÃ©rifier si les mots-clÃ©s du dÃ©partement apparaissent dans le profil
            const deptKeywordsFound = employee.deptFoundKeywords?.length || 0;
            const deptTotal = employee.deptTotalKeywords || 1;
            const coherenceRatio = deptKeywordsFound / deptTotal;
            
            if (coherenceRatio >= 0.3) coherenceScore = 10;
            else if (coherenceRatio >= 0.15) coherenceScore = 7;
            else if (coherenceRatio >= 0.05) coherenceScore = 5;
            else coherenceScore = 2;
            
            const positioningScore = summaryScore + coherenceScore; // Max 20
            
            // ===== 3. EXPÃ‰RIENCE PROFESSIONNELLE (25 pts) =====
            
            // 3.1 DÃ©tail des expÃ©riences (15 pts)
            let experienceDetailScore = 0;
            const expKeywords = ['expÃ©rience', 'experience', 'poste', 'mission', 'responsab', 'projet', 'Ã©quipe', 'manage', 'pilote', 'dÃ©velopp'];
            const hasExpDetail = expKeywords.filter(k => normalizedText.includes(k)).length;
            const hasMetrics = /(\d+\s*%|\d+\s*[kKmM]?â‚¬|\d+\s*clients?|\d+\s*personnes?|\d+\s*projets?)/.test(text);
            const hasImpact = ['augment', 'rÃ©duit', 'crÃ©Ã©', 'lancÃ©', 'nÃ©goci', 'signÃ©', 'gÃ©nÃ©rÃ©', 'optimis'].some(i => normalizedText.includes(i));
            
            if (hasExpDetail >= 4 && hasMetrics && hasImpact) experienceDetailScore = 15;
            else if (hasExpDetail >= 3 && (hasMetrics || hasImpact)) experienceDetailScore = 12;
            else if (hasExpDetail >= 2 && hasMetrics) experienceDetailScore = 10;
            else if (hasExpDetail >= 2) experienceDetailScore = 8;
            else if (hasExpDetail >= 1) experienceDetailScore = 5;
            else experienceDetailScore = 3;
            
            // 3.2 Progression de carriÃ¨re (10 pts)
            let progressionScore = 0;
            const seniorityTerms = ['junior', 'confirmÃ©', 'senior', 'lead', 'manager', 'head', 'directeur', 'vp', 'chief', 'partner'];
            const progressionTerms = ['promu', 'Ã©volution', 'progression', 'nommÃ©', 'devenu', 'promotion'];
            const yearsPattern = /(\d+)\s*ans?/g;
            const yearsMatches = [...normalizedText.matchAll(yearsPattern)];
            const hasLongExp = yearsMatches.some(m => parseInt(m[1]) >= 5);
            const hasSeniority = seniorityTerms.filter(s => normalizedText.includes(s)).length >= 2;
            const hasProgression = progressionTerms.some(p => normalizedText.includes(p));
            
            if (hasProgression && hasSeniority) progressionScore = 10;
            else if (hasLongExp && hasSeniority) progressionScore = 8;
            else if (hasSeniority || hasLongExp) progressionScore = 6;
            else if (hasProgression) progressionScore = 5;
            else progressionScore = 3;
            
            const experienceScore = experienceDetailScore + progressionScore; // Max 25
            
            // ===== 4. COMPÃ‰TENCES & EXPERTISE RÃ‰ELLE (20 pts) =====
            
            // 4.1 CompÃ©tences listÃ©es (10 pts)
            let skillsScore = 0;
            const skillsKeywords = ['compÃ©tence', 'skill', 'expertise', 'maÃ®trise', 'connaissance', 'savoir-faire', 'spÃ©cialitÃ©'];
            const toolsFound = employee.atsFoundTools?.length || 0;
            const hasSkillsSection = skillsKeywords.some(s => normalizedText.includes(s));
            
            if (toolsFound >= 5 && hasSkillsSection) skillsScore = 10;
            else if (toolsFound >= 3 || (hasSkillsSection && deptKeywordsFound >= 5)) skillsScore = 8;
            else if (toolsFound >= 1 || deptKeywordsFound >= 3) skillsScore = 6;
            else if (hasSkillsSection) skillsScore = 4;
            else skillsScore = 2;
            
            // 4.2 Validation sociale (10 pts)
            let validationScore = 0;
            const recoMatch = normalizedText.match(/(\d+)\s*recommandation/i);
            const recoCount = recoMatch ? parseInt(recoMatch[1]) : 0;
            const endorsementKeywords = ['validÃ©', 'endorsed', 'recommand', 'tÃ©moign', 'rÃ©fÃ©rence'];
            const hasEndorsements = endorsementKeywords.some(e => normalizedText.includes(e));
            
            if (recoCount >= 5 && hasEndorsements) validationScore = 10;
            else if (recoCount >= 3 || hasEndorsements) validationScore = 7;
            else if (recoCount >= 1) validationScore = 5;
            else validationScore = 0;
            
            const competenceScore = skillsScore + validationScore; // Max 20
            
            // ===== 5. PREUVE D'ENGAGEMENT & VISIBILITÃ‰ (10 pts) =====
            
            // 5.1 ActivitÃ© LinkedIn (5 pts)
            let activityScore = 0;
            const activityKeywords = ['publication', 'article', 'post', 'partag', 'Ã©crit', 'publi', 'auteur', 'contributeur'];
            const hasActivity = activityKeywords.filter(a => normalizedText.includes(a)).length;
            
            if (hasActivity >= 3) activityScore = 5;
            else if (hasActivity >= 1) activityScore = 3;
            else activityScore = 0;
            
            // 5.2 RÃ©seau & interactions (5 pts)
            let networkScore = 0;
            
            // Fonction pour extraire les nombres avec sÃ©parateurs (espaces, points, virgules)
            const extractNumber = (text, patterns) => {
                for (const pattern of patterns) {
                    const match = text.match(pattern);
                    if (match) {
                        // Nettoyer le nombre (enlever espaces, remplacer virgules)
                        const numStr = match[1].replace(/[\s\u00A0\.]/g, '').replace(',', '');
                        return parseInt(numStr) || 0;
                    }
                }
                return 0;
            };
            
            // Patterns pour dÃ©tecter abonnÃ©s/followers
            const followerPatterns = [
                /([\d\s\u00A0.,]+)\s*abonn[Ã©e]s?/i,
                /([\d\s\u00A0.,]+)\s*followers?/i,
                /abonn[Ã©e]s?\s*:?\s*([\d\s\u00A0.,]+)/i,
                /followers?\s*:?\s*([\d\s\u00A0.,]+)/i
            ];
            
            // Patterns pour dÃ©tecter relations/connexions
            const connexionPatterns = [
                /([\d\s\u00A0.,]+)\s*(?:relations?|connexions?|contacts?)/i,
                /(?:relations?|connexions?|contacts?)\s*:?\s*([\d\s\u00A0.,]+)/i,
                /plus de\s*([\d\s\u00A0.,]+)\s*(?:relations?|connexions?)/i,
                /more than\s*([\d\s\u00A0.,]+)\s*(?:connections?|contacts?)/i
            ];
            
            const followersCount = extractNumber(text, followerPatterns);
            const connexionsCount = extractNumber(text, connexionPatterns);
            
            // Utiliser le max entre followers et connexions
            const networkCount = Math.max(followersCount, connexionsCount);
            
            const networkKeywords = ['rÃ©seau', 'network', 'communautÃ©', 'groupe', 'association', 'membre'];
            const hasNetworkMention = networkKeywords.some(n => normalizedText.includes(n));
            
            // Score basÃ© sur le rÃ©seau
            if (networkCount >= 10000) networkScore = 5;
            else if (networkCount >= 500 || text.includes('plus de 500')) networkScore = 5;
            else if (networkCount >= 200) networkScore = 4;
            else if (networkCount >= 100 || hasNetworkMention) networkScore = 3;
            else if (networkCount > 0) networkScore = 2;
            else networkScore = 1;
            
            const engagementScore = activityScore + networkScore; // Max 10
            
            // Stocker les valeurs dÃ©tectÃ©es pour affichage
            const detectedFollowers = followersCount;
            const detectedConnexions = connexionsCount;
            
            // ===== 6. FORMATION & CRÃ‰DIBILITÃ‰ ACADÃ‰MIQUE (10 pts) =====
            
            // 6.1 Formation initiale (5 pts)
            let educationScore = 0;
            const educationKeywords = ['diplÃ´me', 'master', 'licence', 'bachelor', 'ingÃ©nieur', 'Ã©cole', 'universitÃ©', 'bac+', 'formation', 'mba', 'doctorat', 'phd'];
            const prestigeSchools = ['hec', 'essec', 'escp', 'edhec', 'polytechnique', 'centrale', 'mines', 'dauphine', 'sciences po', 'insead', 'em lyon'];
            const hasEducation = educationKeywords.filter(e => normalizedText.includes(e)).length;
            const hasPrestige = prestigeSchools.some(s => normalizedText.includes(s));
            
            if (hasPrestige) educationScore = 5;
            else if (hasEducation >= 2) educationScore = 5;
            else if (hasEducation >= 1) educationScore = 3;
            else educationScore = 0;
            
            // 6.2 Certifications / apprentissage continu (5 pts)
            let certScore = 0;
            const certKeywords = ['certifi', 'certified', 'certification', 'accrÃ©ditÃ©', 'agrÃ©Ã©', 'habilitÃ©', 'cfa', 'amf', 'pmp', 'scrum', 'aws', 'google', 'microsoft', 'cisco'];
            const recentLearning = ['formation continue', 'mooc', 'cours', 'learning', 'bootcamp', 'spÃ©cialisation'];
            const hasCerts = certKeywords.filter(c => normalizedText.includes(c)).length;
            const hasLearning = recentLearning.some(l => normalizedText.includes(l));
            
            if (hasCerts >= 3) certScore = 5;
            else if (hasCerts >= 1 && hasLearning) certScore = 5;
            else if (hasCerts >= 1) certScore = 4;
            else if (hasLearning) certScore = 3;
            else certScore = 0;
            
            const formationScore = educationScore + certScore; // Max 10
            
            // ===== SCORE TOTAL LINKEDIN PRO =====
            const linkedinGlobalScore = Math.min(100, identityScore + positioningScore + experienceScore + competenceScore + engagementScore + formationScore);
            
            // ===== RÃˆGLES Ã‰LIMINATOIRES (No-Go) =====
            const noGoReasons = [];
            if (experienceDetailScore < 5) noGoReasons.push("Aucune expÃ©rience dÃ©taillÃ©e");
            if (headlineScore < 2) noGoReasons.push("Titre non professionnel");
            if (coherenceScore < 3) noGoReasons.push("IncohÃ©rences dans le positionnement");
            if (wordCount < 50) noGoReasons.push("Profil trop succinct");
            
            const isNoGo = noGoReasons.length >= 2;
            const finalScore = isNoGo ? Math.min(29, linkedinGlobalScore) : linkedinGlobalScore;
            
            // DÃ©terminer le niveau
            let linkedinLevel, linkedinVerdict;
            if (isNoGo) {
                linkedinLevel = "ðŸ”´ Non pertinent";
                linkedinVerdict = "Profil Ã©liminÃ© (rÃ¨gles No-Go)";
            } else if (finalScore >= 85) {
                linkedinLevel = "ðŸ† Expert";
                linkedinVerdict = "Profil hautement pertinent";
            } else if (finalScore >= 70) {
                linkedinLevel = "âœ… Solide";
                linkedinVerdict = "Profil solide et exploitable";
            } else if (finalScore >= 50) {
                linkedinLevel = "âš ï¸ Moyen";
                linkedinVerdict = "Profil Ã  approfondir";
            } else if (finalScore >= 30) {
                linkedinLevel = "ðŸŸ  Faible";
                linkedinVerdict = "Profil peu diffÃ©renciant";
            } else {
                linkedinLevel = "ðŸ”´ Insuffisant";
                linkedinVerdict = "Profil non pertinent";
            }
            
            return { 
                linkedinGlobalScore: finalScore,
                linkedinLevel,
                linkedinVerdict,
                linkedinIsNoGo: isNoGo,
                linkedinNoGoReasons: noGoReasons,
                // Scores dÃ©taillÃ©s
                linkedinIdentityScore: identityScore,
                linkedinPhotoScore: photoScore,
                linkedinHeadlineScore: headlineScore,
                linkedinLocationScore: locationScore,
                linkedinPositioningScore: positioningScore,
                linkedinSummaryScore: summaryScore,
                linkedinCoherenceScore: coherenceScore,
                linkedinExperienceScore: experienceScore,
                linkedinExpDetailScore: experienceDetailScore,
                linkedinProgressionScore: progressionScore,
                linkedinCompetenceScore: competenceScore,
                linkedinSkillsScore: skillsScore,
                linkedinValidationScore: validationScore,
                linkedinEngagementScore: engagementScore,
                linkedinActivityScore: activityScore,
                linkedinNetworkScore: networkScore,
                linkedinFormationScore: formationScore,
                linkedinEducationScore: educationScore,
                linkedinCertScore: certScore,
                // Valeurs dÃ©tectÃ©es
                linkedinFollowersCount: detectedFollowers,
                linkedinConnexionsCount: detectedConnexions
            };
        }

        // ===== SCORE ATS (Applicant Tracking System) =====
        function calculateATSScore(profileText, employee, deptName) {
            const text = profileText.toLowerCase();
            const normalizedText = text.normalize('NFD').replace(/[\u0300-\u036f]/g, '');
            
            // Dictionnaire de synonymes
            const synonyms = {
                'daf': ['cfo', 'directeur financier', 'directeur administratif financier'],
                'drh': ['chro', 'directeur ressources humaines', 'chief people officer'],
                'dg': ['ceo', 'directeur gÃ©nÃ©ral', 'pdg', 'prÃ©sident'],
                'dsi': ['cio', 'cto', 'directeur systÃ¨mes information'],
                'kam': ['key account manager', 'grands comptes'],
                'csm': ['customer success manager', 'customer success'],
                'sdr': ['sales development representative', 'business development representative'],
                'crm': ['salesforce', 'hubspot', 'dynamics', 'pipedrive'],
                'erp': ['sap', 'oracle', 'sage', 'cegid'],
                'bi': ['power bi', 'tableau', 'qlik', 'looker']
            };
            
            // Fonction pour chercher avec synonymes
            const findWithSynonyms = (searchText, keywords) => {
                return keywords.filter(kw => {
                    const kwLower = kw.toLowerCase();
                    if (searchText.includes(kwLower)) return true;
                    // VÃ©rifier les synonymes
                    for (const [key, syns] of Object.entries(synonyms)) {
                        if (kwLower.includes(key) || syns.some(s => kwLower.includes(s))) {
                            if (searchText.includes(key) || syns.some(s => searchText.includes(s))) return true;
                        }
                    }
                    return false;
                });
            };
            
            // 1. TitleFit (0-20) - Correspondance des titres
            const seniorTitles = ['directeur', 'director', 'head', 'lead', 'responsable', 'manager', 'chief', 'vp', 'vice-prÃ©sident', 'associÃ©', 'partner', 'prÃ©sident', 'ceo', 'cfo', 'cto', 'coo'];
            const hasSeniorTitle = seniorTitles.some(t => normalizedText.includes(t));
            const titleMatch = employee.position ? 12 : 0;
            const seniorBonus = hasSeniorTitle ? 8 : 0;
            const titleFit = Math.min(20, titleMatch + seniorBonus);
            
            // 2. ToolsFit (0-15) - Outils et technologies
            const toolsKeywords = [
                // CRM & Sales
                'salesforce', 'hubspot', 'pipedrive', 'dynamics', 'zoho',
                // Finance & Compta
                'sap', 'oracle', 'sage', 'cegid', 'quadra', 'excel', 'vba',
                // BI & Data
                'power bi', 'tableau', 'qlik', 'looker', 'sql', 'python',
                // Marketing
                'google analytics', 'semrush', 'mailchimp', 'marketo', 'pardot',
                // IT & Support
                'servicenow', 'jira', 'confluence', 'zendesk', 'freshdesk',
                // RH
                'workday', 'talentsoft', 'cornerstone', 'linkedin recruiter',
                // Collaboration
                'microsoft 365', 'google workspace', 'slack', 'teams', 'notion', 'trello', 'asana'
            ];
            const foundTools = toolsKeywords.filter(t => normalizedText.includes(t.toLowerCase()));
            const toolsFit = Math.min(15, Math.round((foundTools.length / 5) * 15));
            
            // 3. SeniorityFit (0-15) - AnciennetÃ© et progression
            // DÃ©tecter les annÃ©es d'expÃ©rience
            const yearsPatterns = [
                /(\d+)\s*(?:ans?|annÃ©es?)\s*(?:d['']?expÃ©rience|d['']?exp)/gi,
                /(?:depuis|from)\s*(\d{4})/gi,
                /(\d+)\+?\s*(?:years?|ans?)/gi
            ];
            let totalYears = 0;
            yearsPatterns.forEach(pattern => {
                const matches = normalizedText.matchAll(pattern);
                for (const match of matches) {
                    const num = parseInt(match[1]);
                    if (num > 1900 && num < 2030) {
                        totalYears = Math.max(totalYears, 2025 - num);
                    } else if (num < 50) {
                        totalYears = Math.max(totalYears, num);
                    }
                }
            });
            
            // DÃ©tecter progression de carriÃ¨re
            const progressionKeywords = ['Ã©volution', 'promotion', 'promu', 'devenu', 'nommÃ©', 'progression'];
            const hasProgression = progressionKeywords.some(p => normalizedText.includes(p));
            
            const yearsScore = Math.min(10, totalYears >= 10 ? 10 : totalYears >= 5 ? 7 : totalYears >= 2 ? 4 : 2);
            const progressionBonus = hasProgression ? 5 : (hasSeniorTitle ? 3 : 0);
            const seniorityFit = Math.min(15, yearsScore + progressionBonus);
            
            // 4. ImpactKPI (0-25) - RÃ©sultats chiffrÃ©s et KPIs
            const kpiPatterns = [
                /[+\-]?\d+(?:[,\.]\d+)?\s*%/g,                    // Pourcentages
                /\d+(?:[,\.]\d+)?\s*[kKmM]?â‚¬/g,                   // Montants euros
                /â‚¬\s*\d+(?:[,\.]\d+)?\s*[kKmM]?/g,                // Euros avant
                /\d+(?:[,\.]\d+)?\s*(?:millions?|mio|mâ‚¬|kâ‚¬)/gi,   // Millions/K
                /(?:x|Ã—)\s*\d+(?:[,\.]\d+)?/g,                    // Multiplicateurs
                /\d+\s*(?:clients?|comptes?|dossiers?|projets?)/gi, // Volumes
                /(?:arr|mrr|aum|nps|csat|ebitda|ca|chiffre d'affaires)[\s:]*\d+/gi, // KPIs nommÃ©s
                /(?:top|nÂ°)\s*\d+/gi,                              // Rankings
                /\d+\s*(?:collaborateurs?|personnes?|Ã©quipe)/gi    // Taille Ã©quipe
            ];
            
            let kpiCount = 0;
            let kpiQuality = 0;
            const kpiMatches = [];
            
            kpiPatterns.forEach(pattern => {
                const matches = normalizedText.match(pattern) || [];
                kpiCount += matches.length;
                matches.forEach(m => kpiMatches.push(m));
            });
            
            // QualitÃ© des KPIs (avec contexte d'impact)
            const impactWords = ['augment', 'croissance', 'hausse', 'progression', 'amÃ©lio', 'rÃ©duit', 'baisse', 'diminut', 'optimis', 'gÃ©nÃ©r', 'atteint', 'dÃ©pass', 'rÃ©alis'];
            const hasImpactContext = impactWords.some(w => normalizedText.includes(w));
            kpiQuality = hasImpactContext ? 1 : (kpiCount > 0 ? 0.5 : 0);
            
            const impactKPI = Math.min(25, Math.round(5 * Math.log1p(kpiCount) + 15 * kpiQuality));
            
            // 5. Credibility (0-15) - CrÃ©dibilitÃ©
            // Recommandations
            const recoMatch = normalizedText.match(/(\d+)\s*recommandation/i);
            const recoCount = recoMatch ? parseInt(recoMatch[1]) : 0;
            const recoScore = Math.min(5, recoCount);
            
            // Certifications pertinentes
            const certKeywords = ['certifi', 'diplÃ´m', 'master', 'mba', 'cfa', 'amf', 'acpr', 'cgp', 'cif', 'iobsp', 'ias', 'aws', 'google', 'scrum', 'pmp', 'itil', 'prince2'];
            const certCount = certKeywords.filter(c => normalizedText.includes(c)).length;
            const certScore = Math.min(5, certCount * 1.5);
            
            // StabilitÃ© (mentions de durÃ©e longue)
            const stabilityPatterns = [/(\d+)\s*ans?\s*(?:chez|at|dans)/gi, /depuis\s*(\d{4})/gi];
            let hasStability = false;
            stabilityPatterns.forEach(pattern => {
                const matches = normalizedText.matchAll(pattern);
                for (const match of matches) {
                    const num = parseInt(match[1]);
                    if ((num >= 3 && num < 50) || (num > 1900 && 2025 - num >= 3)) {
                        hasStability = true;
                    }
                }
            });
            const stabilityScore = hasStability ? 3 : 1;
            
            // Connexions LinkedIn - AmÃ©lioration dÃ©tection
            const extractNetworkCount = (searchText) => {
                const patterns = [
                    /([\d\s\u00A0.,]+)\s*(?:connexions?|relations?|contacts?)/i,
                    /(?:connexions?|relations?|contacts?)\s*:?\s*([\d\s\u00A0.,]+)/i,
                    /plus de\s*([\d\s\u00A0.,]+)\s*(?:connexions?|relations?)/i,
                    /([\d\s\u00A0.,]+)\s*(?:abonn[Ã©e]s?|followers?)/i,
                    /(?:abonn[Ã©e]s?|followers?)\s*:?\s*([\d\s\u00A0.,]+)/i
                ];
                for (const pattern of patterns) {
                    const match = searchText.match(pattern);
                    if (match) {
                        const numStr = match[1].replace(/[\s\u00A0\.]/g, '').replace(',', '');
                        return parseInt(numStr) || 0;
                    }
                }
                return 0;
            };
            
            const atsNetworkCount = extractNetworkCount(text);
            const hasPlus500 = text.includes('plus de 500') || text.includes('more than 500');
            const connexionScore = (atsNetworkCount >= 500 || hasPlus500) ? 2 : (atsNetworkCount >= 200 ? 1 : 0);
            
            const credibility = Math.min(15, Math.round(recoScore + certScore + stabilityScore + connexionScore));
            
            // 6. ContextFit (0-10) - Contexte
            const locationKeywords = ['paris', 'lyon', 'marseille', 'bordeaux', 'nantes', 'toulouse', 'lille', 'france', 'Ã®le-de-france', 'remote', 'tÃ©lÃ©travail', 'hybride'];
            const hasLocation = locationKeywords.some(l => normalizedText.includes(l));
            
            const sectorKeywords = ['finance', 'banque', 'assurance', 'patrimoine', 'gestion', 'investissement', 'conseil', 'audit', 'immobilier'];
            const hasSector = sectorKeywords.some(s => normalizedText.includes(s));
            
            const contextFit = (hasLocation ? 5 : 2) + (hasSector ? 5 : 2);
            
            // Score final ATS (pondÃ©rÃ© selon la catÃ©gorie)
            const weights = {
                titleFit: 0.15,
                toolsFit: 0.12,
                seniorityFit: 0.13,
                impactKPI: 0.25,
                credibility: 0.15,
                contextFit: 0.08,
                keywordFit: 0.12  // Utilise le score mÃ©tier existant
            };
            
            // RÃ©cupÃ©rer le score mÃ©tier comme keywordFit
            const deptScore = employee.deptScore || 0;
            const keywordFitNormalized = (deptScore / 100) * 20; // Normaliser sur 20
            
            const rawScore = 
                (titleFit / 20) * 100 * weights.titleFit +
                (toolsFit / 15) * 100 * weights.toolsFit +
                (seniorityFit / 15) * 100 * weights.seniorityFit +
                (impactKPI / 25) * 100 * weights.impactKPI +
                (credibility / 15) * 100 * weights.credibility +
                (contextFit / 10) * 100 * weights.contextFit +
                (keywordFitNormalized / 20) * 100 * weights.keywordFit;
            
            const atsScore = Math.round(rawScore);
            
            // DÃ©cision ATS
            let atsDecision, atsDecisionColor;
            if (atsScore >= 80) {
                atsDecision = "ðŸŸ¢ Shortlist";
                atsDecisionColor = "green";
            } else if (atsScore >= 65) {
                atsDecision = "ðŸŸ¡ Ã€ examiner";
                atsDecisionColor = "yellow";
            } else if (atsScore >= 40) {
                atsDecision = "ðŸŸ  En attente";
                atsDecisionColor = "orange";
            } else {
                atsDecision = "ðŸ”´ Non retenu";
                atsDecisionColor = "red";
            }
            
            return {
                atsScore,
                atsDecision,
                atsDecisionColor,
                atsTitleFit: titleFit,
                atsToolsFit: toolsFit,
                atsSeniorityFit: seniorityFit,
                atsImpactKPI: impactKPI,
                atsCredibility: credibility,
                atsContextFit: contextFit,
                atsFoundTools: foundTools,
                atsKPICount: kpiCount,
                atsKPIMatches: kpiMatches.slice(0, 10),
                atsTotalYears: totalYears,
                atsHasProgression: hasProgression,
                atsCertCount: certCount,
                atsRecoCount: recoCount
            };
        }

        function calculateDeptScore(profileText, deptName) {
            const dept = state.departments.find(d => d.name === deptName);
            if (!dept) return { score: 0, foundKeywords: [], missingKeywords: [], totalKeywords: 0 };
            
            // Normaliser le texte du profil
            const normalizedText = profileText.toLowerCase()
                .normalize('NFD').replace(/[\u0300-\u036f]/g, '');
            
            // Un keyword est trouvÃ© s'il apparaÃ®t dans le texte (en tant que substring)
            const foundKeywords = dept.keywords.filter(keyword => {
                const normalizedKeyword = keyword.toLowerCase()
                    .normalize('NFD').replace(/[\u0300-\u036f]/g, '');
                return normalizedText.includes(normalizedKeyword);
            });
            
            return { 
                score: Math.round((foundKeywords.length / dept.keywords.length) * 100), 
                foundKeywords, 
                missingKeywords: dept.keywords.filter(k => !foundKeywords.includes(k)), 
                totalKeywords: dept.keywords.length 
            };
        }

        function quickAdd() {
            const text = prompt('ðŸ“‹ Collez le contenu du profil LinkedIn ici (Ctrl+V / Cmd+V) :');
            if (!text || text.length < 50) {
                alert('âŒ Le texte est vide ou trop court. Veuillez copier le profil complet depuis LinkedIn.');
                return;
            }
            const rawLinkedinUrl = prompt('ðŸ”— Collez l\'URL du profil LinkedIn (optionnel) :') || '';
            let linkedinUrl = '';
            if (rawLinkedinUrl.trim() !== '' && isValidLinkedInURL(rawLinkedinUrl.trim())) {
                linkedinUrl = rawLinkedinUrl.trim();
            }
            const extracted = extractProfileInfo(text);
            const analysis = analyzeProfile(text);
            let firstName = extracted.firstName || (linkedinUrl ? extractNameFromLinkedInUrl(linkedinUrl).firstName : '') || 'PrÃ©nom';
            let lastName = extracted.lastName || (linkedinUrl ? extractNameFromLinkedInUrl(linkedinUrl).lastName : '') || 'Nom';
            let autoDept = '', maxScore = 0;
            state.departments.forEach(dept => {
                const deptAnalysis = calculateDeptScore(text, dept.name);
                if (deptAnalysis.score > maxScore) { maxScore = deptAnalysis.score; autoDept = dept.name; }
            });
            const deptAnalysis = calculateDeptScore(text, autoDept);
            const newEmployee = {
                id: Date.now(), firstName, lastName, position: extracted.position || 'Poste', department: autoDept,
                company: extracted.company || state.targetCompany, linkedinUrl, email: '', profileText: text,
                globalScore: analysis.globalScore, axisScores: analysis.axisScores, wordCount: analysis.wordCount,
                analyzedAt: analysis.analyzedAt, deptScore: deptAnalysis.score, deptFoundKeywords: deptAnalysis.foundKeywords,
                deptMissingKeywords: deptAnalysis.missingKeywords, deptTotalKeywords: deptAnalysis.totalKeywords, createdAt: new Date().toISOString()
            };
            Object.assign(newEmployee, calculateLinkedInScore(text, newEmployee), calculateSSI(text, newEmployee));
            Object.assign(newEmployee, calculateATSScore(text, newEmployee, autoDept));
            state.employees.push(newEmployee);
            saveState();
            render();
            const linkedinInfo = newEmployee.linkedinIsNoGo ? ' â›” NO-GO' : ' ' + newEmployee.linkedinLevel;
            alert('âœ… Profil ajoutÃ© : ' + newEmployee.firstName + ' ' + newEmployee.lastName + 
                '\n\nðŸ“Š Score SSI : ' + newEmployee.ssiScore + '/100' +
                '\nðŸ”µ Score LinkedIn Pro : ' + newEmployee.linkedinGlobalScore + '/100' + linkedinInfo +
                '\nðŸ§¬ Score ADN : ' + newEmployee.globalScore + '/100' +
                '\nðŸ’¼ Score MÃ©tier : ' + newEmployee.deptScore + '/100' +
                '\nðŸŽ¯ Score ATS : ' + newEmployee.atsScore + '/100 ' + newEmployee.atsDecision);
        }

        function deleteEmployee(id) {
            if (confirm('Supprimer ce collaborateur ?')) {
                state.employees = state.employees.filter(emp => emp.id !== id);
                saveState();
                render();
            }
        }

        function viewEmployee(id) {
            state.selectedEmployee = state.employees.find(emp => emp.id === id);
            state.currentView = 'detail';
            render();
        }

        function exportData() {
            const blob = new Blob([JSON.stringify({ employees: state.employees, brandDNA: state.brandDNA, departments: state.departments, targetCompany: state.targetCompany }, null, 2)], { type: 'application/json' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'linkedin-analyzer-' + Date.now() + '.json';
            a.click();
        }

        function clearAllData() {
            if (confirm('âš ï¸ Supprimer TOUTES les donnÃ©es ? Cette action est irrÃ©versible.')) {
                state.employees = [];
                saveState();
                render();
            }
        }

        function getScoreBadge(score) {
            if (score >= 70) return 'bg-green-100 text-green-800';
            if (score >= 40) return 'bg-yellow-100 text-yellow-800';
            return 'bg-red-100 text-red-800';
        }

        function getScoreColor(score) {
            if (score >= 70) return 'text-green-600';
            if (score >= 40) return 'text-yellow-600';
            return 'text-red-600';
        }

        // ===== FONCTIONS DE SYNTHÃˆSE ET PRÃ‰CONISATIONS =====
        
        function getSSISynthesis(emp) {
            const score = emp.ssiScore || 0;
            const brand = emp.ssiBrandScore || 0;
            const people = emp.ssiPeopleScore || 0;
            const engagement = emp.ssiEngagementScore || 0;
            const relation = emp.ssiRelationScore || 0;
            
            let level, description;
            if (score >= 75) {
                level = "ðŸ† Excellent";
                description = `${emp.firstName} fait partie des meilleurs profils du secteur avec un SSI de ${score}/100. Son personal branding est solide et son activitÃ© LinkedIn gÃ©nÃ¨re de l'engagement.`;
            } else if (score >= 55) {
                level = "âœ… Bon";
                description = `${emp.firstName} a un bon niveau d'activitÃ© sur LinkedIn avec un SSI de ${score}/100. Quelques optimisations permettraient d'atteindre l'excellence.`;
            } else if (score >= 35) {
                level = "âš ï¸ Ã€ dÃ©velopper";
                description = `${emp.firstName} a un SSI de ${score}/100, infÃ©rieur Ã  la moyenne du secteur. Un plan d'action ciblÃ© est recommandÃ© pour amÃ©liorer sa visibilitÃ©.`;
            } else {
                level = "ðŸ”´ Faible";
                description = `${emp.firstName} a un SSI de ${score}/100, ce qui indique une prÃ©sence LinkedIn Ã  construire. Une formation aux fondamentaux serait bÃ©nÃ©fique.`;
            }
            
            // Identifier les points forts et faibles
            const factors = [
                { name: "Marque professionnelle", score: brand, icon: "ðŸ†" },
                { name: "Trouver les bonnes personnes", score: people, icon: "ðŸ‘¥" },
                { name: "Ã‰changer des informations", score: engagement, icon: "ðŸ’¬" },
                { name: "Ã‰tablir des relations", score: relation, icon: "ðŸ¤" }
            ];
            
            const strengths = factors.filter(f => f.score >= 18).sort((a, b) => b.score - a.score);
            const weaknesses = factors.filter(f => f.score < 15).sort((a, b) => a.score - b.score);
            
            return { level, description, strengths, weaknesses };
        }
        
        function getSSIRecommendations(emp) {
            const recommendations = [];
            const brand = emp.ssiBrandScore || 0;
            const people = emp.ssiPeopleScore || 0;
            const engagement = emp.ssiEngagementScore || 0;
            const relation = emp.ssiRelationScore || 0;
            
            // Marque professionnelle
            if (brand < 20) {
                if (brand < 10) {
                    recommendations.push({
                        priority: "haute",
                        category: "ðŸ† Marque professionnelle",
                        actions: [
                            "ComplÃ©ter le titre avec des mots-clÃ©s mÃ©tier (ex: 'Conseiller en Gestion de Patrimoine | Expert Transmission')",
                            "RÃ©diger un rÃ©sumÃ© percutant de 3-4 paragraphes avec votre proposition de valeur",
                            "Ajouter une photo professionnelle de qualitÃ© (fond neutre, sourire)",
                            "Personnaliser la banniÃ¨re avec les couleurs Cyrus Herez"
                        ]
                    });
                } else {
                    recommendations.push({
                        priority: "moyenne",
                        category: "ðŸ† Marque professionnelle",
                        actions: [
                            "Enrichir le rÃ©sumÃ© avec des rÃ©alisations chiffrÃ©es",
                            "Ajouter des mÃ©dias (prÃ©sentations, articles, vidÃ©os)",
                            "Demander 3-5 recommandations Ã  des clients ou partenaires"
                        ]
                    });
                }
            }
            
            // Trouver les bonnes personnes
            if (people < 20) {
                if (people < 10) {
                    recommendations.push({
                        priority: "haute",
                        category: "ðŸ‘¥ DÃ©velopper son rÃ©seau",
                        actions: [
                            "Atteindre 500+ connexions pour plus de crÃ©dibilitÃ©",
                            "Se connecter avec les dÃ©cideurs du secteur patrimonial",
                            "Rejoindre 5+ groupes LinkedIn pertinents (CGP, gestion de fortune, family office)",
                            "Suivre les leaders d'opinion du secteur"
                        ]
                    });
                } else {
                    recommendations.push({
                        priority: "moyenne",
                        category: "ðŸ‘¥ DÃ©velopper son rÃ©seau",
                        actions: [
                            "Personnaliser les demandes de connexion",
                            "Interagir rÃ©guliÃ¨rement avec les posts de son rÃ©seau",
                            "Identifier et suivre les prospects potentiels"
                        ]
                    });
                }
            }
            
            // Ã‰changer des informations
            if (engagement < 20) {
                if (engagement < 10) {
                    recommendations.push({
                        priority: "haute",
                        category: "ðŸ’¬ Partager du contenu",
                        actions: [
                            "Publier 1-2 posts par semaine sur des sujets patrimoniaux",
                            "Commenter 3-5 publications par jour de maniÃ¨re pertinente",
                            "Partager les actualitÃ©s Cyrus Herez avec un commentaire personnel",
                            "Relayer les articles de presse financiÃ¨re avec votre analyse"
                        ]
                    });
                } else {
                    recommendations.push({
                        priority: "moyenne",
                        category: "ðŸ’¬ Partager du contenu",
                        actions: [
                            "Varier les formats : texte, carousel, vidÃ©o courte",
                            "CrÃ©er du contenu Ã©ducatif (conseils fiscaux, tendances marchÃ©s)",
                            "Taguer les personnes et entreprises mentionnÃ©es"
                        ]
                    });
                }
            }
            
            // Ã‰tablir des relations
            if (relation < 20) {
                if (relation < 10) {
                    recommendations.push({
                        priority: "haute",
                        category: "ðŸ¤ Construire des relations",
                        actions: [
                            "RÃ©pondre Ã  tous les messages dans les 24h",
                            "FÃ©liciter son rÃ©seau pour les promotions/anniversaires",
                            "Initier des conversations privÃ©es aprÃ¨s des interactions publiques",
                            "Proposer des rendez-vous tÃ©lÃ©phoniques ou cafÃ©s virtuels"
                        ]
                    });
                } else {
                    recommendations.push({
                        priority: "moyenne",
                        category: "ðŸ¤ Construire des relations",
                        actions: [
                            "Utiliser InMail pour les prospects stratÃ©giques",
                            "Organiser ou participer Ã  des LinkedIn Live",
                            "CrÃ©er des sondages pour engager son audience"
                        ]
                    });
                }
            }
            
            return recommendations;
        }
        
        // ===== SYNTHÃˆSE ET PRÃ‰CONISATIONS LINKEDIN PRO =====
        function getLinkedInProSynthesis(emp) {
            const score = emp.linkedinGlobalScore || 0;
            const isNoGo = emp.linkedinIsNoGo || false;
            
            let description;
            if (isNoGo) {
                description = `Le profil de ${emp.firstName} prÃ©sente des lacunes critiques qui le rendent inexploitable en l'Ã©tat. ${(emp.linkedinNoGoReasons || []).length} rÃ¨gle(s) Ã©liminatoire(s) dÃ©tectÃ©e(s).`;
            } else if (score >= 85) {
                description = `Le profil de ${emp.firstName} est exemplaire : positionnement clair, expÃ©riences dÃ©taillÃ©es avec rÃ©sultats, crÃ©dibilitÃ© Ã©tablie. C'est un profil prÃªt pour le recrutement ou la prospection.`;
            } else if (score >= 70) {
                description = `${emp.firstName} dispose d'un profil professionnel solide et exploitable. Quelques optimisations le rendraient encore plus impactant.`;
            } else if (score >= 50) {
                description = `Le profil de ${emp.firstName} est correct mais manque de diffÃ©renciation. Un travail sur la proposition de valeur et les rÃ©sultats est conseillÃ©.`;
            } else if (score >= 30) {
                description = `Le profil de ${emp.firstName} est faible et peu diffÃ©renciant. Il nÃ©cessite une refonte importante pour Ãªtre exploitable.`;
            } else {
                description = `Le profil de ${emp.firstName} n'est pas pertinent pour un usage professionnel. Une reconstruction complÃ¨te est nÃ©cessaire.`;
            }
            
            // Identifier les points forts et faibles
            const sections = [
                { name: "IdentitÃ© & CrÃ©dibilitÃ©", score: emp.linkedinIdentityScore || 0, max: 15, icon: "ðŸ‘¤" },
                { name: "Proposition de valeur", score: emp.linkedinPositioningScore || 0, max: 20, icon: "ðŸ’¡" },
                { name: "ExpÃ©rience professionnelle", score: emp.linkedinExperienceScore || 0, max: 25, icon: "ðŸ’¼" },
                { name: "CompÃ©tences & Expertise", score: emp.linkedinCompetenceScore || 0, max: 20, icon: "ðŸ› ï¸" },
                { name: "Engagement & VisibilitÃ©", score: emp.linkedinEngagementScore || 0, max: 10, icon: "ðŸ“¢" },
                { name: "Formation & AcadÃ©mique", score: emp.linkedinFormationScore || 0, max: 10, icon: "ðŸŽ“" }
            ];
            
            const strengths = sections.filter(s => (s.score / s.max) >= 0.7);
            const weaknesses = sections.filter(s => (s.score / s.max) < 0.4);
            
            return { 
                level: emp.linkedinLevel || '', 
                verdict: emp.linkedinVerdict || '', 
                description, 
                strengths, 
                weaknesses,
                isNoGo,
                noGoReasons: emp.linkedinNoGoReasons || [],
                sections
            };
        }
        
        function getLinkedInProRecommendations(emp) {
            const recommendations = [];
            
            // 1. IdentitÃ© & CrÃ©dibilitÃ©
            if ((emp.linkedinIdentityScore || 0) < 12) {
                recommendations.push({
                    priority: (emp.linkedinHeadlineScore || 0) < 3 ? "haute" : "moyenne",
                    category: "ðŸ‘¤ IdentitÃ© & CrÃ©dibilitÃ© immÃ©diate",
                    section: "identity",
                    score: emp.linkedinIdentityScore || 0,
                    maxScore: 15,
                    subsections: [
                        { name: "Photo", score: emp.linkedinPhotoScore || 0, max: 5 },
                        { name: "Titre", score: emp.linkedinHeadlineScore || 0, max: 5 },
                        { name: "Localisation", score: emp.linkedinLocationScore || 0, max: 5 }
                    ],
                    actions: [
                        "Ajouter une photo professionnelle (cadrage visage, fond neutre, sourire)",
                        "Optimiser le titre avec mÃ©tier + spÃ©cialitÃ© + valeur (ex: 'CGP | Transmission & Famille | Cyrus Herez')",
                        "Renseigner la localisation et le statut actuel (poste en cours)"
                    ]
                });
            }
            
            // 2. Proposition de valeur
            if ((emp.linkedinPositioningScore || 0) < 15) {
                recommendations.push({
                    priority: (emp.linkedinSummaryScore || 0) < 5 ? "haute" : "moyenne",
                    category: "ðŸ’¡ Proposition de valeur",
                    section: "positioning",
                    score: emp.linkedinPositioningScore || 0,
                    maxScore: 20,
                    subsections: [
                        { name: "RÃ©sumÃ©", score: emp.linkedinSummaryScore || 0, max: 10 },
                        { name: "CohÃ©rence", score: emp.linkedinCoherenceScore || 0, max: 10 }
                    ],
                    actions: [
                        "RÃ©diger un rÃ©sumÃ© structurÃ© (3-4 paragraphes) orientÃ© rÃ©sultats",
                        "Inclure des chiffres et des rÃ©alisations concrÃ¨tes",
                        "Aligner le discours avec le positionnement mÃ©tier",
                        "Utiliser des mots-clÃ©s stratÃ©giques pour le rÃ©fÃ©rencement"
                    ]
                });
            }
            
            // 3. ExpÃ©rience professionnelle
            if ((emp.linkedinExperienceScore || 0) < 18) {
                recommendations.push({
                    priority: (emp.linkedinExpDetailScore || 0) < 8 ? "haute" : "moyenne",
                    category: "ðŸ’¼ ExpÃ©rience professionnelle",
                    section: "experience",
                    score: emp.linkedinExperienceScore || 0,
                    maxScore: 25,
                    subsections: [
                        { name: "DÃ©tail", score: emp.linkedinExpDetailScore || 0, max: 15 },
                        { name: "Progression", score: emp.linkedinProgressionScore || 0, max: 10 }
                    ],
                    actions: [
                        "DÃ©tailler chaque poste avec missions et responsabilitÃ©s",
                        "Ajouter des rÃ©sultats mesurables (%, â‚¬, volumes)",
                        "Montrer la progression de carriÃ¨re (Ã©volutions, promotions)",
                        "Ã‰viter les descriptions vagues, privilÃ©gier l'impact business"
                    ],
                    examples: [
                        "âŒ 'Responsable de la gestion de portefeuille'",
                        "âœ… 'Gestion d'un portefeuille de 80 clients (50Mâ‚¬ AUM), +15% de collecte annuelle, NPS 72'"
                    ]
                });
            }
            
            // 4. CompÃ©tences & Expertise
            if ((emp.linkedinCompetenceScore || 0) < 14) {
                recommendations.push({
                    priority: (emp.linkedinValidationScore || 0) < 3 ? "moyenne" : "basse",
                    category: "ðŸ› ï¸ CompÃ©tences & Validation sociale",
                    section: "competence",
                    score: emp.linkedinCompetenceScore || 0,
                    maxScore: 20,
                    subsections: [
                        { name: "CompÃ©tences", score: emp.linkedinSkillsScore || 0, max: 10 },
                        { name: "Recommandations", score: emp.linkedinValidationScore || 0, max: 10 }
                    ],
                    actions: [
                        "Lister 5-10 compÃ©tences clÃ©s pertinentes et hiÃ©rarchisÃ©es",
                        "Demander des recommandations Ã©crites (objectif : 5+)",
                        "Obtenir des validations de compÃ©tences par des pairs",
                        "Supprimer les compÃ©tences gÃ©nÃ©riques non diffÃ©renciantes"
                    ]
                });
            }
            
            // 5. Engagement & VisibilitÃ©
            if ((emp.linkedinEngagementScore || 0) < 7) {
                recommendations.push({
                    priority: "basse",
                    category: "ðŸ“¢ Engagement & VisibilitÃ©",
                    section: "engagement",
                    score: emp.linkedinEngagementScore || 0,
                    maxScore: 10,
                    subsections: [
                        { name: "ActivitÃ©", score: emp.linkedinActivityScore || 0, max: 5 },
                        { name: "RÃ©seau", score: emp.linkedinNetworkScore || 0, max: 5 }
                    ],
                    actions: [
                        "Publier rÃ©guliÃ¨rement du contenu professionnel",
                        "DÃ©velopper un rÃ©seau qualifiÃ© (500+ connexions ciblÃ©es)",
                        "Interagir avec les publications de son secteur",
                        "Rejoindre des groupes professionnels pertinents"
                    ]
                });
            }
            
            // 6. Formation
            if ((emp.linkedinFormationScore || 0) < 7) {
                recommendations.push({
                    priority: "basse",
                    category: "ðŸŽ“ Formation & Certifications",
                    section: "formation",
                    score: emp.linkedinFormationScore || 0,
                    maxScore: 10,
                    subsections: [
                        { name: "DiplÃ´mes", score: emp.linkedinEducationScore || 0, max: 5 },
                        { name: "Certifications", score: emp.linkedinCertScore || 0, max: 5 }
                    ],
                    actions: [
                        "Renseigner les formations initiales avec dÃ©tails",
                        "Ajouter les certifications professionnelles actuelles",
                        "Mentionner les formations continues rÃ©centes",
                        "Inclure les MOOCs et spÃ©cialisations pertinentes"
                    ]
                });
            }
            
            return recommendations.sort((a, b) => {
                const priorityOrder = { haute: 0, moyenne: 1, basse: 2 };
                return priorityOrder[a.priority] - priorityOrder[b.priority];
            });
        }
        
        function getADNSynthesis(emp) {
            const score = emp.globalScore;
            const strongAxes = emp.axisScores.filter(a => a.score >= 60);
            const weakAxes = emp.axisScores.filter(a => a.score < 40);
            
            let level, description;
            if (score >= 70) {
                level = "ðŸ† Excellent alignement";
                description = `Le profil de ${emp.firstName} reflÃ¨te parfaitement les valeurs et le positionnement de Cyrus Herez. C'est un excellent ambassadeur de la marque employeur.`;
            } else if (score >= 50) {
                level = "âœ… Bon alignement";
                description = `${emp.firstName} incarne correctement l'ADN de Cyrus Herez. Quelques ajustements de vocabulaire renforceraient l'alignement.`;
            } else if (score >= 30) {
                level = "âš ï¸ Alignement partiel";
                description = `Le profil de ${emp.firstName} n'utilise pas suffisamment le vocabulaire distinctif de Cyrus Herez. Un travail sur le wording est conseillÃ©.`;
            } else {
                level = "ðŸ”´ Faible alignement";
                description = `Le profil de ${emp.firstName} ne reflÃ¨te pas l'identitÃ© de Cyrus Herez. Une rÃ©Ã©criture guidÃ©e du profil est recommandÃ©e.`;
            }
            
            return { level, description, strongAxes, weakAxes };
        }
        
        function getADNRecommendations(emp) {
            const recommendations = [];
            
            emp.axisScores.forEach(axis => {
                if (axis.score < 50 && axis.missingKeywords.length > 0) {
                    const priority = axis.score < 25 ? "haute" : "moyenne";
                    const keywordsToAdd = axis.missingKeywords.slice(0, 5);
                    
                    let contextualAdvice = "";
                    if (axis.axisName.includes("Excellence")) {
                        contextualAdvice = "Mettez en avant votre expertise technique et vos certifications.";
                    } else if (axis.axisName.includes("IndÃ©pendance")) {
                        contextualAdvice = "Soulignez votre objectivitÃ© et votre approche Ã©thique.";
                    } else if (axis.axisName.includes("sur-mesure")) {
                        contextualAdvice = "Insistez sur la personnalisation et l'Ã©coute client.";
                    } else if (axis.axisName.includes("long-terme")) {
                        contextualAdvice = "Ã‰voquez la pÃ©rennitÃ© et l'accompagnement dans la durÃ©e.";
                    }
                    
                    recommendations.push({
                        priority: priority,
                        category: "ðŸ§¬ " + axis.axisName,
                        score: axis.score,
                        advice: contextualAdvice,
                        keywords: keywordsToAdd
                    });
                }
            });
            
            return recommendations.sort((a, b) => a.score - b.score);
        }
        
        function getMetierSynthesis(emp) {
            const score = emp.deptScore;
            const found = emp.deptFoundKeywords?.length || 0;
            const total = emp.deptTotalKeywords || 1;
            
            let level, description;
            if (score >= 60) {
                level = "ðŸ† TrÃ¨s bon positionnement";
                description = `Le profil de ${emp.firstName} utilise ${found} mots-clÃ©s sur ${total} du rÃ©fÃ©rentiel "${emp.department}". Le positionnement mÃ©tier est clair et bien articulÃ©.`;
            } else if (score >= 40) {
                level = "âœ… Bon positionnement";
                description = `${emp.firstName} couvre ${found}/${total} termes du rÃ©fÃ©rentiel mÃ©tier. L'ajout de quelques mots-clÃ©s spÃ©cifiques renforcerait la visibilitÃ© dans les recherches.`;
            } else if (score >= 20) {
                level = "âš ï¸ Positionnement partiel";
                description = `Avec ${found}/${total} mots-clÃ©s, le profil de ${emp.firstName} manque de terminologie spÃ©cifique au mÃ©tier. Il risque de passer sous le radar des recruteurs et prospects.`;
            } else {
                level = "ðŸ”´ Positionnement faible";
                description = `Le profil de ${emp.firstName} ne contient que ${found}/${total} termes mÃ©tier. Une optimisation complÃ¨te est nÃ©cessaire pour le rÃ©fÃ©rencement.`;
            }
            
            return { level, description, found, total };
        }
        
        function getMetierRecommendations(emp) {
            if (!emp.deptMissingKeywords || emp.deptMissingKeywords.length === 0) return [];
            
            // Grouper les mots-clÃ©s manquants par catÃ©gorie
            const missing = emp.deptMissingKeywords;
            
            // Identifier les types de mots-clÃ©s manquants
            const titres = missing.filter(k => 
                k.includes('directeur') || k.includes('responsable') || k.includes('manager') || 
                k.includes('chef') || k.includes('head') || k.includes('ceo') || k.includes('cfo')
            ).slice(0, 3);
            
            const competences = missing.filter(k => 
                !titres.includes(k) && (
                    k.includes('gestion') || k.includes('analyse') || k.includes('stratÃ©g') ||
                    k.includes('conseil') || k.includes('dÃ©veloppement') || k.includes('pilotage')
                )
            ).slice(0, 5);
            
            const outils = missing.filter(k => 
                k.includes('crm') || k.includes('erp') || k.includes('excel') || k.includes('power bi') ||
                k.includes('salesforce') || k.includes('sap') || k.includes('hubspot')
            ).slice(0, 3);
            
            const autres = missing.filter(k => 
                !titres.includes(k) && !competences.includes(k) && !outils.includes(k)
            ).slice(0, 5);
            
            const recommendations = [];
            
            if (competences.length > 0) {
                recommendations.push({
                    category: "ðŸ’¡ CompÃ©tences clÃ©s Ã  mentionner",
                    keywords: competences,
                    tip: "IntÃ©grez ces termes dans votre rÃ©sumÃ© et descriptions d'expÃ©riences."
                });
            }
            
            if (outils.length > 0) {
                recommendations.push({
                    category: "ðŸ› ï¸ Outils & Technologies",
                    keywords: outils,
                    tip: "Ajoutez ces outils dans la section CompÃ©tences de LinkedIn."
                });
            }
            
            if (autres.length > 0) {
                recommendations.push({
                    category: "ðŸ“Œ Autres termes mÃ©tier",
                    keywords: autres,
                    tip: "Utilisez ces termes naturellement dans vos descriptions."
                });
            }
            
            return recommendations;
        }
        
        // ===== SYNTHÃˆSE ET PRÃ‰CONISATIONS ATS =====
        function getATSSynthesis(emp) {
            const score = emp.atsScore || 0;
            
            let level, description, verdict;
            if (score >= 80) {
                level = "ðŸŸ¢ Shortlist";
                verdict = "Profil hautement qualifiÃ©";
                description = `Le profil de ${emp.firstName} obtient un excellent score ATS de ${score}/100. Il rÃ©pond aux critÃ¨res clÃ©s d'un recruteur : expÃ©rience, compÃ©tences, rÃ©sultats chiffrÃ©s. Ce candidat mÃ©rite d'Ãªtre contactÃ© en prioritÃ©.`;
            } else if (score >= 65) {
                level = "ðŸŸ¡ Ã€ examiner";
                verdict = "Profil intÃ©ressant";
                description = `Avec ${score}/100, le profil de ${emp.firstName} prÃ©sente de bons atouts mais nÃ©cessite un examen approfondi. Quelques optimisations permettraient de passer en shortlist.`;
            } else if (score >= 40) {
                level = "ðŸŸ  En attente";
                verdict = "Profil Ã  dÃ©velopper";
                description = `Le score ATS de ${score}/100 indique que le profil de ${emp.firstName} manque d'Ã©lÃ©ments clÃ©s pour convaincre un recruteur. Des amÃ©liorations significatives sont nÃ©cessaires.`;
            } else {
                level = "ðŸ”´ Non retenu";
                verdict = "Profil insuffisant";
                description = `Avec ${score}/100, le profil de ${emp.firstName} ne passerait pas les filtres ATS standard. Une refonte complÃ¨te du profil est recommandÃ©e.`;
            }
            
            // Points forts
            const strengths = [];
            if ((emp.atsTitleFit || 0) >= 15) strengths.push("Titre de poste pertinent");
            if ((emp.atsImpactKPI || 0) >= 18) strengths.push("RÃ©sultats chiffrÃ©s prÃ©sents");
            if ((emp.atsToolsFit || 0) >= 10) strengths.push("Outils maÃ®trisÃ©s mentionnÃ©s");
            if ((emp.atsSeniorityFit || 0) >= 12) strengths.push("ExpÃ©rience solide");
            if ((emp.atsCredibility || 0) >= 10) strengths.push("CrÃ©dibilitÃ© Ã©tablie");
            
            // Points faibles
            const weaknesses = [];
            if ((emp.atsImpactKPI || 0) < 10) weaknesses.push("Manque de rÃ©sultats chiffrÃ©s");
            if ((emp.atsToolsFit || 0) < 5) weaknesses.push("Outils non mentionnÃ©s");
            if ((emp.atsSeniorityFit || 0) < 8) weaknesses.push("ExpÃ©rience peu visible");
            if ((emp.atsCredibility || 0) < 8) weaknesses.push("CrÃ©dibilitÃ© Ã  renforcer");
            
            return { level, verdict, description, strengths, weaknesses };
        }
        
        function getATSRecommendations(emp) {
            const recommendations = [];
            
            // ImpactKPI - Le plus important !
            if ((emp.atsImpactKPI || 0) < 18) {
                const priority = (emp.atsImpactKPI || 0) < 10 ? "haute" : "moyenne";
                recommendations.push({
                    priority,
                    category: "ðŸ“Š Ajouter des rÃ©sultats chiffrÃ©s",
                    pillar: "ImpactKPI",
                    score: emp.atsImpactKPI || 0,
                    maxScore: 25,
                    actions: [
                        "Quantifier vos rÃ©alisations avec des % (ex: '+25% de CA', '-15% de coÃ»ts')",
                        "Mentionner les montants gÃ©rÃ©s (ex: 'Portefeuille de 50Mâ‚¬', 'Budget de 2Mâ‚¬')",
                        "Indiquer les volumes traitÃ©s (ex: '200 clients', '50 dossiers/mois')",
                        "Ajouter des KPIs mÃ©tier (NPS, CSAT, AUM, ARR, taux de conversion...)",
                        "PrÃ©ciser la taille des Ã©quipes managÃ©es"
                    ],
                    examples: [
                        "âŒ 'Responsable du dÃ©veloppement commercial'",
                        "âœ… 'DÃ©veloppement du CA de +35% (2Mâ‚¬â†’2.7Mâ‚¬) sur 18 mois, portefeuille de 150 clients'"
                    ]
                });
            }
            
            // ToolsFit
            if ((emp.atsToolsFit || 0) < 10) {
                recommendations.push({
                    priority: "moyenne",
                    category: "ðŸ› ï¸ Mentionner les outils maÃ®trisÃ©s",
                    pillar: "ToolsFit",
                    score: emp.atsToolsFit || 0,
                    maxScore: 15,
                    actions: [
                        "Lister les logiciels mÃ©tier dans la section CompÃ©tences",
                        "Mentionner les outils dans les descriptions d'expÃ©riences",
                        "Ajouter les certifications logicielles obtenues"
                    ],
                    suggestedTools: [
                        "CRM : Salesforce, HubSpot, Dynamics, Pipedrive",
                        "Finance : SAP, Oracle, Sage, Cegid, Excel avancÃ©",
                        "BI/Data : Power BI, Tableau, SQL, Python",
                        "Marketing : Google Analytics, SEMrush, Mailchimp",
                        "Collaboration : Microsoft 365, Slack, Notion, Jira"
                    ]
                });
            }
            
            // SeniorityFit
            if ((emp.atsSeniorityFit || 0) < 10) {
                recommendations.push({
                    priority: "moyenne",
                    category: "ðŸ“… Valoriser l'expÃ©rience",
                    pillar: "SeniorityFit",
                    score: emp.atsSeniorityFit || 0,
                    maxScore: 15,
                    actions: [
                        "PrÃ©ciser le nombre d'annÃ©es d'expÃ©rience dans le rÃ©sumÃ©",
                        "Montrer la progression de carriÃ¨re (promotions, Ã©volutions)",
                        "Dater clairement chaque expÃ©rience (mois/annÃ©e)",
                        "Mettre en avant les responsabilitÃ©s croissantes"
                    ]
                });
            }
            
            // TitleFit
            if ((emp.atsTitleFit || 0) < 15) {
                recommendations.push({
                    priority: "moyenne",
                    category: "ðŸ·ï¸ Optimiser le titre",
                    pillar: "TitleFit",
                    score: emp.atsTitleFit || 0,
                    maxScore: 20,
                    actions: [
                        "Utiliser un titre de poste standard et recherchÃ©",
                        "Ajouter des mots-clÃ©s mÃ©tier au titre (ex: 'CGP | Gestion de Patrimoine | Transmission')",
                        "Ã‰viter les titres trop crÃ©atifs non reconnus par les ATS"
                    ]
                });
            }
            
            // Credibility
            if ((emp.atsCredibility || 0) < 10) {
                recommendations.push({
                    priority: "basse",
                    category: "ðŸ… Renforcer la crÃ©dibilitÃ©",
                    pillar: "Credibility",
                    score: emp.atsCredibility || 0,
                    maxScore: 15,
                    actions: [
                        "Demander des recommandations LinkedIn (objectif : 5+)",
                        "Ajouter les certifications professionnelles (AMF, CIF, IOBSP...)",
                        "Mentionner les formations diplÃ´mantes (Master, MBA, CFA...)",
                        "Montrer une stabilitÃ© professionnelle (durÃ©es > 2 ans)"
                    ]
                });
            }
            
            return recommendations.sort((a, b) => {
                const priorityOrder = { haute: 0, moyenne: 1, basse: 2 };
                return priorityOrder[a.priority] - priorityOrder[b.priority];
            });
        }

        function handleAddEmployee(event) {
            event.preventDefault();
            const profileText = document.getElementById('profileText').value;
            const linkedinUrl = document.getElementById('linkedinUrl')?.value || '';
            const email = document.getElementById('email')?.value || '';
            const department = document.getElementById('department').value;
            if (linkedinUrl && !isValidLinkedInURL(linkedinUrl)) { alert('âš ï¸ URL LinkedIn invalide'); return; }
            if (email && !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) { alert('âš ï¸ Email invalide'); return; }
            const analysis = analyzeProfile(profileText);
            const deptAnalysis = calculateDeptScore(profileText, department);
            const newEmployee = {
                id: Date.now(), firstName: document.getElementById('firstName').value, lastName: document.getElementById('lastName').value,
                position: document.getElementById('position').value, department, company: document.getElementById('company').value,
                email, linkedinUrl, profileText, globalScore: analysis.globalScore, axisScores: analysis.axisScores,
                wordCount: analysis.wordCount, analyzedAt: analysis.analyzedAt, deptScore: deptAnalysis.score,
                deptFoundKeywords: deptAnalysis.foundKeywords, deptMissingKeywords: deptAnalysis.missingKeywords,
                deptTotalKeywords: deptAnalysis.totalKeywords, createdAt: new Date().toISOString()
            };
            Object.assign(newEmployee, calculateLinkedInScore(profileText, newEmployee), calculateSSI(profileText, newEmployee));
            Object.assign(newEmployee, calculateATSScore(profileText, newEmployee, department));
            state.employees.push(newEmployee);
            saveState();
            state.currentView = 'list';
            render();
            alert('âœ… Profil ajoutÃ© avec succÃ¨s !');
        }

        function renderHeader() {
            return `<header class="bg-gradient-to-r from-blue-900 to-blue-800 shadow-lg border-b">
                <div class="max-w-7xl mx-auto px-4 py-4">
                    <div class="flex items-center justify-between">
                        <div>
                            <h1 class="text-2xl font-bold text-white">Analyseur LinkedIn - Cyrus Herez</h1>
                            <p class="text-sm text-blue-100 mt-1">Alignement des profils avec l'ADN de l'entreprise</p>
                        </div>
                        <div class="flex gap-2">
                            <button onclick="exportData()" class="p-2 text-white hover:bg-blue-700 rounded-lg" title="Exporter">ðŸ“¥</button>
                            <button onclick="clearAllData()" class="p-2 text-white hover:bg-red-700 rounded-lg" title="Tout supprimer">ðŸ—‘ï¸</button>
                        </div>
                    </div>
                </div>
            </header>`;
        }

        function renderEmployeeList() {
            const avgScore = state.employees.length > 0 ? Math.round(state.employees.reduce((sum, emp) => sum + emp.globalScore, 0) / state.employees.length) : 0;
            const avgLinkedInScore = state.employees.length > 0 ? Math.round(state.employees.reduce((sum, emp) => sum + (emp.linkedinGlobalScore || 0), 0) / state.employees.length) : 0;
            const avgSSIScore = state.employees.length > 0 ? Math.round(state.employees.reduce((sum, emp) => sum + (emp.ssiScore || 0), 0) / state.employees.length) : 0;
            const avgATSScore = state.employees.length > 0 ? Math.round(state.employees.reduce((sum, emp) => sum + (emp.atsScore || 0), 0) / state.employees.length) : 0;
            const noGoCount = state.employees.filter(e => e.linkedinIsNoGo).length;
            
            let html = `<div class="space-y-4">
                <div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-lg border border-blue-200">
                    <h3 class="text-lg font-bold text-blue-900 mb-2">ðŸ›ï¸ Cyrus Herez - Gestion Patrimoniale</h3>
                    <p class="text-sm text-blue-800 mb-3">${state.companyMission}</p>
                </div>`;
            
            if (state.employees.length > 0) {
                html += `<div class="grid grid-cols-7 gap-2">
                    <div class="bg-white p-3 rounded-lg shadow-sm text-center"><p class="text-xl font-bold text-blue-600">${state.employees.length}</p><p class="text-xs text-gray-600">Profils</p></div>
                    <div class="bg-white p-3 rounded-lg shadow-sm text-center"><p class="text-xl font-bold text-purple-600">${avgSSIScore}</p><p class="text-xs text-gray-600">SSI</p></div>
                    <div class="bg-white p-3 rounded-lg shadow-sm text-center"><p class="text-xl font-bold text-cyan-600">${avgLinkedInScore}</p><p class="text-xs text-gray-600">LinkedIn Pro</p></div>
                    <div class="bg-white p-3 rounded-lg shadow-sm text-center"><p class="text-xl font-bold text-green-600">${avgScore}</p><p class="text-xs text-gray-600">ADN</p></div>
                    <div class="bg-white p-3 rounded-lg shadow-sm text-center"><p class="text-xl font-bold text-amber-600">${avgATSScore}</p><p class="text-xs text-gray-600">ATS</p></div>
                    <div class="bg-white p-3 rounded-lg shadow-sm text-center"><p class="text-xl font-bold text-emerald-600">${state.employees.filter(e => (e.atsScore || 0) >= 65).length}</p><p class="text-xs text-gray-600">Shortlist</p></div>
                    <div class="bg-white p-3 rounded-lg shadow-sm text-center ${noGoCount > 0 ? 'bg-red-50' : ''}"><p class="text-xl font-bold ${noGoCount > 0 ? 'text-red-600' : 'text-gray-400'}">${noGoCount}</p><p class="text-xs text-gray-600">No-Go</p></div>
                </div>`;
            }
            
            html += `<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <button onclick="quickAdd()" class="bg-gradient-to-r from-blue-600 to-blue-700 text-white py-4 rounded-lg hover:from-blue-700 hover:to-blue-800 shadow-lg">
                    <div class="font-bold">âš¡ Coller le texte</div>
                    <div class="text-xs opacity-90">Copier-coller le profil LinkedIn</div>
                </button>
                <button onclick="state.currentView = 'add'; render();" class="bg-white border-2 border-gray-300 text-gray-700 py-4 rounded-lg hover:bg-gray-50">
                    <div class="font-bold">âž• Saisie manuelle</div>
                    <div class="text-xs text-gray-600">Formulaire complet</div>
                </button>
            </div>`;
            
            html += '<div class="grid gap-4">';
            state.employees.forEach(emp => {
                const atsDecisionBadge = (emp.atsScore || 0) >= 80 ? 'bg-green-100 text-green-700' : 
                    (emp.atsScore || 0) >= 65 ? 'bg-yellow-100 text-yellow-700' : 
                    (emp.atsScore || 0) >= 40 ? 'bg-orange-100 text-orange-700' : 'bg-red-100 text-red-700';
                const linkedinNoGoBadge = emp.linkedinIsNoGo ? '<span class="text-xs px-2 py-0.5 rounded bg-red-100 text-red-700">â›” NO-GO</span>' : '';
                html += `<div class="bg-white p-4 rounded-lg shadow-sm hover:shadow-md transition-shadow ${emp.linkedinIsNoGo ? 'border-l-4 border-red-500' : ''}">
                    <div class="flex items-start justify-between">
                        <div class="flex-1">
                            <div class="flex items-center gap-2 flex-wrap">
                                <h3 class="text-lg font-semibold text-gray-900">${emp.firstName} ${emp.lastName}</h3>
                                ${linkedinNoGoBadge}
                                ${emp.atsDecision ? '<span class="text-xs px-2 py-0.5 rounded ' + atsDecisionBadge + '">' + emp.atsDecision + '</span>' : ''}
                                ${emp.email ? '<span class="text-sm">ðŸ“§</span>' : ''}
                                ${emp.linkedinUrl && isValidLinkedInURL(emp.linkedinUrl) ? '<span class="text-sm">ðŸ”—</span>' : ''}
                            </div>
                            <p class="text-gray-600">${emp.position}</p>
                            <div class="flex gap-2 mt-1 text-sm">
                                <span class="text-gray-500">${emp.department}</span>
                                ${emp.company ? '<span class="text-gray-400">â€¢</span><span class="text-gray-500">' + emp.company + '</span>' : ''}
                            </div>
                        </div>
                        <div class="flex gap-1">
                            <div class="text-center px-2"><div class="px-2 py-1 rounded-full text-xs font-semibold ${getScoreBadge(emp.ssiScore || 0)}">${emp.ssiScore || 0}</div><p class="text-xs text-gray-500 mt-1">SSI</p></div>
                            <div class="text-center px-2"><div class="px-2 py-1 rounded-full text-xs font-semibold ${getScoreBadge(emp.linkedinGlobalScore || 0)}">${emp.linkedinGlobalScore || 0}</div><p class="text-xs text-gray-500 mt-1">Pro</p></div>
                            <div class="text-center px-2"><div class="px-2 py-1 rounded-full text-xs font-semibold ${getScoreBadge(emp.globalScore)}">${emp.globalScore}</div><p class="text-xs text-gray-500 mt-1">ADN</p></div>
                            <div class="text-center px-2"><div class="px-2 py-1 rounded-full text-xs font-semibold ${getScoreBadge(emp.deptScore)}">${emp.deptScore}</div><p class="text-xs text-gray-500 mt-1">MÃ©tier</p></div>
                            <div class="text-center px-2"><div class="px-2 py-1 rounded-full text-xs font-semibold ${getScoreBadge(emp.atsScore || 0)}">${emp.atsScore || 0}</div><p class="text-xs text-gray-500 mt-1">ATS</p></div>
                        </div>
                    </div>
                    <div class="flex gap-2 mt-4">
                        <button onclick="viewEmployee(${emp.id})" class="flex-1 px-3 py-2 bg-blue-50 text-blue-600 rounded hover:bg-blue-100 text-sm font-medium">Voir la fiche</button>
                        ${emp.linkedinUrl && isValidLinkedInURL(emp.linkedinUrl) ? '<a href="' + emp.linkedinUrl + '" target="_blank" class="px-3 py-2 text-blue-600 hover:bg-blue-50 rounded text-sm">ðŸ”—</a>' : ''}
                        <button onclick="deleteEmployee(${emp.id})" class="px-3 py-2 text-red-600 hover:bg-red-50 rounded text-sm">ðŸ—‘ï¸</button>
                    </div>
                </div>`;
            });
            html += '</div>';
            
            if (state.employees.length === 0) {
                html += `<div class="text-center py-12 bg-white rounded-lg">
                    <div class="text-6xl mb-4">ðŸ“Š</div>
                    <h3 class="text-lg font-semibold text-gray-900 mb-2">Aucun profil analysÃ©</h3>
                    <p class="text-gray-600 mb-4">Commencez par ajouter un profil LinkedIn</p>
                    <div class="text-sm text-gray-500 max-w-md mx-auto bg-blue-50 p-4 rounded-lg">
                        <p class="font-medium mb-2">ðŸ’¡ 2 faÃ§ons d'ajouter un profil :</p>
                        <div class="text-left space-y-2">
                            <p><strong>âš¡ Coller le texte</strong> - Copiez tout depuis LinkedIn (recommandÃ©)</p>
                            <p><strong>âž• Saisie manuelle</strong> - Formulaire complet avec tous les champs</p>
                        </div>
                    </div>
                </div>`;
            }
            
            html += '</div>';
            return html;
        }

        function renderEmployeeDetail() {
            const emp = state.selectedEmployee;
            if (!emp) return '';
            const strongAxes = emp.axisScores.filter(axis => axis.score >= 60);
            const weakAxes = emp.axisScores.filter(axis => axis.score < 60);
            
            let html = `<div class="space-y-6">
                <button onclick="state.currentView = 'list'; render();" class="text-blue-600 hover:text-blue-700 font-medium">â† Retour Ã  la liste</button>
                
                <div class="bg-white p-6 rounded-lg shadow-sm">
                    <div class="flex items-start justify-between mb-4">
                        <div>
                            <h2 class="text-3xl font-bold text-gray-900 mb-2">${emp.firstName} ${emp.lastName}</h2>
                            <p class="text-lg text-gray-600">${emp.position}</p>
                            <p class="text-gray-500">${emp.department} â€¢ ${emp.company}</p>
                        </div>
                        <button onclick="deleteEmployee(${emp.id})" class="p-2 text-red-600 hover:bg-red-50 rounded" title="Supprimer">ðŸ—‘ï¸</button>
                    </div>
                    ${emp.linkedinUrl ? '<a href="' + emp.linkedinUrl + '" target="_blank" class="inline-flex items-center gap-1 text-blue-600 hover:underline text-sm bg-blue-50 px-3 py-1 rounded-full">ðŸ”— Voir le profil LinkedIn</a>' : ''}
                </div>
                
                <div class="bg-white p-6 rounded-lg shadow-sm">
                    <h3 class="text-lg font-semibold mb-4">ðŸ† Scores globaux</h3>
                    <div class="grid grid-cols-5 gap-4">
                        <div><p class="text-sm text-gray-600 mb-2">ðŸ“Š SSI</p><span class="text-3xl font-bold ${getScoreColor(emp.ssiScore || 0)}">${emp.ssiScore || 0}</span><span class="text-gray-500">/100</span></div>
                        <div><p class="text-sm text-gray-600 mb-2">ðŸ”µ LinkedIn Pro</p><span class="text-3xl font-bold ${getScoreColor(emp.linkedinGlobalScore || 0)}">${emp.linkedinGlobalScore || 0}</span><span class="text-gray-500">/100</span>${emp.linkedinIsNoGo ? '<p class="text-xs mt-1 text-red-600 font-semibold">â›” NO-GO</p>' : '<p class="text-xs mt-1 text-gray-500">' + (emp.linkedinLevel || '') + '</p>'}</div>
                        <div><p class="text-sm text-gray-600 mb-2">ðŸ§¬ ADN</p><span class="text-3xl font-bold ${getScoreColor(emp.globalScore)}">${emp.globalScore}</span><span class="text-gray-500">/100</span></div>
                        <div><p class="text-sm text-gray-600 mb-2">ðŸ’¼ MÃ©tier</p><span class="text-3xl font-bold ${getScoreColor(emp.deptScore)}">${emp.deptScore}</span><span class="text-gray-500">/100</span></div>
                        <div><p class="text-sm text-gray-600 mb-2">ðŸŽ¯ ATS</p><span class="text-3xl font-bold ${getScoreColor(emp.atsScore || 0)}">${emp.atsScore || 0}</span><span class="text-gray-500">/100</span><p class="text-xs mt-1 ${(emp.atsScore || 0) >= 65 ? 'text-green-600' : 'text-orange-600'}">${emp.atsDecision || ''}</p></div>
                    </div>
                </div>`;
            
            // SSI Details
            if (emp.ssiScore !== undefined) {
                const ssiSynthesis = getSSISynthesis(emp);
                const ssiRecos = getSSIRecommendations(emp);
                
                html += `<div class="bg-gradient-to-r from-indigo-50 to-blue-50 p-6 rounded-lg border border-indigo-200">
                    <h3 class="text-lg font-semibold mb-4 text-indigo-900">ðŸ“Š Social Selling Index (SSI)</h3>
                    
                    <!-- SynthÃ¨se -->
                    <div class="bg-white p-4 rounded-lg mb-4 border-l-4 ${emp.ssiScore >= 55 ? 'border-green-500' : emp.ssiScore >= 35 ? 'border-yellow-500' : 'border-red-500'}">
                        <div class="flex items-center gap-2 mb-2">
                            <span class="font-bold text-lg">${ssiSynthesis.level}</span>
                            <span class="text-2xl font-bold ${getScoreColor(emp.ssiScore)}">${emp.ssiScore}/100</span>
                        </div>
                        <p class="text-gray-700">${ssiSynthesis.description}</p>
                        ${ssiSynthesis.strengths.length > 0 ? '<p class="text-green-700 mt-2"><strong>Points forts :</strong> ' + ssiSynthesis.strengths.map(s => s.icon + ' ' + s.name).join(', ') + '</p>' : ''}
                        ${ssiSynthesis.weaknesses.length > 0 ? '<p class="text-orange-700 mt-1"><strong>Ã€ amÃ©liorer :</strong> ' + ssiSynthesis.weaknesses.map(w => w.icon + ' ' + w.name).join(', ') + '</p>' : ''}
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <div class="bg-white p-4 rounded-lg"><p class="text-xs text-gray-600">Classement Secteur</p><p class="text-2xl font-bold text-indigo-600">Top ${emp.ssiSectorRanking}%</p><p class="text-xs text-gray-500">Moyenne secteur : ${emp.ssiAvgSectorScore}</p></div>
                        <div class="bg-white p-4 rounded-lg"><p class="text-xs text-gray-600">Classement RÃ©seau</p><p class="text-2xl font-bold text-blue-600">Top ${emp.ssiNetworkRanking}%</p><p class="text-xs text-gray-500">Moyenne rÃ©seau : ${emp.ssiAvgNetworkScore}</p></div>
                    </div>
                    
                    <div class="bg-white p-4 rounded-lg mb-4">
                        <p class="font-semibold mb-3">Les quatre facteurs SSI</p>
                        <div class="space-y-3">
                            <div><div class="flex justify-between mb-1"><span class="text-sm">ðŸ† Marque professionnelle</span><span class="font-bold ${emp.ssiBrandScore >= 18 ? 'text-green-600' : emp.ssiBrandScore >= 12 ? 'text-yellow-600' : 'text-red-600'}">${emp.ssiBrandScore}/25</span></div><div class="w-full bg-gray-200 rounded-full h-2"><div class="h-2 rounded-full bg-orange-500" style="width: ${emp.ssiBrandScore * 4}%"></div></div></div>
                            <div><div class="flex justify-between mb-1"><span class="text-sm">ðŸ‘¥ Trouver les bonnes personnes</span><span class="font-bold ${emp.ssiPeopleScore >= 18 ? 'text-green-600' : emp.ssiPeopleScore >= 12 ? 'text-yellow-600' : 'text-red-600'}">${emp.ssiPeopleScore}/25</span></div><div class="w-full bg-gray-200 rounded-full h-2"><div class="h-2 rounded-full bg-blue-500" style="width: ${emp.ssiPeopleScore * 4}%"></div></div></div>
                            <div><div class="flex justify-between mb-1"><span class="text-sm">ðŸ’¬ Ã‰changer des informations</span><span class="font-bold ${emp.ssiEngagementScore >= 18 ? 'text-green-600' : emp.ssiEngagementScore >= 12 ? 'text-yellow-600' : 'text-red-600'}">${emp.ssiEngagementScore}/25</span></div><div class="w-full bg-gray-200 rounded-full h-2"><div class="h-2 rounded-full bg-purple-500" style="width: ${emp.ssiEngagementScore * 4}%"></div></div></div>
                            <div><div class="flex justify-between mb-1"><span class="text-sm">ðŸ¤ Ã‰tablir des relations</span><span class="font-bold ${emp.ssiRelationScore >= 18 ? 'text-green-600' : emp.ssiRelationScore >= 12 ? 'text-yellow-600' : 'text-red-600'}">${emp.ssiRelationScore}/25</span></div><div class="w-full bg-gray-200 rounded-full h-2"><div class="h-2 rounded-full bg-green-500" style="width: ${emp.ssiRelationScore * 4}%"></div></div></div>
                        </div>
                    </div>
                    
                    <!-- PrÃ©conisations SSI -->
                    ${ssiRecos.length > 0 ? `
                    <div class="bg-gradient-to-r from-amber-50 to-orange-50 p-4 rounded-lg border border-amber-200">
                        <p class="font-semibold text-amber-900 mb-3">ðŸŽ¯ Plan d'action SSI</p>
                        <div class="space-y-4">
                            ${ssiRecos.map(reco => `
                                <div class="bg-white p-3 rounded-lg">
                                    <div class="flex items-center gap-2 mb-2">
                                        <span class="px-2 py-0.5 rounded text-xs font-medium ${reco.priority === 'haute' ? 'bg-red-100 text-red-700' : 'bg-yellow-100 text-yellow-700'}">${reco.priority === 'haute' ? 'ðŸ”´ PrioritÃ© haute' : 'ðŸŸ¡ PrioritÃ© moyenne'}</span>
                                        <span class="font-semibold text-gray-800">${reco.category}</span>
                                    </div>
                                    <ul class="text-sm text-gray-700 space-y-1 ml-4">
                                        ${reco.actions.map(a => '<li class="list-disc">' + a + '</li>').join('')}
                                    </ul>
                                </div>
                            `).join('')}
                        </div>
                    </div>` : '<div class="bg-green-50 p-4 rounded-lg border border-green-200"><p class="text-green-800">âœ… Excellent ! Tous les facteurs SSI sont bien optimisÃ©s. Continuez Ã  maintenir cette dynamique !</p></div>'}
                </div>`;
            }
            
            // Section LinkedIn Pro
            const linkedinSynthesis = getLinkedInProSynthesis(emp);
            const linkedinRecos = getLinkedInProRecommendations(emp);
            
            html += `<div class="bg-gradient-to-r from-blue-50 to-cyan-50 p-6 rounded-lg border border-blue-200">
                <h3 class="text-lg font-semibold mb-4 text-blue-900">ðŸ”µ Ã‰valuation LinkedIn Pro</h3>
                
                <!-- SynthÃ¨se LinkedIn Pro -->
                <div class="bg-white p-4 rounded-lg mb-4 border-l-4 ${(emp.linkedinGlobalScore || 0) >= 70 ? 'border-green-500' : (emp.linkedinGlobalScore || 0) >= 50 ? 'border-yellow-500' : 'border-red-500'}">
                    <div class="flex items-center gap-3 mb-2">
                        <span class="text-2xl font-bold ${getScoreColor(emp.linkedinGlobalScore || 0)}">${emp.linkedinGlobalScore || 0}/100</span>
                        <span class="px-3 py-1 rounded-full text-sm font-semibold ${(emp.linkedinGlobalScore || 0) >= 85 ? 'bg-green-100 text-green-700' : (emp.linkedinGlobalScore || 0) >= 70 ? 'bg-blue-100 text-blue-700' : (emp.linkedinGlobalScore || 0) >= 50 ? 'bg-yellow-100 text-yellow-700' : 'bg-red-100 text-red-700'}">${emp.linkedinLevel || ''}</span>
                        <span class="text-gray-600">${emp.linkedinVerdict || ''}</span>
                    </div>
                    <p class="text-gray-700">${linkedinSynthesis.description}</p>
                    ${linkedinSynthesis.isNoGo ? '<div class="mt-2 p-2 bg-red-100 rounded border border-red-300"><p class="text-red-800 font-semibold">â›” RÃ¨gles Ã©liminatoires :</p><ul class="text-sm text-red-700 ml-4">' + linkedinSynthesis.noGoReasons.map(r => '<li class="list-disc">' + r + '</li>').join('') + '</ul></div>' : ''}
                    ${(emp.linkedinFollowersCount || 0) > 0 || (emp.linkedinConnexionsCount || 0) > 0 ? '<div class="mt-2 flex gap-4 text-sm"><span class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full">ðŸ‘¥ ' + ((emp.linkedinConnexionsCount || 0) > 0 ? (emp.linkedinConnexionsCount || 0).toLocaleString('fr-FR') + ' relations' : 'Plus de 500 relations') + '</span>' + ((emp.linkedinFollowersCount || 0) > 0 ? '<span class="px-3 py-1 bg-purple-100 text-purple-800 rounded-full">ðŸ“¢ ' + (emp.linkedinFollowersCount || 0).toLocaleString('fr-FR') + ' abonnÃ©s</span>' : '') + '</div>' : ''}
                    ${linkedinSynthesis.strengths.length > 0 ? '<p class="text-green-700 mt-2"><strong>âœ… Points forts :</strong> ' + linkedinSynthesis.strengths.map(s => s.icon + ' ' + s.name).join(', ') + '</p>' : ''}
                    ${linkedinSynthesis.weaknesses.length > 0 ? '<p class="text-orange-700 mt-1"><strong>âš ï¸ Ã€ amÃ©liorer :</strong> ' + linkedinSynthesis.weaknesses.map(w => w.icon + ' ' + w.name).join(', ') + '</p>' : ''}
                </div>
                
                <!-- Les 6 sections LinkedIn Pro -->
                <div class="bg-white p-4 rounded-lg mb-4">
                    <p class="font-semibold mb-3">Analyse des 6 piliers professionnels</p>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <div class="flex justify-between mb-1"><span class="text-sm">ðŸ‘¤ IdentitÃ© & CrÃ©dibilitÃ©</span><span class="font-bold ${(emp.linkedinIdentityScore || 0) >= 12 ? 'text-green-600' : (emp.linkedinIdentityScore || 0) >= 8 ? 'text-yellow-600' : 'text-red-600'}">${emp.linkedinIdentityScore || 0}/15</span></div>
                            <div class="w-full bg-gray-200 rounded-full h-2 mb-2"><div class="h-2 rounded-full bg-blue-500" style="width: ${((emp.linkedinIdentityScore || 0) / 15) * 100}%"></div></div>
                            <p class="text-xs text-gray-500">Photo ${emp.linkedinPhotoScore || 0}/5 â€¢ Titre ${emp.linkedinHeadlineScore || 0}/5 â€¢ Localisation ${emp.linkedinLocationScore || 0}/5</p>
                        </div>
                        <div>
                            <div class="flex justify-between mb-1"><span class="text-sm">ðŸ’¡ Proposition de valeur</span><span class="font-bold ${(emp.linkedinPositioningScore || 0) >= 15 ? 'text-green-600' : (emp.linkedinPositioningScore || 0) >= 10 ? 'text-yellow-600' : 'text-red-600'}">${emp.linkedinPositioningScore || 0}/20</span></div>
                            <div class="w-full bg-gray-200 rounded-full h-2 mb-2"><div class="h-2 rounded-full bg-purple-500" style="width: ${((emp.linkedinPositioningScore || 0) / 20) * 100}%"></div></div>
                            <p class="text-xs text-gray-500">RÃ©sumÃ© ${emp.linkedinSummaryScore || 0}/10 â€¢ CohÃ©rence ${emp.linkedinCoherenceScore || 0}/10</p>
                        </div>
                        <div>
                            <div class="flex justify-between mb-1"><span class="text-sm">ðŸ’¼ ExpÃ©rience professionnelle</span><span class="font-bold ${(emp.linkedinExperienceScore || 0) >= 18 ? 'text-green-600' : (emp.linkedinExperienceScore || 0) >= 12 ? 'text-yellow-600' : 'text-red-600'}">${emp.linkedinExperienceScore || 0}/25</span></div>
                            <div class="w-full bg-gray-200 rounded-full h-2 mb-2"><div class="h-2 rounded-full bg-teal-500" style="width: ${((emp.linkedinExperienceScore || 0) / 25) * 100}%"></div></div>
                            <p class="text-xs text-gray-500">DÃ©tail ${emp.linkedinExpDetailScore || 0}/15 â€¢ Progression ${emp.linkedinProgressionScore || 0}/10</p>
                        </div>
                        <div>
                            <div class="flex justify-between mb-1"><span class="text-sm">ðŸ› ï¸ CompÃ©tences & Expertise</span><span class="font-bold ${(emp.linkedinCompetenceScore || 0) >= 14 ? 'text-green-600' : (emp.linkedinCompetenceScore || 0) >= 8 ? 'text-yellow-600' : 'text-red-600'}">${emp.linkedinCompetenceScore || 0}/20</span></div>
                            <div class="w-full bg-gray-200 rounded-full h-2 mb-2"><div class="h-2 rounded-full bg-amber-500" style="width: ${((emp.linkedinCompetenceScore || 0) / 20) * 100}%"></div></div>
                            <p class="text-xs text-gray-500">Skills ${emp.linkedinSkillsScore || 0}/10 â€¢ Validation ${emp.linkedinValidationScore || 0}/10</p>
                        </div>
                        <div>
                            <div class="flex justify-between mb-1"><span class="text-sm">ðŸ“¢ Engagement & VisibilitÃ©</span><span class="font-bold ${(emp.linkedinEngagementScore || 0) >= 7 ? 'text-green-600' : (emp.linkedinEngagementScore || 0) >= 4 ? 'text-yellow-600' : 'text-red-600'}">${emp.linkedinEngagementScore || 0}/10</span></div>
                            <div class="w-full bg-gray-200 rounded-full h-2 mb-2"><div class="h-2 rounded-full bg-indigo-500" style="width: ${((emp.linkedinEngagementScore || 0) / 10) * 100}%"></div></div>
                            <p class="text-xs text-gray-500">ActivitÃ© ${emp.linkedinActivityScore || 0}/5 â€¢ RÃ©seau ${emp.linkedinNetworkScore || 0}/5</p>
                            ${(emp.linkedinFollowersCount || 0) > 0 || (emp.linkedinConnexionsCount || 0) > 0 ? '<p class="text-xs text-blue-600 mt-1">ðŸ“Š DÃ©tectÃ© : ' + ((emp.linkedinFollowersCount || 0) > 0 ? (emp.linkedinFollowersCount || 0).toLocaleString('fr-FR') + ' abonnÃ©s' : '') + ((emp.linkedinFollowersCount || 0) > 0 && (emp.linkedinConnexionsCount || 0) > 0 ? ' â€¢ ' : '') + ((emp.linkedinConnexionsCount || 0) > 0 ? (emp.linkedinConnexionsCount || 0).toLocaleString('fr-FR') + ' relations' : '') + '</p>' : ''}
                        </div>
                        <div>
                            <div class="flex justify-between mb-1"><span class="text-sm">ðŸŽ“ Formation & AcadÃ©mique</span><span class="font-bold ${(emp.linkedinFormationScore || 0) >= 7 ? 'text-green-600' : (emp.linkedinFormationScore || 0) >= 4 ? 'text-yellow-600' : 'text-red-600'}">${emp.linkedinFormationScore || 0}/10</span></div>
                            <div class="w-full bg-gray-200 rounded-full h-2 mb-2"><div class="h-2 rounded-full bg-pink-500" style="width: ${((emp.linkedinFormationScore || 0) / 10) * 100}%"></div></div>
                            <p class="text-xs text-gray-500">DiplÃ´mes ${emp.linkedinEducationScore || 0}/5 â€¢ Certifications ${emp.linkedinCertScore || 0}/5</p>
                        </div>
                    </div>
                </div>
                
                <!-- PrÃ©conisations LinkedIn Pro -->
                ${linkedinRecos.length > 0 ? `
                <div class="bg-gradient-to-r from-amber-50 to-orange-50 p-4 rounded-lg border border-amber-200">
                    <p class="font-semibold text-amber-900 mb-3">ðŸŽ¯ Plan d'optimisation LinkedIn</p>
                    <div class="space-y-4">
                        ${linkedinRecos.map(reco => `
                            <div class="bg-white p-4 rounded-lg">
                                <div class="flex items-center justify-between mb-2">
                                    <div class="flex items-center gap-2">
                                        <span class="px-2 py-0.5 rounded text-xs font-medium ${reco.priority === 'haute' ? 'bg-red-100 text-red-700' : reco.priority === 'moyenne' ? 'bg-yellow-100 text-yellow-700' : 'bg-gray-100 text-gray-700'}">${reco.priority === 'haute' ? 'ðŸ”´ PrioritÃ© haute' : reco.priority === 'moyenne' ? 'ðŸŸ¡ PrioritÃ© moyenne' : 'âšª Optionnel'}</span>
                                        <span class="font-semibold text-gray-800">${reco.category}</span>
                                    </div>
                                    <span class="text-sm ${getScoreColor(Math.round((reco.score / reco.maxScore) * 100))}">${reco.score}/${reco.maxScore}</span>
                                </div>
                                <div class="flex gap-2 mb-2 text-xs text-gray-500">
                                    ${reco.subsections.map(s => '<span class="px-2 py-0.5 bg-gray-100 rounded">' + s.name + ' ' + s.score + '/' + s.max + '</span>').join('')}
                                </div>
                                <ul class="text-sm text-gray-700 space-y-1 ml-4">
                                    ${reco.actions.map(a => '<li class="list-disc">' + a + '</li>').join('')}
                                </ul>
                                ${reco.examples ? '<div class="bg-gray-50 p-2 rounded text-xs mt-2"><p class="text-gray-600 mb-1">Exemple :</p>' + reco.examples.map(e => '<p class="' + (e.startsWith('âŒ') ? 'text-red-600' : 'text-green-600') + '">' + e + '</p>').join('') + '</div>' : ''}
                            </div>
                        `).join('')}
                    </div>
                </div>` : `
                <div class="bg-green-50 p-4 rounded-lg border border-green-200">
                    <p class="text-green-800">âœ… Excellent profil LinkedIn ! Toutes les sections sont bien optimisÃ©es.</p>
                </div>`}
            </div>`;
            
            // ADN Scores
            const adnSynthesis = getADNSynthesis(emp);
            const adnRecos = getADNRecommendations(emp);
            
            html += `<div class="bg-white p-6 rounded-lg shadow-sm">
                <h3 class="text-lg font-semibold mb-4">ðŸ§¬ Alignement ADN Cyrus Herez</h3>
                
                <!-- SynthÃ¨se ADN -->
                <div class="bg-gradient-to-r ${emp.globalScore >= 50 ? 'from-green-50 to-emerald-50 border-green-200' : emp.globalScore >= 30 ? 'from-yellow-50 to-amber-50 border-yellow-200' : 'from-red-50 to-orange-50 border-red-200'} p-4 rounded-lg mb-4 border">
                    <div class="flex items-center gap-2 mb-2">
                        <span class="font-bold text-lg">${adnSynthesis.level}</span>
                        <span class="text-2xl font-bold ${getScoreColor(emp.globalScore)}">${emp.globalScore}/100</span>
                    </div>
                    <p class="text-gray-700">${adnSynthesis.description}</p>
                </div>
                
                <!-- DÃ©tail des axes -->
                <div class="space-y-4 mb-4">`;
            
            emp.axisScores.forEach(axis => {
                const barColor = axis.score >= 70 ? 'bg-green-500' : axis.score >= 40 ? 'bg-yellow-500' : 'bg-red-500';
                const bgColor = axis.score >= 70 ? 'bg-green-50' : axis.score >= 40 ? 'bg-yellow-50' : 'bg-red-50';
                html += `<div class="${bgColor} p-4 rounded-lg">
                    <div class="flex justify-between mb-2"><span class="font-medium">${axis.axisName}</span><span class="font-semibold ${getScoreColor(axis.score)}">${axis.score}/100</span></div>
                    <div class="w-full bg-gray-200 rounded-full h-3 mb-2"><div class="h-3 rounded-full ${barColor}" style="width: ${axis.score}%"></div></div>
                    ${axis.foundKeywords.length > 0 ? '<p class="text-sm text-green-700"><strong>âœ“ PrÃ©sents :</strong> ' + axis.foundKeywords.slice(0, 8).join(', ') + (axis.foundKeywords.length > 8 ? '...' : '') + '</p>' : '<p class="text-sm text-gray-500 italic">Aucun mot-clÃ© dÃ©tectÃ©</p>'}
                </div>`;
            });
            
            html += '</div>';
            
            // PrÃ©conisations ADN
            if (adnRecos.length > 0) {
                html += `<div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-4 rounded-lg border border-blue-200">
                    <p class="font-semibold text-blue-900 mb-3">ðŸŽ¯ Recommandations pour renforcer l'ADN</p>
                    <div class="space-y-3">
                        ${adnRecos.map(reco => `
                            <div class="bg-white p-3 rounded-lg">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="font-semibold text-gray-800">${reco.category}</span>
                                    <span class="text-sm ${getScoreColor(reco.score)}">${reco.score}/100</span>
                                </div>
                                <p class="text-sm text-gray-600 mb-2">${reco.advice}</p>
                                <div class="flex flex-wrap gap-1">
                                    ${reco.keywords.map(k => '<span class="px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs">+ ' + k + '</span>').join('')}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    <p class="text-sm text-blue-700 mt-3 italic">ðŸ’¡ Conseil : IntÃ©grez ces mots-clÃ©s naturellement dans votre rÃ©sumÃ©, vos expÃ©riences et votre titre LinkedIn.</p>
                </div>`;
            } else {
                html += `<div class="bg-green-50 p-4 rounded-lg border border-green-200">
                    <p class="text-green-800">âœ… Excellent alignement ! Le profil reflÃ¨te parfaitement les valeurs de Cyrus Herez.</p>
                </div>`;
            }
            
            html += '</div>';
            
            // MÃ©tier
            if (emp.department) {
                const metierSynthesis = getMetierSynthesis(emp);
                const metierRecos = getMetierRecommendations(emp);
                
                html += `<div class="bg-gradient-to-r from-purple-50 to-pink-50 p-6 rounded-lg border border-purple-200">
                    <h3 class="text-lg font-semibold mb-4 text-purple-900">ðŸ’¼ Score MÃ©tier - ${emp.department}</h3>
                    
                    <!-- SynthÃ¨se MÃ©tier -->
                    <div class="bg-white p-4 rounded-lg mb-4 border-l-4 ${emp.deptScore >= 60 ? 'border-green-500' : emp.deptScore >= 40 ? 'border-yellow-500' : 'border-red-500'}">
                        <div class="flex items-center gap-2 mb-2">
                            <span class="font-bold text-lg">${metierSynthesis.level}</span>
                            <span class="text-2xl font-bold ${getScoreColor(emp.deptScore)}">${emp.deptScore}/100</span>
                        </div>
                        <p class="text-gray-700">${metierSynthesis.description}</p>
                        <p class="text-sm text-gray-500 mt-2">ðŸ“Š Couverture : ${metierSynthesis.found} mots-clÃ©s sur ${metierSynthesis.total} du rÃ©fÃ©rentiel mÃ©tier</p>
                    </div>
                    
                    <!-- Mots-clÃ©s prÃ©sents -->
                    ${emp.deptFoundKeywords?.length > 0 ? `
                    <div class="bg-green-50 p-4 rounded-lg mb-4 border border-green-200">
                        <p class="font-semibold text-green-900 mb-2">âœ… Mots-clÃ©s prÃ©sents (${emp.deptFoundKeywords.length})</p>
                        <div class="flex flex-wrap gap-2">
                            ${emp.deptFoundKeywords.map(kw => '<span class="px-3 py-1 bg-green-200 text-green-800 rounded-full text-sm">' + kw + '</span>').join('')}
                        </div>
                    </div>` : ''}
                    
                    <!-- PrÃ©conisations MÃ©tier -->
                    ${metierRecos.length > 0 ? `
                    <div class="bg-gradient-to-r from-amber-50 to-orange-50 p-4 rounded-lg border border-amber-200">
                        <p class="font-semibold text-amber-900 mb-3">ðŸŽ¯ Mots-clÃ©s Ã  intÃ©grer pour amÃ©liorer le rÃ©fÃ©rencement</p>
                        <div class="space-y-4">
                            ${metierRecos.map(reco => `
                                <div class="bg-white p-3 rounded-lg">
                                    <p class="font-semibold text-gray-800 mb-2">${reco.category}</p>
                                    <div class="flex flex-wrap gap-2 mb-2">
                                        ${reco.keywords.map(k => '<span class="px-3 py-1 bg-orange-100 text-orange-700 rounded-full text-sm border border-orange-300">+ ' + k + '</span>').join('')}
                                    </div>
                                    <p class="text-xs text-gray-600 italic">${reco.tip}</p>
                                </div>
                            `).join('')}
                        </div>
                        
                        <div class="mt-4 p-3 bg-white rounded-lg border border-purple-200">
                            <p class="font-medium text-purple-900 mb-2">ðŸ“ Comment intÃ©grer ces mots-clÃ©s ?</p>
                            <ul class="text-sm text-gray-700 space-y-1">
                                <li>â€¢ <strong>Titre LinkedIn :</strong> Ajoutez 2-3 termes clÃ©s de votre expertise</li>
                                <li>â€¢ <strong>RÃ©sumÃ© :</strong> DÃ©crivez vos compÃ©tences avec le vocabulaire mÃ©tier</li>
                                <li>â€¢ <strong>ExpÃ©riences :</strong> Utilisez les termes pour dÃ©crire vos missions</li>
                                <li>â€¢ <strong>CompÃ©tences :</strong> Ajoutez les termes pertinents dans cette section</li>
                            </ul>
                        </div>
                    </div>` : `
                    <div class="bg-green-50 p-4 rounded-lg border border-green-200">
                        <p class="text-green-800">âœ… Excellent positionnement ! Le profil utilise efficacement le vocabulaire mÃ©tier du rÃ©fÃ©rentiel "${emp.department}".</p>
                    </div>`}
                </div>`;
            }
            
            // Section ATS dÃ©taillÃ©e
            if (emp.atsScore !== undefined) {
                const atsSynthesis = getATSSynthesis(emp);
                const atsRecos = getATSRecommendations(emp);
                
                html += `<div class="bg-gradient-to-r from-emerald-50 to-teal-50 p-6 rounded-lg border border-emerald-200">
                    <h3 class="text-lg font-semibold mb-4 text-emerald-900">ðŸŽ¯ Score ATS (Applicant Tracking System)</h3>
                    
                    <!-- SynthÃ¨se ATS -->
                    <div class="bg-white p-4 rounded-lg mb-4 border-l-4 ${(emp.atsScore || 0) >= 65 ? 'border-green-500' : (emp.atsScore || 0) >= 40 ? 'border-yellow-500' : 'border-red-500'}">
                        <div class="flex items-center gap-3 mb-2">
                            <span class="text-2xl font-bold ${getScoreColor(emp.atsScore || 0)}">${emp.atsScore || 0}/100</span>
                            <span class="px-3 py-1 rounded-full text-sm font-semibold ${(emp.atsScore || 0) >= 80 ? 'bg-green-100 text-green-700' : (emp.atsScore || 0) >= 65 ? 'bg-yellow-100 text-yellow-700' : (emp.atsScore || 0) >= 40 ? 'bg-orange-100 text-orange-700' : 'bg-red-100 text-red-700'}">${emp.atsDecision || ''}</span>
                            <span class="text-gray-600 font-medium">${atsSynthesis.verdict}</span>
                        </div>
                        <p class="text-gray-700">${atsSynthesis.description}</p>
                        ${atsSynthesis.strengths.length > 0 ? '<p class="text-green-700 mt-2"><strong>âœ… Points forts :</strong> ' + atsSynthesis.strengths.join(' â€¢ ') + '</p>' : ''}
                        ${atsSynthesis.weaknesses.length > 0 ? '<p class="text-orange-700 mt-1"><strong>âš ï¸ Ã€ amÃ©liorer :</strong> ' + atsSynthesis.weaknesses.join(' â€¢ ') + '</p>' : ''}
                    </div>
                    
                    <!-- Piliers ATS -->
                    <div class="bg-white p-4 rounded-lg mb-4">
                        <p class="font-semibold mb-3">Analyse des 6 piliers ATS</p>
                        <div class="space-y-3">
                            <div>
                                <div class="flex justify-between mb-1"><span class="text-sm">ðŸ·ï¸ TitleFit (Titre de poste)</span><span class="font-bold ${(emp.atsTitleFit || 0) >= 15 ? 'text-green-600' : (emp.atsTitleFit || 0) >= 10 ? 'text-yellow-600' : 'text-red-600'}">${emp.atsTitleFit || 0}/20</span></div>
                                <div class="w-full bg-gray-200 rounded-full h-2"><div class="h-2 rounded-full bg-blue-500" style="width: ${((emp.atsTitleFit || 0) / 20) * 100}%"></div></div>
                            </div>
                            <div>
                                <div class="flex justify-between mb-1"><span class="text-sm">ðŸ“Š ImpactKPI (RÃ©sultats chiffrÃ©s)</span><span class="font-bold ${(emp.atsImpactKPI || 0) >= 18 ? 'text-green-600' : (emp.atsImpactKPI || 0) >= 10 ? 'text-yellow-600' : 'text-red-600'}">${emp.atsImpactKPI || 0}/25</span></div>
                                <div class="w-full bg-gray-200 rounded-full h-2"><div class="h-2 rounded-full bg-purple-500" style="width: ${((emp.atsImpactKPI || 0) / 25) * 100}%"></div></div>
                                ${(emp.atsKPICount || 0) > 0 ? '<p class="text-xs text-gray-500 mt-1">' + (emp.atsKPICount || 0) + ' KPIs dÃ©tectÃ©s' + ((emp.atsKPIMatches || []).length > 0 ? ' : ' + (emp.atsKPIMatches || []).slice(0, 5).join(', ') : '') + '</p>' : '<p class="text-xs text-red-500 mt-1">Aucun KPI dÃ©tectÃ© - ajoutez des chiffres !</p>'}
                            </div>
                            <div>
                                <div class="flex justify-between mb-1"><span class="text-sm">ðŸ› ï¸ ToolsFit (Outils maÃ®trisÃ©s)</span><span class="font-bold ${(emp.atsToolsFit || 0) >= 10 ? 'text-green-600' : (emp.atsToolsFit || 0) >= 5 ? 'text-yellow-600' : 'text-red-600'}">${emp.atsToolsFit || 0}/15</span></div>
                                <div class="w-full bg-gray-200 rounded-full h-2"><div class="h-2 rounded-full bg-teal-500" style="width: ${((emp.atsToolsFit || 0) / 15) * 100}%"></div></div>
                                ${(emp.atsFoundTools || []).length > 0 ? '<p class="text-xs text-green-600 mt-1">âœ“ ' + (emp.atsFoundTools || []).join(', ') + '</p>' : ''}
                            </div>
                            <div>
                                <div class="flex justify-between mb-1"><span class="text-sm">ðŸ“… SeniorityFit (ExpÃ©rience)</span><span class="font-bold ${(emp.atsSeniorityFit || 0) >= 12 ? 'text-green-600' : (emp.atsSeniorityFit || 0) >= 8 ? 'text-yellow-600' : 'text-red-600'}">${emp.atsSeniorityFit || 0}/15</span></div>
                                <div class="w-full bg-gray-200 rounded-full h-2"><div class="h-2 rounded-full bg-amber-500" style="width: ${((emp.atsSeniorityFit || 0) / 15) * 100}%"></div></div>
                                <p class="text-xs text-gray-500 mt-1">${(emp.atsTotalYears || 0) > 0 ? '~' + (emp.atsTotalYears || 0) + ' ans dÃ©tectÃ©s' : 'AnnÃ©es non dÃ©tectÃ©es'}${emp.atsHasProgression ? ' â€¢ Progression de carriÃ¨re visible' : ''}</p>
                            </div>
                            <div>
                                <div class="flex justify-between mb-1"><span class="text-sm">ðŸ… Credibility (CrÃ©dibilitÃ©)</span><span class="font-bold ${(emp.atsCredibility || 0) >= 10 ? 'text-green-600' : (emp.atsCredibility || 0) >= 6 ? 'text-yellow-600' : 'text-red-600'}">${emp.atsCredibility || 0}/15</span></div>
                                <div class="w-full bg-gray-200 rounded-full h-2"><div class="h-2 rounded-full bg-indigo-500" style="width: ${((emp.atsCredibility || 0) / 15) * 100}%"></div></div>
                                <p class="text-xs text-gray-500 mt-1">${(emp.atsRecoCount || 0)} recommandations â€¢ ${(emp.atsCertCount || 0)} certifications dÃ©tectÃ©es</p>
                            </div>
                            <div>
                                <div class="flex justify-between mb-1"><span class="text-sm">ðŸ“ ContextFit (Contexte)</span><span class="font-bold ${(emp.atsContextFit || 0) >= 8 ? 'text-green-600' : (emp.atsContextFit || 0) >= 5 ? 'text-yellow-600' : 'text-red-600'}">${emp.atsContextFit || 0}/10</span></div>
                                <div class="w-full bg-gray-200 rounded-full h-2"><div class="h-2 rounded-full bg-gray-500" style="width: ${((emp.atsContextFit || 0) / 10) * 100}%"></div></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- PrÃ©conisations ATS -->
                    ${atsRecos.length > 0 ? `
                    <div class="bg-gradient-to-r from-amber-50 to-orange-50 p-4 rounded-lg border border-amber-200">
                        <p class="font-semibold text-amber-900 mb-3">ðŸŽ¯ Plan d'action pour amÃ©liorer le score ATS</p>
                        <div class="space-y-4">
                            ${atsRecos.map(reco => `
                                <div class="bg-white p-4 rounded-lg">
                                    <div class="flex items-center justify-between mb-2">
                                        <div class="flex items-center gap-2">
                                            <span class="px-2 py-0.5 rounded text-xs font-medium ${reco.priority === 'haute' ? 'bg-red-100 text-red-700' : reco.priority === 'moyenne' ? 'bg-yellow-100 text-yellow-700' : 'bg-gray-100 text-gray-700'}">${reco.priority === 'haute' ? 'ðŸ”´ PrioritÃ© haute' : reco.priority === 'moyenne' ? 'ðŸŸ¡ PrioritÃ© moyenne' : 'âšª Optionnel'}</span>
                                            <span class="font-semibold text-gray-800">${reco.category}</span>
                                        </div>
                                        <span class="text-sm ${getScoreColor(Math.round((reco.score / reco.maxScore) * 100))}">${reco.score}/${reco.maxScore}</span>
                                    </div>
                                    <ul class="text-sm text-gray-700 space-y-1 ml-4 mb-2">
                                        ${reco.actions.map(a => '<li class="list-disc">' + a + '</li>').join('')}
                                    </ul>
                                    ${reco.examples ? '<div class="bg-gray-50 p-2 rounded text-xs"><p class="text-gray-600 mb-1">Exemple :</p>' + reco.examples.map(e => '<p class="' + (e.startsWith('âŒ') ? 'text-red-600' : 'text-green-600') + '">' + e + '</p>').join('') + '</div>' : ''}
                                    ${reco.suggestedTools ? '<div class="mt-2"><p class="text-xs text-gray-600 mb-1">Outils Ã  mentionner :</p><p class="text-xs text-teal-700">' + reco.suggestedTools.join(' | ') + '</p></div>' : ''}
                                </div>
                            `).join('')}
                        </div>
                    </div>` : `
                    <div class="bg-green-50 p-4 rounded-lg border border-green-200">
                        <p class="text-green-800">âœ… Excellent score ATS ! Le profil est optimisÃ© pour passer les filtres des systÃ¨mes de recrutement.</p>
                    </div>`}
                </div>`;
            }
            
            // SynthÃ¨se globale
            const avgScore = Math.round(((emp.ssiScore || 0) + (emp.linkedinGlobalScore || 0) + emp.globalScore + emp.deptScore + (emp.atsScore || 0)) / 5);
            let globalLevel, globalAdvice;
            
            if (emp.linkedinIsNoGo) {
                globalLevel = "â›” Profil non exploitable";
                globalAdvice = `Le profil de ${emp.firstName} prÃ©sente des lacunes critiques (rÃ¨gles No-Go) qui doivent Ãªtre corrigÃ©es en prioritÃ© avant toute autre optimisation.`;
            } else if (avgScore >= 65) {
                globalLevel = "ðŸ† Profil exemplaire";
                globalAdvice = `${emp.firstName} dispose d'un profil LinkedIn optimisÃ© et alignÃ© avec Cyrus Herez. C'est un excellent ambassadeur de la marque. Maintenez cette dynamique avec une activitÃ© rÃ©guliÃ¨re.`;
            } else if (avgScore >= 45) {
                globalLevel = "âœ… Bon profil";
                globalAdvice = `${emp.firstName} a un bon profil avec des axes d'amÃ©lioration identifiÃ©s. En appliquant les recommandations ci-dessus, le profil peut rapidement atteindre l'excellence.`;
            } else if (avgScore >= 30) {
                globalLevel = "âš ï¸ Profil Ã  dÃ©velopper";
                globalAdvice = `Le profil de ${emp.firstName} nÃ©cessite un travail d'optimisation. Nous recommandons une session de coaching LinkedIn personnalisÃ©e pour traiter les points prioritaires.`;
            } else {
                globalLevel = "ðŸ”´ Profil Ã  construire";
                globalAdvice = `Le profil de ${emp.firstName} est Ã  reconstruire. Une formation complÃ¨te aux bonnes pratiques LinkedIn est recommandÃ©e, suivie d'un accompagnement personnalisÃ©.`;
            }
            
            html += `<div class="bg-gradient-to-r ${emp.linkedinIsNoGo ? 'from-red-600 to-red-700' : 'from-blue-600 to-indigo-600'} p-6 rounded-lg text-white">
                <h3 class="text-xl font-bold mb-3">ðŸ“Š SynthÃ¨se globale</h3>
                <div class="flex items-center gap-4 mb-4">
                    <div class="bg-white/20 rounded-lg p-4 text-center">
                        <p class="text-4xl font-bold">${avgScore}</p>
                        <p class="text-sm opacity-90">Score moyen</p>
                    </div>
                    <div class="flex-1">
                        <p class="text-lg font-semibold mb-1">${globalLevel}</p>
                        <p class="opacity-90">${globalAdvice}</p>
                    </div>
                </div>
                <div class="grid grid-cols-5 gap-2 text-center text-sm">
                    <div class="bg-white/10 rounded p-2"><p class="font-bold">${emp.ssiScore || 0}</p><p class="opacity-75">SSI</p></div>
                    <div class="bg-white/10 rounded p-2 ${emp.linkedinIsNoGo ? 'ring-2 ring-white' : ''}"><p class="font-bold">${emp.linkedinGlobalScore || 0}</p><p class="opacity-75">Pro${emp.linkedinIsNoGo ? ' â›”' : ''}</p></div>
                    <div class="bg-white/10 rounded p-2"><p class="font-bold">${emp.globalScore}</p><p class="opacity-75">ADN</p></div>
                    <div class="bg-white/10 rounded p-2"><p class="font-bold">${emp.deptScore}</p><p class="opacity-75">MÃ©tier</p></div>
                    <div class="bg-white/10 rounded p-2"><p class="font-bold">${emp.atsScore || 0}</p><p class="opacity-75">ATS</p></div>
                </div>
                <p class="text-sm opacity-75 mt-4">ðŸ“ ${emp.wordCount} mots analysÃ©s â€¢ DerniÃ¨re analyse : ${new Date(emp.analyzedAt).toLocaleDateString('fr-FR')}</p>
            </div></div>`;
            
            return html;
        }

        function getDepartmentGroups() {
            return [
                { label: "ðŸ¢ Direction", depts: ["Direction GÃ©nÃ©rale", "Direction des OpÃ©rations", "Direction FinanciÃ¨re", "Direction du DÃ©veloppement", "SecrÃ©tariat GÃ©nÃ©ral"] },
                { label: "ðŸ‘¥ RH & Talents", depts: ["Direction des Ressources Humaines", "Recrutement & Talent Acquisition", "Formation & DÃ©veloppement des CompÃ©tences", "Administration RH & Paie", "Relations Sociales & QVT", "Gestion des CarriÃ¨res & MobilitÃ©"] },
                { label: "ðŸ› ï¸ Support", depts: ["Support Administratif & Services GÃ©nÃ©raux", "Support IT & Helpdesk", "Support Juridique & Contractuel", "Assistanat de Direction"] },
                { label: "ðŸ’¼ Commercial", depts: ["Direction Commerciale", "DÃ©veloppement Commercial & Business Development", "Conseillers Commerciaux & Banquiers PrivÃ©s", "Grands Comptes & Key Account Management", "Administration des Ventes & ADV", "Inside Sales & TÃ©lÃ©prospection"] },
                { label: "ðŸ¤ Service Client", depts: ["Service Client & Relation Clients", "Middle-Office & Support Commercial", "ExpÃ©rience Client & Customer Success"] },
                { label: "ðŸ¦ Patrimoine", depts: ["Conseil Patrimonial", "Gestion FinanciÃ¨re", "Immobilier & Alternatifs"] },
                { label: "ðŸ“£ Marketing", depts: ["Marketing & Communication", "Marketing Digital & Growth"] },
                { label: "âš–ï¸ ConformitÃ©", depts: ["ConformitÃ© & ContrÃ´le Interne", "Juridique & FiscalitÃ©"] },
                { label: "ðŸ“Š Finance", depts: ["ComptabilitÃ©", "ContrÃ´le de Gestion"] },
                { label: "ðŸ’» IT", depts: ["IT, SystÃ¨mes d'Information & Data", "DÃ©veloppement & Projets IT"] },
                { label: "âš™ï¸ OpÃ©rations", depts: ["Back-Office & OpÃ©rations"] }
            ];
        }

        function renderAddForm() {
            const groups = getDepartmentGroups();
            let deptOptions = '<option value="">SÃ©lectionner...</option>';
            groups.forEach(g => {
                deptOptions += `<optgroup label="${g.label}">`;
                g.depts.forEach(d => deptOptions += `<option value="${d}">${d}</option>`);
                deptOptions += '</optgroup>';
            });
            
            return `<div class="bg-white p-6 rounded-lg shadow-sm max-w-3xl mx-auto">
                <h2 class="text-xl font-bold mb-4">âž• Ajouter un collaborateur</h2>
                <form onsubmit="handleAddEmployee(event); return false;" class="space-y-4">
                    <div class="grid grid-cols-2 gap-4">
                        <div><label class="block text-sm font-medium text-gray-700 mb-1">PrÃ©nom *</label><input type="text" id="firstName" required class="w-full px-3 py-2 border rounded-lg" /></div>
                        <div><label class="block text-sm font-medium text-gray-700 mb-1">Nom *</label><input type="text" id="lastName" required class="w-full px-3 py-2 border rounded-lg" /></div>
                    </div>
                    <div><label class="block text-sm font-medium text-gray-700 mb-1">Poste</label><input type="text" id="position" class="w-full px-3 py-2 border rounded-lg" /></div>
                    <div class="grid grid-cols-2 gap-4">
                        <div><label class="block text-sm font-medium text-gray-700 mb-1">Service</label><select id="department" class="w-full px-3 py-2 border rounded-lg">${deptOptions}</select></div>
                        <div><label class="block text-sm font-medium text-gray-700 mb-1">Entreprise</label><input type="text" id="company" value="${state.targetCompany}" class="w-full px-3 py-2 border rounded-lg" /></div>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div><label class="block text-sm font-medium text-gray-700 mb-1">ðŸ“§ Email</label><input type="email" id="email" class="w-full px-3 py-2 border rounded-lg" /></div>
                        <div><label class="block text-sm font-medium text-gray-700 mb-1">ðŸ”— URL LinkedIn</label><input type="url" id="linkedinUrl" class="w-full px-3 py-2 border rounded-lg" /></div>
                    </div>
                    <div><label class="block text-sm font-medium text-gray-700 mb-1">Profil LinkedIn (texte) *</label><textarea id="profileText" required class="w-full px-3 py-2 border rounded-lg h-48" placeholder="Collez le contenu du profil..."></textarea></div>
                    <div class="flex gap-2">
                        <button type="submit" class="flex-1 bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 font-medium">âœ… Ajouter</button>
                        <button type="button" onclick="state.currentView = 'list'; render();" class="flex-1 bg-gray-200 text-gray-700 py-3 rounded-lg hover:bg-gray-300 font-medium">âŒ Annuler</button>
                    </div>
                </form>
            </div>`;
        }

        function render() {
            const app = document.getElementById('app');
            let content = '';
            if (state.currentView === 'list') content = renderEmployeeList();
            else if (state.currentView === 'detail') content = renderEmployeeDetail();
            else if (state.currentView === 'add') content = renderAddForm();
            app.innerHTML = renderHeader() + '<main class="max-w-7xl mx-auto px-4 py-6">' + content + '</main>';
        }

        loadState();
        render();
    </script>
</body>
</html>
